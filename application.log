2024-02-09 13:36:45,591 - root - INFO - i am the main method...
2024-02-09 13:36:45,592 - root - INFO - calling spark object
2024-02-09 13:36:45,592 - create_spark - INFO - get_spark_object method started
2024-02-09 13:36:45,592 - create_spark - INFO - master is local
2024-02-09 13:36:48,489 - create_spark - INFO - Spark object create....
2024-02-09 13:36:48,489 - root - INFO - Validating spark object.......
2024-02-09 13:36:48,489 - validate - WARNING - started the get_current_date method...
2024-02-09 13:36:50,795 - validate - WARNING - Validation done, go forward...
2024-02-09 13:36:50,795 - root - INFO - Reading file which is of > parquet
2024-02-09 13:36:50,795 - infest - WARNING - Load_file method started...
2024-02-09 13:36:51,206 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:36:51,209 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:36:52,452 - root - INFO - validating the dataframe...
2024-02-09 13:36:52,452 - infest - WARNING - here to count the records in the df
2024-02-09 13:36:52,807 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:36:52,807 - infest - WARNING - Load_file method started...
2024-02-09 13:36:53,139 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:36:53,141 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:36:53,339 - root - INFO - validating the dataframe...
2024-02-09 13:36:53,339 - infest - WARNING - here to count the records in the df
2024-02-09 13:36:53,895 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:36:53,895 - root - INFO - implementing data processing...
2024-02-09 13:36:53,895 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:36:53,895 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:36:53,919 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:36:53,933 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:36:53,942 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:36:53,968 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:36:53,981 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:36:53,981 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:36:53,999 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:36:56,055 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:36:56,055 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:36:56,055 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:36:56,280 - root - INFO - validating schema for dataframe....
2024-02-09 13:36:56,280 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:36:56,281 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:36:56,281 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:36:56,281 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:36:56,281 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:36:56,281 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:36:56,281 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:36:56,281 - validate - INFO - print schema done, go forward....
2024-02-09 13:36:56,281 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:36:56,282 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:36:56,282 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:36:56,282 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:36:56,283 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:36:56,283 - validate - INFO - print schema done, go forward....
2024-02-09 13:36:56,386 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:36:56,386 - root - INFO - transformation data processing....
2024-02-09 13:36:56,386 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:36:56,387 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:36:56,414 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:36:56,438 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:36:56,472 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:36:56,473 - root - INFO - displaying the df_report_1
2024-02-09 13:37:03,110 - root - INFO - display data_report2 method...
2024-02-09 13:37:03,111 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:37:03,111 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:37:03,191 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:37:09,297 - root - INFO - extracting files output....
2024-02-09 13:37:09,297 - root - INFO - total amount of time taken: 23.706372600001487 seconds...
2024-02-09 13:37:09,297 - root - INFO - Application done
2024-02-09 13:38:04,611 - root - INFO - i am the main method...
2024-02-09 13:38:04,611 - root - INFO - calling spark object
2024-02-09 13:38:04,611 - create_spark - INFO - get_spark_object method started
2024-02-09 13:38:04,611 - create_spark - INFO - master is local
2024-02-09 13:38:07,513 - create_spark - INFO - Spark object create....
2024-02-09 13:38:07,513 - root - INFO - Validating spark object.......
2024-02-09 13:38:07,514 - validate - WARNING - started the get_current_date method...
2024-02-09 13:38:09,776 - validate - WARNING - Validation done, go forward...
2024-02-09 13:38:09,776 - root - INFO - Reading file which is of > parquet
2024-02-09 13:38:09,776 - infest - WARNING - Load_file method started...
2024-02-09 13:38:10,215 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:38:10,218 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:38:11,698 - root - INFO - validating the dataframe...
2024-02-09 13:38:11,698 - infest - WARNING - here to count the records in the df
2024-02-09 13:38:12,062 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:38:12,063 - infest - WARNING - Load_file method started...
2024-02-09 13:38:12,398 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:38:12,400 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:38:12,636 - root - INFO - validating the dataframe...
2024-02-09 13:38:12,636 - infest - WARNING - here to count the records in the df
2024-02-09 13:38:13,240 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:38:13,240 - root - INFO - implementing data processing...
2024-02-09 13:38:13,240 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:38:13,240 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:38:13,265 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:38:13,280 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:38:13,289 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:38:13,317 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:38:13,329 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:38:13,329 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:38:13,348 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:38:15,475 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:38:15,475 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:38:15,475 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:38:15,743 - root - INFO - validating schema for dataframe....
2024-02-09 13:38:15,743 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:38:15,744 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:38:15,745 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:38:15,745 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:38:15,745 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:38:15,745 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:38:15,745 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:38:15,745 - validate - INFO - print schema done, go forward....
2024-02-09 13:38:15,745 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:38:15,746 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:38:15,747 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:38:15,747 - validate - INFO - print schema done, go forward....
2024-02-09 13:38:15,891 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:38:15,891 - root - INFO - transformation data processing....
2024-02-09 13:38:15,891 - root - INFO - displaying the df_report_1
2024-02-09 13:38:15,891 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:38:15,892 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:38:15,927 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:38:15,966 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:38:16,019 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:38:16,019 - root - INFO - display data_report2 method...
2024-02-09 13:38:16,019 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:38:16,019 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:38:16,091 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:38:22,352 - root - INFO - extracting files output....
2024-02-09 13:38:22,353 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:40:45,212 - root - INFO - i am the main method...
2024-02-09 13:40:45,212 - root - INFO - calling spark object
2024-02-09 13:40:45,212 - create_spark - INFO - get_spark_object method started
2024-02-09 13:40:45,212 - create_spark - INFO - master is local
2024-02-09 13:40:48,196 - create_spark - INFO - Spark object create....
2024-02-09 13:40:48,196 - root - INFO - Validating spark object.......
2024-02-09 13:40:48,196 - validate - WARNING - started the get_current_date method...
2024-02-09 13:40:50,404 - validate - WARNING - Validation done, go forward...
2024-02-09 13:40:50,404 - root - INFO - Reading file which is of > parquet
2024-02-09 13:40:50,404 - infest - WARNING - Load_file method started...
2024-02-09 13:40:50,821 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:40:50,823 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:40:52,136 - root - INFO - validating the dataframe...
2024-02-09 13:40:52,136 - infest - WARNING - here to count the records in the df
2024-02-09 13:40:52,583 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:40:52,584 - infest - WARNING - Load_file method started...
2024-02-09 13:40:52,921 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:40:52,923 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:40:53,117 - root - INFO - validating the dataframe...
2024-02-09 13:40:53,117 - infest - WARNING - here to count the records in the df
2024-02-09 13:40:53,655 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:40:53,655 - root - INFO - implementing data processing...
2024-02-09 13:40:53,655 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:40:53,655 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:40:53,679 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:40:53,693 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:40:53,704 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:40:53,731 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:40:53,743 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:40:53,743 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:40:53,757 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:40:56,014 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:40:56,014 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:40:56,015 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:40:56,262 - root - INFO - validating schema for dataframe....
2024-02-09 13:40:56,262 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:40:56,263 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:40:56,263 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:40:56,263 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:40:56,263 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:40:56,263 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:40:56,263 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:40:56,263 - validate - INFO - print schema done, go forward....
2024-02-09 13:40:56,263 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:40:56,264 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:40:56,264 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:40:56,264 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:40:56,264 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:40:56,265 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:40:56,265 - validate - INFO - print schema done, go forward....
2024-02-09 13:40:56,377 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:40:56,377 - root - INFO - transformation data processing....
2024-02-09 13:40:56,377 - root - INFO - displaying the df_report_1
2024-02-09 13:40:56,377 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:40:56,378 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:40:56,404 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:40:56,430 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:40:56,468 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:40:56,468 - root - INFO - display data_report2 method...
2024-02-09 13:40:56,468 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:40:56,468 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:40:56,547 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:41:02,675 - root - INFO - extracting files output....
2024-02-09 13:41:02,675 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:42:28,475 - root - INFO - i am the main method...
2024-02-09 13:42:28,475 - root - INFO - calling spark object
2024-02-09 13:42:28,475 - create_spark - INFO - get_spark_object method started
2024-02-09 13:42:28,475 - create_spark - INFO - master is local
2024-02-09 13:42:31,491 - create_spark - INFO - Spark object create....
2024-02-09 13:42:31,491 - root - INFO - Validating spark object.......
2024-02-09 13:42:31,491 - validate - WARNING - started the get_current_date method...
2024-02-09 13:42:33,862 - validate - WARNING - Validation done, go forward...
2024-02-09 13:42:33,863 - root - INFO - Reading file which is of > parquet
2024-02-09 13:42:33,863 - infest - WARNING - Load_file method started...
2024-02-09 13:42:34,335 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:42:34,338 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:42:35,537 - root - INFO - validating the dataframe...
2024-02-09 13:42:35,537 - infest - WARNING - here to count the records in the df
2024-02-09 13:42:35,930 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:42:35,930 - infest - WARNING - Load_file method started...
2024-02-09 13:42:36,310 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:42:36,311 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:42:36,518 - root - INFO - validating the dataframe...
2024-02-09 13:42:36,518 - infest - WARNING - here to count the records in the df
2024-02-09 13:42:37,083 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:42:37,083 - root - INFO - implementing data processing...
2024-02-09 13:42:37,083 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:42:37,083 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:42:37,105 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:42:37,118 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:42:37,126 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:42:37,153 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:42:37,165 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:42:37,165 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:42:37,180 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:42:39,293 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:42:39,293 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:42:39,293 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:42:39,528 - root - INFO - validating schema for dataframe....
2024-02-09 13:42:39,528 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:42:39,529 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:42:39,529 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:42:39,529 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:42:39,529 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:42:39,529 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:42:39,530 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:42:39,530 - validate - INFO - print schema done, go forward....
2024-02-09 13:42:39,530 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:42:39,531 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:42:39,531 - validate - INFO - print schema done, go forward....
2024-02-09 13:42:39,650 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:42:39,650 - root - INFO - transformation data processing....
2024-02-09 13:42:39,650 - root - INFO - displaying the df_report_1
2024-02-09 13:42:39,650 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:42:39,651 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:42:39,676 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:42:39,705 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:42:39,742 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:42:39,742 - root - INFO - display data_report2 method...
2024-02-09 13:42:39,742 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:42:39,742 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:42:39,818 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:42:45,976 - root - INFO - extracting files output....
2024-02-09 13:42:45,976 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:44:19,007 - root - INFO - i am the main method...
2024-02-09 13:44:19,007 - root - INFO - calling spark object
2024-02-09 13:44:19,008 - create_spark - INFO - get_spark_object method started
2024-02-09 13:44:19,008 - create_spark - INFO - master is local
2024-02-09 13:44:21,997 - create_spark - INFO - Spark object create....
2024-02-09 13:44:21,997 - root - INFO - Validating spark object.......
2024-02-09 13:44:21,997 - validate - WARNING - started the get_current_date method...
2024-02-09 13:44:24,253 - validate - WARNING - Validation done, go forward...
2024-02-09 13:44:24,253 - root - INFO - Reading file which is of > parquet
2024-02-09 13:44:24,254 - infest - WARNING - Load_file method started...
2024-02-09 13:44:24,652 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:44:24,655 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:44:25,884 - root - INFO - validating the dataframe...
2024-02-09 13:44:25,884 - infest - WARNING - here to count the records in the df
2024-02-09 13:44:26,246 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:44:26,246 - infest - WARNING - Load_file method started...
2024-02-09 13:44:26,588 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:44:26,590 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:44:26,782 - root - INFO - validating the dataframe...
2024-02-09 13:44:26,782 - infest - WARNING - here to count the records in the df
2024-02-09 13:44:27,325 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:44:27,325 - root - INFO - implementing data processing...
2024-02-09 13:44:27,325 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:44:27,325 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:44:27,348 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:44:27,362 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:44:27,371 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:44:27,400 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:44:27,412 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:44:27,412 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:44:27,431 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:44:29,529 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:44:29,529 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:44:29,529 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:44:29,768 - root - INFO - validating schema for dataframe....
2024-02-09 13:44:29,768 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:44:29,769 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:44:29,769 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:44:29,769 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:44:29,769 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:44:29,769 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:44:29,769 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:44:29,769 - validate - INFO - print schema done, go forward....
2024-02-09 13:44:29,769 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:44:29,770 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:44:29,771 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:44:29,771 - validate - INFO - print schema done, go forward....
2024-02-09 13:44:29,877 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:44:29,877 - root - INFO - transformation data processing....
2024-02-09 13:44:29,877 - root - INFO - displaying the df_report_1
2024-02-09 13:44:29,877 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:44:29,877 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:44:29,903 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:44:29,936 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:44:29,979 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:44:29,979 - root - INFO - display data_report2 method...
2024-02-09 13:44:29,979 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:44:29,979 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:44:30,068 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:44:36,225 - root - INFO - extracting files output....
2024-02-09 13:44:36,226 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:51:07,954 - root - INFO - i am the main method...
2024-02-09 13:51:07,954 - root - INFO - calling spark object
2024-02-09 13:51:07,954 - create_spark - INFO - get_spark_object method started
2024-02-09 13:51:07,954 - create_spark - INFO - master is local
2024-02-09 13:51:10,911 - create_spark - INFO - Spark object create....
2024-02-09 13:51:10,911 - root - INFO - Validating spark object.......
2024-02-09 13:51:10,911 - validate - WARNING - started the get_current_date method...
2024-02-09 13:51:13,300 - validate - WARNING - Validation done, go forward...
2024-02-09 13:51:13,300 - root - INFO - Reading file which is of > parquet
2024-02-09 13:51:13,300 - infest - WARNING - Load_file method started...
2024-02-09 13:51:13,795 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:51:13,799 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:51:15,134 - root - INFO - validating the dataframe...
2024-02-09 13:51:15,134 - infest - WARNING - here to count the records in the df
2024-02-09 13:51:15,516 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:51:15,517 - infest - WARNING - Load_file method started...
2024-02-09 13:51:15,885 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:51:15,886 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:51:16,108 - root - INFO - validating the dataframe...
2024-02-09 13:51:16,108 - infest - WARNING - here to count the records in the df
2024-02-09 13:51:16,657 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:51:16,657 - root - INFO - implementing data processing...
2024-02-09 13:51:16,657 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:51:16,657 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:51:16,683 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:51:16,698 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:51:16,707 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:51:16,735 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:51:16,750 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:51:16,750 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:51:16,768 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:51:19,147 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:51:19,147 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:51:19,148 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:51:19,438 - root - INFO - validating schema for dataframe....
2024-02-09 13:51:19,438 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:51:19,439 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:51:19,439 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:51:19,439 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:51:19,439 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:51:19,439 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:51:19,439 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:51:19,440 - validate - INFO - print schema done, go forward....
2024-02-09 13:51:19,440 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:51:19,441 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:51:19,442 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:51:19,442 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:51:19,442 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:51:19,442 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:51:19,442 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:51:19,442 - validate - INFO - print schema done, go forward....
2024-02-09 13:51:19,548 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:51:19,548 - root - INFO - transformation data processing....
2024-02-09 13:51:19,548 - root - INFO - displaying the df_report_1
2024-02-09 13:51:19,548 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:51:19,550 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:51:19,574 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:51:19,603 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:51:19,643 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:51:19,644 - root - INFO - display data_report2 method...
2024-02-09 13:51:19,644 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:51:19,644 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:51:19,732 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:51:26,282 - root - INFO - extracting files output....
2024-02-09 13:51:26,282 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:54:00,500 - root - INFO - i am the main method...
2024-02-09 13:54:00,500 - root - INFO - calling spark object
2024-02-09 13:54:00,500 - create_spark - INFO - get_spark_object method started
2024-02-09 13:54:00,500 - create_spark - INFO - master is local
2024-02-09 13:54:03,572 - create_spark - INFO - Spark object create....
2024-02-09 13:54:03,572 - root - INFO - Validating spark object.......
2024-02-09 13:54:03,572 - validate - WARNING - started the get_current_date method...
2024-02-09 13:54:05,912 - validate - WARNING - Validation done, go forward...
2024-02-09 13:54:05,912 - root - INFO - Reading file which is of > parquet
2024-02-09 13:54:05,912 - infest - WARNING - Load_file method started...
2024-02-09 13:54:06,340 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:54:06,343 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:54:07,565 - root - INFO - validating the dataframe...
2024-02-09 13:54:07,565 - infest - WARNING - here to count the records in the df
2024-02-09 13:54:07,921 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:54:07,921 - infest - WARNING - Load_file method started...
2024-02-09 13:54:08,253 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:54:08,254 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:54:08,452 - root - INFO - validating the dataframe...
2024-02-09 13:54:08,452 - infest - WARNING - here to count the records in the df
2024-02-09 13:54:08,974 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:54:08,974 - root - INFO - implementing data processing...
2024-02-09 13:54:08,975 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:54:08,975 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:54:09,002 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:54:09,016 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:54:09,025 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:54:09,054 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:54:09,068 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:54:09,069 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:54:09,087 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:54:11,441 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:54:11,441 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:54:11,441 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:54:11,705 - root - INFO - validating schema for dataframe....
2024-02-09 13:54:11,705 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:54:11,706 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:54:11,706 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:54:11,706 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:54:11,706 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:54:11,706 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:54:11,706 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:54:11,707 - validate - INFO - print schema done, go forward....
2024-02-09 13:54:11,707 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:54:11,708 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:54:11,709 - validate - INFO - print schema done, go forward....
2024-02-09 13:54:11,831 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:54:11,831 - root - INFO - transformation data processing....
2024-02-09 13:54:11,831 - root - INFO - displaying the df_report_1
2024-02-09 13:54:11,831 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:54:11,832 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:54:11,864 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:54:11,898 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:54:11,943 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:54:11,943 - root - INFO - display data_report2 method...
2024-02-09 13:54:11,943 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:54:11,943 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:54:12,022 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:54:18,683 - root - INFO - extracting files output....
2024-02-09 13:54:18,683 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:54:59,506 - root - INFO - i am the main method...
2024-02-09 13:54:59,506 - root - INFO - calling spark object
2024-02-09 13:54:59,506 - create_spark - INFO - get_spark_object method started
2024-02-09 13:54:59,506 - create_spark - INFO - master is local
2024-02-09 13:55:02,498 - create_spark - INFO - Spark object create....
2024-02-09 13:55:02,498 - root - INFO - Validating spark object.......
2024-02-09 13:55:02,498 - validate - WARNING - started the get_current_date method...
2024-02-09 13:55:04,764 - validate - WARNING - Validation done, go forward...
2024-02-09 13:55:04,764 - root - INFO - Reading file which is of > parquet
2024-02-09 13:55:04,764 - infest - WARNING - Load_file method started...
2024-02-09 13:55:05,186 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:55:05,189 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:55:06,428 - root - INFO - validating the dataframe...
2024-02-09 13:55:06,428 - infest - WARNING - here to count the records in the df
2024-02-09 13:55:06,782 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:55:06,782 - infest - WARNING - Load_file method started...
2024-02-09 13:55:07,121 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:55:07,124 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:55:07,314 - root - INFO - validating the dataframe...
2024-02-09 13:55:07,314 - infest - WARNING - here to count the records in the df
2024-02-09 13:55:07,875 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:55:07,876 - root - INFO - implementing data processing...
2024-02-09 13:55:07,876 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:55:07,876 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:55:07,900 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:55:07,913 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:55:07,922 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:55:07,945 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:55:07,959 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:55:07,959 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:55:07,975 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:55:10,075 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:55:10,075 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:55:10,075 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:55:10,313 - root - INFO - validating schema for dataframe....
2024-02-09 13:55:10,313 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:55:10,314 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:55:10,314 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:55:10,314 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:55:10,314 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:55:10,314 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:55:10,314 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:55:10,314 - validate - INFO - print schema done, go forward....
2024-02-09 13:55:10,314 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:55:10,315 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:55:10,316 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:55:10,316 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:55:10,316 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:55:10,316 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:55:10,316 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:55:10,316 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:55:10,316 - validate - INFO - print schema done, go forward....
2024-02-09 13:55:10,422 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:55:10,422 - root - INFO - transformation data processing....
2024-02-09 13:55:10,422 - root - INFO - displaying the df_report_1
2024-02-09 13:55:10,422 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:55:10,423 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:55:10,455 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:55:10,498 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:55:10,554 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:55:10,554 - root - INFO - display data_report2 method...
2024-02-09 13:55:10,555 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:55:10,555 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:55:10,648 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:55:16,851 - root - INFO - extracting files output....
2024-02-09 13:55:16,851 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:56:14,657 - root - INFO - i am the main method...
2024-02-09 13:56:14,657 - root - INFO - calling spark object
2024-02-09 13:56:14,657 - create_spark - INFO - get_spark_object method started
2024-02-09 13:56:14,657 - create_spark - INFO - master is local
2024-02-09 13:56:17,581 - create_spark - INFO - Spark object create....
2024-02-09 13:56:17,581 - root - INFO - Validating spark object.......
2024-02-09 13:56:17,581 - validate - WARNING - started the get_current_date method...
2024-02-09 13:56:19,918 - validate - WARNING - Validation done, go forward...
2024-02-09 13:56:19,918 - root - INFO - Reading file which is of > parquet
2024-02-09 13:56:19,918 - infest - WARNING - Load_file method started...
2024-02-09 13:56:20,359 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:56:20,361 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:56:21,634 - root - INFO - validating the dataframe...
2024-02-09 13:56:21,634 - infest - WARNING - here to count the records in the df
2024-02-09 13:56:22,106 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:56:22,106 - infest - WARNING - Load_file method started...
2024-02-09 13:56:22,430 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:56:22,432 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:56:22,621 - root - INFO - validating the dataframe...
2024-02-09 13:56:22,621 - infest - WARNING - here to count the records in the df
2024-02-09 13:56:23,195 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:56:23,195 - root - INFO - implementing data processing...
2024-02-09 13:56:23,195 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:56:23,195 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:56:23,219 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:56:23,233 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:56:23,241 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:56:23,267 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:56:23,278 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:56:23,279 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:56:23,293 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:56:25,545 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:56:25,545 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:56:25,545 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:56:25,775 - root - INFO - validating schema for dataframe....
2024-02-09 13:56:25,775 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:56:25,776 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:56:25,776 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:56:25,776 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:56:25,776 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:56:25,776 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:56:25,776 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:56:25,776 - validate - INFO - print schema done, go forward....
2024-02-09 13:56:25,776 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:56:25,777 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:56:25,777 - validate - INFO - print schema done, go forward....
2024-02-09 13:56:25,888 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:56:25,888 - root - INFO - transformation data processing....
2024-02-09 13:56:25,888 - root - INFO - displaying the df_report_1
2024-02-09 13:56:25,888 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:56:25,889 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:56:25,913 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:56:25,941 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:56:25,978 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:56:25,978 - root - INFO - display data_report2 method...
2024-02-09 13:56:25,978 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:56:25,978 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:56:26,047 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:56:31,989 - root - INFO - extracting files output....
2024-02-09 13:56:31,989 - extraction - WARNING - extracting_file method starting....
2024-02-09 13:57:18,600 - root - INFO - i am the main method...
2024-02-09 13:57:18,600 - root - INFO - calling spark object
2024-02-09 13:57:18,600 - create_spark - INFO - get_spark_object method started
2024-02-09 13:57:18,600 - create_spark - INFO - master is local
2024-02-09 13:57:21,570 - create_spark - INFO - Spark object create....
2024-02-09 13:57:21,571 - root - INFO - Validating spark object.......
2024-02-09 13:57:21,571 - validate - WARNING - started the get_current_date method...
2024-02-09 13:57:24,018 - validate - WARNING - Validation done, go forward...
2024-02-09 13:57:24,018 - root - INFO - Reading file which is of > parquet
2024-02-09 13:57:24,018 - infest - WARNING - Load_file method started...
2024-02-09 13:57:24,495 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 13:57:24,498 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 13:57:25,841 - root - INFO - validating the dataframe...
2024-02-09 13:57:25,841 - infest - WARNING - here to count the records in the df
2024-02-09 13:57:26,212 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 13:57:26,212 - infest - WARNING - Load_file method started...
2024-02-09 13:57:26,560 - infest - WARNING - dataframe created  which is if csv
2024-02-09 13:57:26,562 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 13:57:26,779 - root - INFO - validating the dataframe...
2024-02-09 13:57:26,779 - infest - WARNING - here to count the records in the df
2024-02-09 13:57:27,349 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 13:57:27,349 - root - INFO - implementing data processing...
2024-02-09 13:57:27,349 - data_processing - WARNING - data_clean method() stating....
2024-02-09 13:57:27,349 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 13:57:27,374 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 13:57:27,389 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 13:57:27,399 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 13:57:27,425 - data_processing - WARNING - concat firstName and lastName
2024-02-09 13:57:27,440 - data_processing - WARNING - now check for null values in all column
2024-02-09 13:57:27,440 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 13:57:27,459 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 13:57:29,633 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 13:57:29,633 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 13:57:29,633 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 13:57:29,899 - root - INFO - validating schema for dataframe....
2024-02-09 13:57:29,899 - validate - WARNING - printing schema method starting... df_city
2024-02-09 13:57:29,900 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 13:57:29,900 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 13:57:29,900 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 13:57:29,900 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 13:57:29,900 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 13:57:29,900 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 13:57:29,901 - validate - INFO - print schema done, go forward....
2024-02-09 13:57:29,901 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 13:57:29,902 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 13:57:29,902 - validate - INFO - print schema done, go forward....
2024-02-09 13:57:30,032 - root - INFO - checking null values schema for dataframe....
2024-02-09 13:57:30,032 - root - INFO - transformation data processing....
2024-02-09 13:57:30,032 - root - INFO - displaying the df_report_1
2024-02-09 13:57:30,032 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 13:57:30,033 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 13:57:30,071 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 13:57:30,112 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 13:57:30,163 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 13:57:30,163 - root - INFO - display data_report2 method...
2024-02-09 13:57:30,163 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 13:57:30,163 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 13:57:30,254 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 13:57:36,713 - root - INFO - extracting files output....
2024-02-09 13:57:36,713 - extraction - WARNING - extracting_file method starting....
2024-02-09 14:01:52,570 - root - INFO - i am the main method...
2024-02-09 14:01:52,570 - root - INFO - calling spark object
2024-02-09 14:01:52,570 - create_spark - INFO - get_spark_object method started
2024-02-09 14:01:52,570 - create_spark - INFO - master is local
2024-02-09 14:01:56,499 - create_spark - INFO - Spark object create....
2024-02-09 14:01:56,499 - root - INFO - Validating spark object.......
2024-02-09 14:01:56,499 - validate - WARNING - started the get_current_date method...
2024-02-09 14:01:58,754 - validate - WARNING - Validation done, go forward...
2024-02-09 14:01:58,754 - root - INFO - Reading file which is of > parquet
2024-02-09 14:01:58,754 - infest - WARNING - Load_file method started...
2024-02-09 14:01:59,148 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 14:01:59,151 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 14:02:00,440 - root - INFO - validating the dataframe...
2024-02-09 14:02:00,440 - infest - WARNING - here to count the records in the df
2024-02-09 14:02:00,784 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 14:02:00,784 - infest - WARNING - Load_file method started...
2024-02-09 14:02:01,117 - infest - WARNING - dataframe created  which is if csv
2024-02-09 14:02:01,119 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 14:02:01,311 - root - INFO - validating the dataframe...
2024-02-09 14:02:01,311 - infest - WARNING - here to count the records in the df
2024-02-09 14:02:01,907 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 14:02:01,907 - root - INFO - implementing data processing...
2024-02-09 14:02:01,908 - data_processing - WARNING - data_clean method() stating....
2024-02-09 14:02:01,908 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 14:02:01,932 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 14:02:01,947 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 14:02:01,955 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 14:02:01,982 - data_processing - WARNING - concat firstName and lastName
2024-02-09 14:02:01,995 - data_processing - WARNING - now check for null values in all column
2024-02-09 14:02:01,995 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 14:02:02,011 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 14:02:04,241 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 14:02:04,241 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 14:02:04,242 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 14:02:04,478 - root - INFO - validating schema for dataframe....
2024-02-09 14:02:04,478 - validate - WARNING - printing schema method starting... df_city
2024-02-09 14:02:04,479 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 14:02:04,479 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 14:02:04,479 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 14:02:04,479 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 14:02:04,479 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 14:02:04,479 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 14:02:04,479 - validate - INFO - print schema done, go forward....
2024-02-09 14:02:04,479 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 14:02:04,480 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 14:02:04,480 - validate - INFO - print schema done, go forward....
2024-02-09 14:02:04,586 - root - INFO - checking null values schema for dataframe....
2024-02-09 14:02:04,586 - root - INFO - transformation data processing....
2024-02-09 14:02:04,586 - root - INFO - displaying the df_report_1
2024-02-09 14:02:04,586 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 14:02:04,587 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 14:02:04,615 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 14:02:04,651 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 14:02:04,695 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 14:02:04,696 - root - INFO - display data_report2 method...
2024-02-09 14:02:04,696 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 14:02:04,696 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 14:02:04,774 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 14:02:10,882 - root - INFO - extracting files output....
2024-02-09 14:02:10,883 - extraction - WARNING - extracting_file method starting....
2024-02-09 14:16:40,132 - root - INFO - i am the main method...
2024-02-09 14:16:40,132 - root - INFO - calling spark object
2024-02-09 14:16:40,133 - create_spark - INFO - get_spark_object method started
2024-02-09 14:16:40,133 - create_spark - INFO - master is local
2024-02-09 14:16:43,176 - create_spark - INFO - Spark object create....
2024-02-09 14:16:43,176 - root - INFO - Validating spark object.......
2024-02-09 14:16:43,176 - validate - WARNING - started the get_current_date method...
2024-02-09 14:16:45,586 - validate - WARNING - Validation done, go forward...
2024-02-09 14:16:45,587 - root - INFO - Reading file which is of > parquet
2024-02-09 14:16:45,587 - infest - WARNING - Load_file method started...
2024-02-09 14:16:46,047 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 14:16:46,050 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 14:16:47,348 - root - INFO - validating the dataframe...
2024-02-09 14:16:47,348 - infest - WARNING - here to count the records in the df
2024-02-09 14:16:47,719 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 14:16:47,720 - infest - WARNING - Load_file method started...
2024-02-09 14:16:48,085 - infest - WARNING - dataframe created  which is if csv
2024-02-09 14:16:48,086 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 14:16:48,310 - root - INFO - validating the dataframe...
2024-02-09 14:16:48,310 - infest - WARNING - here to count the records in the df
2024-02-09 14:16:48,964 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 14:16:48,964 - root - INFO - implementing data processing...
2024-02-09 14:16:48,964 - data_processing - WARNING - data_clean method() stating....
2024-02-09 14:16:48,964 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 14:16:48,991 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 14:16:49,006 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 14:16:49,016 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 14:16:49,046 - data_processing - WARNING - concat firstName and lastName
2024-02-09 14:16:49,061 - data_processing - WARNING - now check for null values in all column
2024-02-09 14:16:49,061 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 14:16:49,080 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 14:16:51,325 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 14:16:51,325 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 14:16:51,325 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 14:16:51,569 - root - INFO - validating schema for dataframe....
2024-02-09 14:16:51,569 - validate - WARNING - printing schema method starting... df_city
2024-02-09 14:16:51,570 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 14:16:51,570 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 14:16:51,570 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 14:16:51,570 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 14:16:51,570 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 14:16:51,571 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 14:16:51,571 - validate - INFO - print schema done, go forward....
2024-02-09 14:16:51,571 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 14:16:51,572 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 14:16:51,573 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 14:16:51,573 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 14:16:51,573 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 14:16:51,573 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 14:16:51,573 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 14:16:51,573 - validate - INFO - print schema done, go forward....
2024-02-09 14:16:51,684 - root - INFO - checking null values schema for dataframe....
2024-02-09 14:16:51,684 - root - INFO - transformation data processing....
2024-02-09 14:16:51,684 - root - INFO - displaying the df_report_1
2024-02-09 14:16:51,684 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 14:16:51,685 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 14:16:51,711 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 14:16:51,745 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 14:16:51,788 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 14:16:51,788 - root - INFO - display data_report2 method...
2024-02-09 14:16:51,788 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 14:16:51,788 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 14:16:51,870 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 14:16:58,689 - root - INFO - extracting files output....
2024-02-09 14:16:58,689 - extraction - WARNING - extracting_file method starting....
2024-02-09 14:30:35,984 - root - INFO - i am the main method...
2024-02-09 14:30:35,985 - root - INFO - calling spark object
2024-02-09 14:30:35,985 - create_spark - INFO - get_spark_object method started
2024-02-09 14:30:35,985 - create_spark - INFO - master is local
2024-02-09 14:30:41,146 - create_spark - INFO - Spark object create....
2024-02-09 14:30:41,147 - root - INFO - Validating spark object.......
2024-02-09 14:30:41,147 - validate - WARNING - started the get_current_date method...
2024-02-09 14:30:44,695 - validate - WARNING - Validation done, go forward...
2024-02-09 14:30:44,695 - root - INFO - Reading file which is of > parquet
2024-02-09 14:30:44,696 - infest - WARNING - Load_file method started...
2024-02-09 14:30:45,465 - infest - WARNING - dataframe created  which is if parquet
2024-02-09 14:30:45,469 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-09 14:30:47,513 - root - INFO - validating the dataframe...
2024-02-09 14:30:47,513 - infest - WARNING - here to count the records in the df
2024-02-09 14:30:48,090 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-09 14:30:48,091 - infest - WARNING - Load_file method started...
2024-02-09 14:30:48,657 - infest - WARNING - dataframe created  which is if csv
2024-02-09 14:30:48,660 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-09 14:30:49,003 - root - INFO - validating the dataframe...
2024-02-09 14:30:49,003 - infest - WARNING - here to count the records in the df
2024-02-09 14:30:49,888 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-09 14:30:49,888 - root - INFO - implementing data processing...
2024-02-09 14:30:49,888 - data_processing - WARNING - data_clean method() stating....
2024-02-09 14:30:49,888 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-09 14:30:49,931 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-09 14:30:49,953 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-09 14:30:49,967 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-09 14:30:50,003 - data_processing - WARNING - concat firstName and lastName
2024-02-09 14:30:50,020 - data_processing - WARNING - now check for null values in all column
2024-02-09 14:30:50,020 - data_processing - WARNING - drop the null values in the respective column...
2024-02-09 14:30:50,041 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-09 14:30:53,341 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-09 14:30:53,341 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-09 14:30:53,341 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-09 14:30:53,697 - root - INFO - validating schema for dataframe....
2024-02-09 14:30:53,697 - validate - WARNING - printing schema method starting... df_city
2024-02-09 14:30:53,698 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-09 14:30:53,698 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-09 14:30:53,698 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-09 14:30:53,698 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-09 14:30:53,698 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-09 14:30:53,699 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-09 14:30:53,699 - validate - INFO - print schema done, go forward....
2024-02-09 14:30:53,699 - validate - WARNING - printing schema method starting... df_fact
2024-02-09 14:30:53,700 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-09 14:30:53,700 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-09 14:30:53,700 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-09 14:30:53,700 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-09 14:30:53,701 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-09 14:30:53,701 - validate - INFO - print schema done, go forward....
2024-02-09 14:30:53,853 - root - INFO - checking null values schema for dataframe....
2024-02-09 14:30:53,853 - root - INFO - transformation data processing....
2024-02-09 14:30:53,853 - root - INFO - displaying the df_report_1
2024-02-09 14:30:53,853 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-09 14:30:53,854 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-09 14:30:53,895 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-09 14:30:53,954 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-09 14:30:54,023 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-09 14:30:54,024 - root - INFO - display data_report2 method...
2024-02-09 14:30:54,024 - data_transformation - WARNING - executing data_report2 method...
2024-02-09 14:30:54,024 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-09 14:30:54,129 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-09 14:31:03,111 - root - INFO - extracting files output....
2024-02-09 14:31:03,111 - extraction - WARNING - extracting_file method starting....
2024-02-13 08:45:25,258 - root - INFO - i am the main method...
2024-02-13 08:45:25,258 - root - INFO - calling spark object
2024-02-13 08:45:25,258 - create_spark - INFO - get_spark_object method started
2024-02-13 08:45:25,258 - create_spark - INFO - master is local
2024-02-13 08:45:30,338 - create_spark - INFO - Spark object create....
2024-02-13 08:45:30,338 - root - INFO - Validating spark object.......
2024-02-13 08:45:30,338 - validate - WARNING - started the get_current_date method...
2024-02-13 08:45:33,986 - validate - WARNING - Validation done, go forward...
2024-02-13 08:45:33,986 - root - INFO - Reading file which is of > parquet
2024-02-13 08:45:33,986 - infest - WARNING - Load_file method started...
2024-02-13 08:45:34,687 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 08:45:34,690 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 08:45:36,496 - root - INFO - validating the dataframe...
2024-02-13 08:45:36,496 - infest - WARNING - here to count the records in the df
2024-02-13 08:45:37,104 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 08:45:37,105 - infest - WARNING - Load_file method started...
2024-02-13 08:45:37,580 - infest - WARNING - dataframe created  which is if csv
2024-02-13 08:45:37,582 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 08:45:37,815 - root - INFO - validating the dataframe...
2024-02-13 08:45:37,815 - infest - WARNING - here to count the records in the df
2024-02-13 08:45:38,460 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 08:45:38,460 - root - INFO - implementing data processing...
2024-02-13 08:45:38,461 - data_processing - WARNING - data_clean method() stating....
2024-02-13 08:45:38,461 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 08:45:38,487 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 08:45:38,500 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 08:45:38,510 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 08:45:38,535 - data_processing - WARNING - concat firstName and lastName
2024-02-13 08:45:38,549 - data_processing - WARNING - now check for null values in all column
2024-02-13 08:45:38,549 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 08:45:38,566 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 08:45:40,722 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 08:45:40,722 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 08:45:40,722 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 08:45:40,999 - root - INFO - validating schema for dataframe....
2024-02-13 08:45:40,999 - validate - WARNING - printing schema method starting... df_city
2024-02-13 08:45:41,000 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 08:45:41,001 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 08:45:41,001 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 08:45:41,001 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 08:45:41,001 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 08:45:41,001 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 08:45:41,001 - validate - INFO - print schema done, go forward....
2024-02-13 08:45:41,001 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 08:45:41,002 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 08:45:41,003 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 08:45:41,003 - validate - INFO - print schema done, go forward....
2024-02-13 08:45:41,123 - root - INFO - checking null values schema for dataframe....
2024-02-13 08:45:41,123 - root - INFO - transformation data processing....
2024-02-13 08:45:41,123 - root - INFO - displaying the df_report_1
2024-02-13 08:45:41,123 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 08:45:41,124 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 08:45:41,165 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 08:45:41,199 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 08:45:41,257 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 08:45:41,257 - root - INFO - display data_report2 method...
2024-02-13 08:45:41,257 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 08:45:41,257 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 08:45:41,349 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 08:45:47,854 - root - INFO - extracting files output....
2024-02-13 08:45:47,854 - extraction - WARNING - extracting_file method starting....
2024-02-13 08:45:55,463 - extraction - WARNING - extract_file method successfully...
2024-02-13 08:45:55,464 - root - INFO - total amount of time taken: 30.205110300012166 seconds...
2024-02-13 08:45:55,464 - root - INFO - Application done
2024-02-13 08:47:10,589 - root - INFO - i am the main method...
2024-02-13 08:47:10,589 - root - INFO - calling spark object
2024-02-13 08:47:10,589 - create_spark - INFO - get_spark_object method started
2024-02-13 08:47:10,589 - create_spark - INFO - master is local
2024-02-13 08:47:13,526 - create_spark - INFO - Spark object create....
2024-02-13 08:47:13,526 - root - INFO - Validating spark object.......
2024-02-13 08:47:13,526 - validate - WARNING - started the get_current_date method...
2024-02-13 08:47:15,849 - validate - WARNING - Validation done, go forward...
2024-02-13 08:47:15,850 - root - INFO - Reading file which is of > parquet
2024-02-13 08:47:15,850 - infest - WARNING - Load_file method started...
2024-02-13 08:47:16,281 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 08:47:16,284 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 08:47:17,687 - root - INFO - validating the dataframe...
2024-02-13 08:47:17,687 - infest - WARNING - here to count the records in the df
2024-02-13 08:47:18,092 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 08:47:18,093 - infest - WARNING - Load_file method started...
2024-02-13 08:47:18,463 - infest - WARNING - dataframe created  which is if csv
2024-02-13 08:47:18,465 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 08:47:18,670 - root - INFO - validating the dataframe...
2024-02-13 08:47:18,670 - infest - WARNING - here to count the records in the df
2024-02-13 08:47:19,226 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 08:47:19,226 - root - INFO - implementing data processing...
2024-02-13 08:47:19,226 - data_processing - WARNING - data_clean method() stating....
2024-02-13 08:47:19,226 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 08:47:19,251 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 08:47:19,263 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 08:47:19,271 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 08:47:19,295 - data_processing - WARNING - concat firstName and lastName
2024-02-13 08:47:19,311 - data_processing - WARNING - now check for null values in all column
2024-02-13 08:47:19,311 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 08:47:19,327 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 08:47:21,461 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 08:47:21,461 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 08:47:21,461 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 08:47:21,697 - root - INFO - validating schema for dataframe....
2024-02-13 08:47:21,697 - validate - WARNING - printing schema method starting... df_city
2024-02-13 08:47:21,698 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 08:47:21,698 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 08:47:21,698 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 08:47:21,698 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 08:47:21,698 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 08:47:21,698 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 08:47:21,698 - validate - INFO - print schema done, go forward....
2024-02-13 08:47:21,699 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 08:47:21,700 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 08:47:21,700 - validate - INFO - print schema done, go forward....
2024-02-13 08:47:21,800 - root - INFO - checking null values schema for dataframe....
2024-02-13 08:47:21,800 - root - INFO - transformation data processing....
2024-02-13 08:47:21,800 - root - INFO - displaying the df_report_1
2024-02-13 08:47:21,800 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 08:47:21,801 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 08:47:21,826 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 08:47:21,853 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 08:47:21,894 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 08:47:21,894 - root - INFO - display data_report2 method...
2024-02-13 08:47:21,894 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 08:47:21,894 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 08:47:21,971 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 08:47:28,193 - root - INFO - extracting files output....
2024-02-13 08:47:28,193 - extraction - WARNING - extracting_file method starting....
2024-02-13 08:47:34,879 - extraction - WARNING - extract_file method successfully...
2024-02-13 08:47:34,880 - root - INFO - total amount of time taken: 24.291271499998402 seconds...
2024-02-13 08:47:34,880 - root - INFO - Application done
2024-02-13 08:47:51,102 - root - INFO - i am the main method...
2024-02-13 08:47:51,102 - root - INFO - calling spark object
2024-02-13 08:47:51,102 - create_spark - INFO - get_spark_object method started
2024-02-13 08:47:51,102 - create_spark - INFO - master is local
2024-02-13 08:47:53,995 - create_spark - INFO - Spark object create....
2024-02-13 08:47:53,995 - root - INFO - Validating spark object.......
2024-02-13 08:47:53,995 - validate - WARNING - started the get_current_date method...
2024-02-13 08:47:56,293 - validate - WARNING - Validation done, go forward...
2024-02-13 08:47:56,294 - root - INFO - Reading file which is of > parquet
2024-02-13 08:47:56,294 - infest - WARNING - Load_file method started...
2024-02-13 08:47:56,702 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 08:47:56,705 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 08:47:57,930 - root - INFO - validating the dataframe...
2024-02-13 08:47:57,930 - infest - WARNING - here to count the records in the df
2024-02-13 08:47:58,298 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 08:47:58,298 - infest - WARNING - Load_file method started...
2024-02-13 08:47:58,661 - infest - WARNING - dataframe created  which is if csv
2024-02-13 08:47:58,663 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 08:47:58,855 - root - INFO - validating the dataframe...
2024-02-13 08:47:58,855 - infest - WARNING - here to count the records in the df
2024-02-13 08:47:59,410 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 08:47:59,410 - root - INFO - implementing data processing...
2024-02-13 08:47:59,410 - data_processing - WARNING - data_clean method() stating....
2024-02-13 08:47:59,410 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 08:47:59,433 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 08:47:59,446 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 08:47:59,453 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 08:47:59,476 - data_processing - WARNING - concat firstName and lastName
2024-02-13 08:47:59,489 - data_processing - WARNING - now check for null values in all column
2024-02-13 08:47:59,489 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 08:47:59,504 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 08:48:01,570 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 08:48:01,570 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 08:48:01,570 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 08:48:01,793 - root - INFO - validating schema for dataframe....
2024-02-13 08:48:01,793 - validate - WARNING - printing schema method starting... df_city
2024-02-13 08:48:01,794 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 08:48:01,794 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 08:48:01,794 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 08:48:01,794 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 08:48:01,794 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 08:48:01,794 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 08:48:01,794 - validate - INFO - print schema done, go forward....
2024-02-13 08:48:01,794 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 08:48:01,795 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 08:48:01,796 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 08:48:01,796 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 08:48:01,796 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 08:48:01,796 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 08:48:01,796 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 08:48:01,796 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 08:48:01,796 - validate - INFO - print schema done, go forward....
2024-02-13 08:48:01,889 - root - INFO - checking null values schema for dataframe....
2024-02-13 08:48:01,889 - root - INFO - transformation data processing....
2024-02-13 08:48:01,889 - root - INFO - displaying the df_report_1
2024-02-13 08:48:01,889 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 08:48:01,889 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 08:48:01,913 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 08:48:01,944 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 08:48:01,984 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 08:48:01,984 - root - INFO - display data_report2 method...
2024-02-13 08:48:01,984 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 08:48:01,984 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 08:48:02,065 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 08:48:08,298 - root - INFO - extracting files output....
2024-02-13 08:48:08,298 - extraction - WARNING - extracting_file method starting....
2024-02-13 08:48:15,044 - extraction - WARNING - extract_file method successfully...
2024-02-13 08:49:19,790 - root - INFO - i am the main method...
2024-02-13 08:49:19,790 - root - INFO - calling spark object
2024-02-13 08:49:19,790 - create_spark - INFO - get_spark_object method started
2024-02-13 08:49:19,790 - create_spark - INFO - master is local
2024-02-13 08:49:22,965 - create_spark - INFO - Spark object create....
2024-02-13 08:49:22,965 - root - INFO - Validating spark object.......
2024-02-13 08:49:22,965 - validate - WARNING - started the get_current_date method...
2024-02-13 08:49:25,821 - validate - WARNING - Validation done, go forward...
2024-02-13 08:49:25,821 - root - INFO - Reading file which is of > parquet
2024-02-13 08:49:25,821 - infest - WARNING - Load_file method started...
2024-02-13 08:49:26,296 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 08:49:26,299 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 08:49:27,616 - root - INFO - validating the dataframe...
2024-02-13 08:49:27,616 - infest - WARNING - here to count the records in the df
2024-02-13 08:49:27,978 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 08:49:27,979 - infest - WARNING - Load_file method started...
2024-02-13 08:49:28,296 - infest - WARNING - dataframe created  which is if csv
2024-02-13 08:49:28,297 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 08:49:28,473 - root - INFO - validating the dataframe...
2024-02-13 08:49:28,473 - infest - WARNING - here to count the records in the df
2024-02-13 08:49:28,998 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 08:49:28,998 - root - INFO - implementing data processing...
2024-02-13 08:49:28,998 - data_processing - WARNING - data_clean method() stating....
2024-02-13 08:49:28,998 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 08:49:29,024 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 08:49:29,037 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 08:49:29,046 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 08:49:29,076 - data_processing - WARNING - concat firstName and lastName
2024-02-13 08:49:29,091 - data_processing - WARNING - now check for null values in all column
2024-02-13 08:49:29,091 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 08:49:29,110 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 08:49:31,240 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 08:49:31,241 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 08:49:31,241 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 08:49:31,474 - root - INFO - validating schema for dataframe....
2024-02-13 08:49:31,474 - validate - WARNING - printing schema method starting... df_city
2024-02-13 08:49:31,475 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 08:49:31,475 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 08:49:31,475 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 08:49:31,475 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 08:49:31,475 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 08:49:31,475 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 08:49:31,475 - validate - INFO - print schema done, go forward....
2024-02-13 08:49:31,475 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 08:49:31,476 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 08:49:31,476 - validate - INFO - print schema done, go forward....
2024-02-13 08:49:31,590 - root - INFO - checking null values schema for dataframe....
2024-02-13 08:49:31,590 - root - INFO - transformation data processing....
2024-02-13 08:49:31,590 - root - INFO - displaying the df_report_1
2024-02-13 08:49:31,590 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 08:49:31,591 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 08:49:31,620 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 08:49:31,653 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 08:49:31,695 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 08:49:31,695 - root - INFO - display data_report2 method...
2024-02-13 08:49:31,695 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 08:49:31,695 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 08:49:31,767 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 08:49:37,851 - root - INFO - extracting files output....
2024-02-13 08:49:37,851 - extraction - WARNING - extracting_file method starting....
2024-02-13 08:49:44,824 - extraction - WARNING - extract_file method successfully...
2024-02-13 08:49:44,824 - extraction - WARNING - extracting_file method starting....
2024-02-13 08:49:50,719 - extraction - WARNING - extract_file method successfully...
2024-02-13 08:49:50,719 - root - INFO - total amount of time taken: 30.93024119999609 seconds...
2024-02-13 08:49:50,719 - root - INFO - Application done
2024-02-13 09:09:45,861 - root - INFO - i am the main method...
2024-02-13 09:09:45,861 - root - INFO - calling spark object
2024-02-13 09:09:45,861 - create_spark - INFO - get_spark_object method started
2024-02-13 09:09:45,861 - create_spark - INFO - master is local
2024-02-13 09:09:53,012 - create_spark - INFO - Spark object create....
2024-02-13 09:09:53,012 - root - INFO - Validating spark object.......
2024-02-13 09:09:53,012 - validate - WARNING - started the get_current_date method...
2024-02-13 09:09:57,824 - validate - WARNING - Validation done, go forward...
2024-02-13 09:09:57,824 - root - INFO - Reading file which is of > parquet
2024-02-13 09:09:57,825 - infest - WARNING - Load_file method started...
2024-02-13 09:09:58,688 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:09:58,694 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:10:01,403 - root - INFO - validating the dataframe...
2024-02-13 09:10:01,403 - infest - WARNING - here to count the records in the df
2024-02-13 09:10:02,116 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:10:02,116 - infest - WARNING - Load_file method started...
2024-02-13 09:10:02,766 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:10:02,769 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:10:03,118 - root - INFO - validating the dataframe...
2024-02-13 09:10:03,118 - infest - WARNING - here to count the records in the df
2024-02-13 09:10:04,262 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:10:04,263 - root - INFO - implementing data processing...
2024-02-13 09:10:04,263 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:10:04,263 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:10:04,316 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:10:04,346 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:10:04,364 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:10:04,413 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:10:04,438 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:10:04,438 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:10:04,469 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:10:09,194 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:10:09,194 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:10:09,194 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:10:09,680 - root - INFO - validating schema for dataframe....
2024-02-13 09:10:09,680 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:10:09,682 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:10:09,682 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:10:09,682 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:10:09,682 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:10:09,682 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:10:09,683 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:10:09,683 - validate - INFO - print schema done, go forward....
2024-02-13 09:10:09,683 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:10:09,685 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:10:09,685 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:10:09,685 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:10:09,686 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:10:09,687 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:10:09,687 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:10:09,687 - validate - INFO - print schema done, go forward....
2024-02-13 09:10:09,868 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:10:09,868 - root - INFO - transformation data processing....
2024-02-13 09:10:09,868 - root - INFO - displaying the df_report_1
2024-02-13 09:10:09,868 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:10:09,870 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:10:09,920 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:10:09,988 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:10:10,056 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:10:10,056 - root - INFO - display data_report2 method...
2024-02-13 09:10:10,056 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:10:10,056 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:10:10,181 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:10:23,370 - root - INFO - extracting files output....
2024-02-13 09:10:23,370 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:10:38,190 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:10:38,191 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:10:51,643 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:10:51,643 - root - INFO - total amount of time taken: 65.78252730000531 seconds...
2024-02-13 09:10:51,644 - root - INFO - Application done
2024-02-13 09:29:59,010 - root - INFO - i am the main method...
2024-02-13 09:29:59,011 - root - INFO - calling spark object
2024-02-13 09:29:59,011 - create_spark - INFO - get_spark_object method started
2024-02-13 09:29:59,011 - create_spark - INFO - master is local
2024-02-13 09:30:05,353 - create_spark - INFO - Spark object create....
2024-02-13 09:30:05,354 - root - INFO - Validating spark object.......
2024-02-13 09:30:05,354 - validate - WARNING - started the get_current_date method...
2024-02-13 09:30:10,362 - validate - WARNING - Validation done, go forward...
2024-02-13 09:30:10,362 - root - INFO - Reading file which is of > parquet
2024-02-13 09:30:10,362 - infest - WARNING - Load_file method started...
2024-02-13 09:30:11,249 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:30:11,255 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:30:14,053 - root - INFO - validating the dataframe...
2024-02-13 09:30:14,053 - infest - WARNING - here to count the records in the df
2024-02-13 09:30:14,828 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:30:14,828 - infest - WARNING - Load_file method started...
2024-02-13 09:30:15,556 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:30:15,560 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:30:15,931 - root - INFO - validating the dataframe...
2024-02-13 09:30:15,931 - infest - WARNING - here to count the records in the df
2024-02-13 09:30:17,085 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:30:17,085 - root - INFO - implementing data processing...
2024-02-13 09:30:17,085 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:30:17,086 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:30:17,148 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:30:17,186 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:30:17,206 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:30:17,259 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:30:17,285 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:30:17,286 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:30:17,316 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:30:22,070 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:30:22,070 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:30:22,070 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:30:22,562 - root - INFO - validating schema for dataframe....
2024-02-13 09:30:22,562 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:30:22,565 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:30:22,565 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:30:22,565 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:30:22,565 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:30:22,565 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:30:22,565 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:30:22,565 - validate - INFO - print schema done, go forward....
2024-02-13 09:30:22,566 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:30:22,567 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:30:22,567 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:30:22,568 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:30:22,569 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:30:22,569 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:30:22,569 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:30:22,569 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:30:22,569 - validate - INFO - print schema done, go forward....
2024-02-13 09:30:22,765 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:30:22,765 - root - INFO - transformation data processing....
2024-02-13 09:30:22,765 - root - INFO - displaying the df_report_1
2024-02-13 09:30:22,765 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:30:22,767 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:30:22,821 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:30:22,885 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:30:22,959 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:30:22,959 - root - INFO - display data_report2 method...
2024-02-13 09:30:22,959 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:30:22,960 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:30:23,115 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:30:37,651 - root - INFO - extracting files output....
2024-02-13 09:30:37,651 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:30:52,204 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:30:52,204 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:31:05,585 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:36:48,895 - root - INFO - i am the main method...
2024-02-13 09:36:48,895 - root - INFO - calling spark object
2024-02-13 09:36:48,895 - create_spark - INFO - get_spark_object method started
2024-02-13 09:36:48,895 - create_spark - INFO - master is local
2024-02-13 09:36:55,543 - create_spark - INFO - Spark object create....
2024-02-13 09:36:55,544 - root - INFO - Validating spark object.......
2024-02-13 09:36:55,544 - validate - WARNING - started the get_current_date method...
2024-02-13 09:37:00,415 - validate - WARNING - Validation done, go forward...
2024-02-13 09:37:00,416 - root - INFO - Reading file which is of > parquet
2024-02-13 09:37:00,416 - infest - WARNING - Load_file method started...
2024-02-13 09:37:01,328 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:37:01,334 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:37:04,127 - root - INFO - validating the dataframe...
2024-02-13 09:37:04,127 - infest - WARNING - here to count the records in the df
2024-02-13 09:37:04,924 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:37:04,924 - infest - WARNING - Load_file method started...
2024-02-13 09:37:05,644 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:37:05,647 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:37:06,109 - root - INFO - validating the dataframe...
2024-02-13 09:37:06,109 - infest - WARNING - here to count the records in the df
2024-02-13 09:37:07,220 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:37:07,222 - root - INFO - implementing data processing...
2024-02-13 09:37:07,222 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:37:07,222 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:37:07,277 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:37:07,312 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:37:07,329 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:37:07,384 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:37:07,408 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:37:07,409 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:37:07,439 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:37:12,282 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:37:12,282 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:37:12,282 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:37:12,786 - root - INFO - validating schema for dataframe....
2024-02-13 09:37:12,786 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:37:12,789 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:37:12,789 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:37:12,789 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:37:12,789 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:37:12,789 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:37:12,790 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:37:12,790 - validate - INFO - print schema done, go forward....
2024-02-13 09:37:12,790 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:37:12,792 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:37:12,793 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:37:12,793 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:37:12,793 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:37:12,793 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:37:12,793 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:37:12,793 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:37:12,793 - validate - INFO - print schema done, go forward....
2024-02-13 09:37:12,982 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:37:12,982 - root - INFO - transformation data processing....
2024-02-13 09:37:12,982 - root - INFO - displaying the df_report_1
2024-02-13 09:37:12,982 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:37:12,984 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:37:13,036 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:37:13,103 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:37:13,183 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:37:13,183 - root - INFO - display data_report2 method...
2024-02-13 09:37:13,183 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:37:13,183 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:37:13,318 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:37:27,173 - root - INFO - extracting files output....
2024-02-13 09:39:59,227 - root - INFO - i am the main method...
2024-02-13 09:39:59,227 - root - INFO - calling spark object
2024-02-13 09:39:59,228 - create_spark - INFO - get_spark_object method started
2024-02-13 09:39:59,228 - create_spark - INFO - master is local
2024-02-13 09:41:26,919 - root - INFO - i am the main method...
2024-02-13 09:41:26,920 - root - INFO - calling spark object
2024-02-13 09:41:26,920 - create_spark - INFO - get_spark_object method started
2024-02-13 09:41:26,920 - create_spark - INFO - master is local
2024-02-13 09:41:33,507 - create_spark - INFO - Spark object create....
2024-02-13 09:41:33,507 - root - INFO - Validating spark object.......
2024-02-13 09:41:33,507 - validate - WARNING - started the get_current_date method...
2024-02-13 09:41:38,553 - validate - WARNING - Validation done, go forward...
2024-02-13 09:41:38,553 - root - INFO - Reading file which is of > parquet
2024-02-13 09:41:38,553 - infest - WARNING - Load_file method started...
2024-02-13 09:41:39,464 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:41:39,469 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:41:42,353 - root - INFO - validating the dataframe...
2024-02-13 09:41:42,353 - infest - WARNING - here to count the records in the df
2024-02-13 09:41:43,120 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:41:43,120 - infest - WARNING - Load_file method started...
2024-02-13 09:41:43,830 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:41:43,833 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:41:44,251 - root - INFO - validating the dataframe...
2024-02-13 09:41:44,251 - infest - WARNING - here to count the records in the df
2024-02-13 09:41:45,390 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:41:45,390 - root - INFO - implementing data processing...
2024-02-13 09:41:45,391 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:41:45,391 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:41:45,444 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:41:45,472 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:41:45,490 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:41:45,540 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:41:45,566 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:41:45,567 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:41:45,598 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:41:50,627 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:41:50,628 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:41:50,628 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:41:51,140 - root - INFO - validating schema for dataframe....
2024-02-13 09:41:51,140 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:41:51,142 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:41:51,142 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:41:51,142 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:41:51,142 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:41:51,142 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:41:51,142 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:41:51,142 - validate - INFO - print schema done, go forward....
2024-02-13 09:41:51,143 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:41:51,144 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:41:51,144 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:41:51,144 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:41:51,145 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:41:51,146 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:41:51,146 - validate - INFO - print schema done, go forward....
2024-02-13 09:41:51,308 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:41:51,308 - root - INFO - transformation data processing....
2024-02-13 09:41:51,308 - root - INFO - displaying the df_report_1
2024-02-13 09:41:51,308 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:41:51,309 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:41:51,361 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:41:51,424 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:41:51,499 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:41:51,499 - root - INFO - display data_report2 method...
2024-02-13 09:41:51,500 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:41:51,500 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:41:51,625 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:42:05,154 - root - INFO - extracting files output....
2024-02-13 09:42:05,154 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:42:18,408 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:42:37,149 - root - INFO - i am the main method...
2024-02-13 09:42:37,149 - root - INFO - calling spark object
2024-02-13 09:42:37,149 - create_spark - INFO - get_spark_object method started
2024-02-13 09:42:37,149 - create_spark - INFO - master is local
2024-02-13 09:42:43,495 - create_spark - INFO - Spark object create....
2024-02-13 09:42:43,495 - root - INFO - Validating spark object.......
2024-02-13 09:42:43,495 - validate - WARNING - started the get_current_date method...
2024-02-13 09:42:48,463 - validate - WARNING - Validation done, go forward...
2024-02-13 09:42:48,464 - root - INFO - Reading file which is of > parquet
2024-02-13 09:42:48,464 - infest - WARNING - Load_file method started...
2024-02-13 09:42:49,390 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:42:49,395 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:42:52,141 - root - INFO - validating the dataframe...
2024-02-13 09:42:52,141 - infest - WARNING - here to count the records in the df
2024-02-13 09:42:52,850 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:42:52,851 - infest - WARNING - Load_file method started...
2024-02-13 09:42:53,531 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:42:53,535 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:42:53,947 - root - INFO - validating the dataframe...
2024-02-13 09:42:53,947 - infest - WARNING - here to count the records in the df
2024-02-13 09:42:55,163 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:42:55,163 - root - INFO - implementing data processing...
2024-02-13 09:42:55,163 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:42:55,163 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:42:55,217 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:42:55,249 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:42:55,267 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:42:55,323 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:42:55,351 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:42:55,351 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:42:55,381 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:43:00,039 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:43:00,039 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:43:00,039 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:43:00,529 - root - INFO - validating schema for dataframe....
2024-02-13 09:43:00,529 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:43:00,530 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:43:00,531 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:43:00,531 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:43:00,531 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:43:00,531 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:43:00,531 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:43:00,531 - validate - INFO - print schema done, go forward....
2024-02-13 09:43:00,531 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:43:00,533 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:43:00,534 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:43:00,534 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:43:00,534 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:43:00,534 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:43:00,534 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:43:00,534 - validate - INFO - print schema done, go forward....
2024-02-13 09:43:00,712 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:43:00,712 - root - INFO - transformation data processing....
2024-02-13 09:43:00,712 - root - INFO - displaying the df_report_1
2024-02-13 09:43:00,712 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:43:00,714 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:43:00,766 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:43:00,826 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:43:00,900 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:43:00,900 - root - INFO - display data_report2 method...
2024-02-13 09:43:00,900 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:43:00,900 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:43:01,020 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:43:14,565 - root - INFO - extracting files output....
2024-02-13 09:43:14,565 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:43:28,413 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:50:52,777 - root - INFO - i am the main method...
2024-02-13 09:50:52,777 - root - INFO - calling spark object
2024-02-13 09:50:52,777 - create_spark - INFO - get_spark_object method started
2024-02-13 09:50:52,778 - create_spark - INFO - master is local
2024-02-13 09:50:59,165 - create_spark - INFO - Spark object create....
2024-02-13 09:50:59,165 - root - INFO - Validating spark object.......
2024-02-13 09:50:59,165 - validate - WARNING - started the get_current_date method...
2024-02-13 09:51:04,144 - validate - WARNING - Validation done, go forward...
2024-02-13 09:51:04,144 - root - INFO - Reading file which is of > parquet
2024-02-13 09:51:04,144 - infest - WARNING - Load_file method started...
2024-02-13 09:51:05,029 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:51:05,036 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:51:07,748 - root - INFO - validating the dataframe...
2024-02-13 09:51:07,748 - infest - WARNING - here to count the records in the df
2024-02-13 09:51:08,481 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:51:08,482 - infest - WARNING - Load_file method started...
2024-02-13 09:51:09,185 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:51:09,187 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:51:09,558 - root - INFO - validating the dataframe...
2024-02-13 09:51:09,558 - infest - WARNING - here to count the records in the df
2024-02-13 09:51:10,673 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:51:10,673 - root - INFO - implementing data processing...
2024-02-13 09:51:10,673 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:51:10,673 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:51:10,729 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:51:10,758 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:51:10,775 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:51:10,825 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:51:10,852 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:51:10,852 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:51:10,881 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:51:15,737 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:51:15,737 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:51:15,737 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:51:16,206 - root - INFO - validating schema for dataframe....
2024-02-13 09:51:16,206 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:51:16,208 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:51:16,208 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:51:16,208 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:51:16,208 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:51:16,208 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:51:16,208 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:51:16,208 - validate - INFO - print schema done, go forward....
2024-02-13 09:51:16,208 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:51:16,210 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:51:16,210 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:51:16,210 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:51:16,210 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:51:16,211 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:51:16,211 - validate - INFO - print schema done, go forward....
2024-02-13 09:51:16,393 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:51:16,393 - root - INFO - transformation data processing....
2024-02-13 09:51:16,393 - root - INFO - displaying the df_report_1
2024-02-13 09:51:16,393 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:51:16,395 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:51:16,446 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:51:16,511 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:51:16,577 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:51:16,577 - root - INFO - display data_report2 method...
2024-02-13 09:51:16,577 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:51:16,577 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:51:16,707 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:51:30,586 - root - INFO - extracting files output....
2024-02-13 09:51:30,586 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:51:44,091 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:51:44,092 - root - INFO - total amount of time taken: 51.314099800016265 seconds...
2024-02-13 09:51:44,092 - root - INFO - Application done
2024-02-13 09:52:25,245 - root - INFO - i am the main method...
2024-02-13 09:52:25,247 - root - INFO - calling spark object
2024-02-13 09:52:25,247 - create_spark - INFO - get_spark_object method started
2024-02-13 09:52:25,247 - create_spark - INFO - master is local
2024-02-13 09:52:31,398 - create_spark - INFO - Spark object create....
2024-02-13 09:52:31,398 - root - INFO - Validating spark object.......
2024-02-13 09:52:31,398 - validate - WARNING - started the get_current_date method...
2024-02-13 09:52:36,186 - validate - WARNING - Validation done, go forward...
2024-02-13 09:52:36,187 - root - INFO - Reading file which is of > parquet
2024-02-13 09:52:36,187 - infest - WARNING - Load_file method started...
2024-02-13 09:52:37,134 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:52:37,139 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:52:39,895 - root - INFO - validating the dataframe...
2024-02-13 09:52:39,895 - infest - WARNING - here to count the records in the df
2024-02-13 09:52:40,596 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:52:40,597 - infest - WARNING - Load_file method started...
2024-02-13 09:52:41,285 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:52:41,288 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:52:41,665 - root - INFO - validating the dataframe...
2024-02-13 09:52:41,665 - infest - WARNING - here to count the records in the df
2024-02-13 09:52:42,886 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:52:42,887 - root - INFO - implementing data processing...
2024-02-13 09:52:42,887 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:52:42,887 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:52:42,934 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:52:42,963 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:52:42,978 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:52:43,032 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:52:43,057 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:52:43,057 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:52:43,082 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:52:47,936 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:52:47,936 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:52:47,936 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:52:48,421 - root - INFO - validating schema for dataframe....
2024-02-13 09:52:48,421 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:52:48,423 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:52:48,423 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:52:48,423 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:52:48,423 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:52:48,423 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:52:48,424 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:52:48,424 - validate - INFO - print schema done, go forward....
2024-02-13 09:52:48,424 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:52:48,425 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:52:48,426 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:52:48,427 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:52:48,427 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:52:48,427 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:52:48,427 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:52:48,427 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:52:48,427 - validate - INFO - print schema done, go forward....
2024-02-13 09:52:48,588 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:52:48,588 - root - INFO - transformation data processing....
2024-02-13 09:52:48,588 - root - INFO - displaying the df_report_1
2024-02-13 09:52:48,588 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:52:48,590 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:52:48,633 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:52:48,695 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:52:48,780 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:52:48,780 - root - INFO - display data_report2 method...
2024-02-13 09:52:48,780 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:52:48,780 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:52:48,918 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:53:02,741 - root - INFO - extracting files output....
2024-02-13 09:53:02,741 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:53:15,939 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:53:15,939 - root - INFO - total amount of time taken: 50.693323499988765 seconds...
2024-02-13 09:53:15,939 - root - INFO - Application done
2024-02-13 09:54:07,746 - root - INFO - i am the main method...
2024-02-13 09:54:07,746 - root - INFO - calling spark object
2024-02-13 09:54:07,746 - create_spark - INFO - get_spark_object method started
2024-02-13 09:54:07,747 - create_spark - INFO - master is local
2024-02-13 09:54:14,036 - create_spark - INFO - Spark object create....
2024-02-13 09:54:14,037 - root - INFO - Validating spark object.......
2024-02-13 09:54:14,037 - validate - WARNING - started the get_current_date method...
2024-02-13 09:54:18,737 - validate - WARNING - Validation done, go forward...
2024-02-13 09:54:18,737 - root - INFO - Reading file which is of > parquet
2024-02-13 09:54:18,738 - infest - WARNING - Load_file method started...
2024-02-13 09:54:19,674 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:54:19,680 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:54:22,605 - root - INFO - validating the dataframe...
2024-02-13 09:54:22,605 - infest - WARNING - here to count the records in the df
2024-02-13 09:54:23,375 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:54:23,375 - infest - WARNING - Load_file method started...
2024-02-13 09:54:24,107 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:54:24,110 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:54:24,479 - root - INFO - validating the dataframe...
2024-02-13 09:54:24,479 - infest - WARNING - here to count the records in the df
2024-02-13 09:54:25,608 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:54:25,608 - root - INFO - implementing data processing...
2024-02-13 09:54:25,608 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:54:25,609 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:54:25,660 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:54:25,691 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:54:25,708 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:54:25,758 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:54:25,783 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:54:25,783 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:54:25,815 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:54:30,641 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:54:30,641 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:54:30,642 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:54:31,128 - root - INFO - validating schema for dataframe....
2024-02-13 09:54:31,128 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:54:31,130 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:54:31,130 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:54:31,130 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:54:31,130 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:54:31,130 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:54:31,130 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:54:31,131 - validate - INFO - print schema done, go forward....
2024-02-13 09:54:31,131 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:54:31,133 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:54:31,133 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:54:31,133 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:54:31,133 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:54:31,133 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:54:31,133 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:54:31,134 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:54:31,134 - validate - INFO - print schema done, go forward....
2024-02-13 09:54:31,307 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:54:31,307 - root - INFO - transformation data processing....
2024-02-13 09:54:31,307 - root - INFO - displaying the df_report_1
2024-02-13 09:54:31,307 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:54:31,308 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:54:31,354 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:54:31,419 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:54:31,502 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:54:31,502 - root - INFO - display data_report2 method...
2024-02-13 09:54:31,502 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:54:31,502 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:54:31,644 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:54:45,356 - root - INFO - extracting files output....
2024-02-13 09:54:45,356 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:54:58,680 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:54:58,680 - root - INFO - total amount of time taken: 50.93516200000886 seconds...
2024-02-13 09:54:58,681 - root - INFO - Application done
2024-02-13 09:55:58,863 - root - INFO - i am the main method...
2024-02-13 09:55:58,864 - root - INFO - calling spark object
2024-02-13 09:55:58,864 - create_spark - INFO - get_spark_object method started
2024-02-13 09:55:58,864 - create_spark - INFO - master is local
2024-02-13 09:56:05,371 - create_spark - INFO - Spark object create....
2024-02-13 09:56:05,372 - root - INFO - Validating spark object.......
2024-02-13 09:56:05,372 - validate - WARNING - started the get_current_date method...
2024-02-13 09:56:10,163 - validate - WARNING - Validation done, go forward...
2024-02-13 09:56:10,163 - root - INFO - Reading file which is of > parquet
2024-02-13 09:56:10,163 - infest - WARNING - Load_file method started...
2024-02-13 09:56:11,029 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:56:11,035 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:56:13,693 - root - INFO - validating the dataframe...
2024-02-13 09:56:13,693 - infest - WARNING - here to count the records in the df
2024-02-13 09:56:14,423 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:56:14,423 - infest - WARNING - Load_file method started...
2024-02-13 09:56:15,093 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:56:15,096 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:56:15,468 - root - INFO - validating the dataframe...
2024-02-13 09:56:15,468 - infest - WARNING - here to count the records in the df
2024-02-13 09:56:16,598 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:56:16,599 - root - INFO - implementing data processing...
2024-02-13 09:56:16,599 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:56:16,599 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:56:16,651 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:56:16,683 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:56:16,702 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:56:16,759 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:56:16,786 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:56:16,786 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:56:16,821 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:56:21,393 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:56:21,393 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:56:21,393 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:56:21,844 - root - INFO - validating schema for dataframe....
2024-02-13 09:56:21,844 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:56:21,846 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:56:21,846 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:56:21,846 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:56:21,846 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:56:21,847 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:56:21,847 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:56:21,847 - validate - INFO - print schema done, go forward....
2024-02-13 09:56:21,847 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:56:21,849 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:56:21,849 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:56:21,849 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:56:21,849 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:56:21,849 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:56:21,849 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:56:21,850 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:56:21,850 - validate - INFO - print schema done, go forward....
2024-02-13 09:56:22,031 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:56:22,031 - root - INFO - transformation data processing....
2024-02-13 09:56:22,031 - root - INFO - displaying the df_report_1
2024-02-13 09:56:22,031 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:56:22,033 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:56:22,086 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:56:22,157 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:56:22,233 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:56:22,233 - root - INFO - display data_report2 method...
2024-02-13 09:56:22,233 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:56:22,233 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:56:22,359 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:56:35,713 - root - INFO - extracting files output....
2024-02-13 09:56:35,713 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:56:48,796 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:56:48,796 - root - INFO - total amount of time taken: 49.93238929999643 seconds...
2024-02-13 09:56:48,796 - root - INFO - Application done
2024-02-13 09:57:21,134 - root - INFO - i am the main method...
2024-02-13 09:57:21,134 - root - INFO - calling spark object
2024-02-13 09:57:21,134 - create_spark - INFO - get_spark_object method started
2024-02-13 09:57:21,134 - create_spark - INFO - master is local
2024-02-13 09:57:27,434 - create_spark - INFO - Spark object create....
2024-02-13 09:57:27,434 - root - INFO - Validating spark object.......
2024-02-13 09:57:27,434 - validate - WARNING - started the get_current_date method...
2024-02-13 09:57:32,294 - validate - WARNING - Validation done, go forward...
2024-02-13 09:57:32,295 - root - INFO - Reading file which is of > parquet
2024-02-13 09:57:32,295 - infest - WARNING - Load_file method started...
2024-02-13 09:57:33,212 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 09:57:33,218 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 09:57:35,979 - root - INFO - validating the dataframe...
2024-02-13 09:57:35,979 - infest - WARNING - here to count the records in the df
2024-02-13 09:57:36,690 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 09:57:36,691 - infest - WARNING - Load_file method started...
2024-02-13 09:57:37,360 - infest - WARNING - dataframe created  which is if csv
2024-02-13 09:57:37,364 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 09:57:37,725 - root - INFO - validating the dataframe...
2024-02-13 09:57:37,725 - infest - WARNING - here to count the records in the df
2024-02-13 09:57:38,920 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 09:57:38,920 - root - INFO - implementing data processing...
2024-02-13 09:57:38,921 - data_processing - WARNING - data_clean method() stating....
2024-02-13 09:57:38,921 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 09:57:38,972 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 09:57:39,005 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 09:57:39,020 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 09:57:39,075 - data_processing - WARNING - concat firstName and lastName
2024-02-13 09:57:39,106 - data_processing - WARNING - now check for null values in all column
2024-02-13 09:57:39,106 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 09:57:39,142 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 09:57:43,896 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 09:57:43,896 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 09:57:43,897 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 09:57:44,373 - root - INFO - validating schema for dataframe....
2024-02-13 09:57:44,373 - validate - WARNING - printing schema method starting... df_city
2024-02-13 09:57:44,375 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 09:57:44,375 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 09:57:44,375 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 09:57:44,375 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 09:57:44,375 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 09:57:44,375 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 09:57:44,375 - validate - INFO - print schema done, go forward....
2024-02-13 09:57:44,375 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 09:57:44,377 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 09:57:44,377 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 09:57:44,378 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 09:57:44,379 - validate - INFO - print schema done, go forward....
2024-02-13 09:57:44,565 - root - INFO - checking null values schema for dataframe....
2024-02-13 09:57:44,565 - root - INFO - transformation data processing....
2024-02-13 09:57:44,565 - root - INFO - displaying the df_report_1
2024-02-13 09:57:44,565 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 09:57:44,566 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 09:57:44,623 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 09:57:44,687 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 09:57:44,764 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 09:57:44,764 - root - INFO - display data_report2 method...
2024-02-13 09:57:44,764 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 09:57:44,764 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 09:57:44,910 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 09:57:58,103 - root - INFO - extracting files output....
2024-02-13 09:57:58,103 - extraction - WARNING - extracting_file method starting....
2024-02-13 09:58:11,173 - extraction - WARNING - extract_file method successfully...
2024-02-13 09:58:11,174 - root - INFO - total amount of time taken: 50.04075440001907 seconds...
2024-02-13 09:58:11,174 - root - INFO - Application done
2024-02-13 10:43:36,411 - root - INFO - i am the main method...
2024-02-13 10:43:36,411 - root - INFO - calling spark object
2024-02-13 10:43:36,411 - create_spark - INFO - get_spark_object method started
2024-02-13 10:43:36,411 - create_spark - INFO - master is local
2024-02-13 10:43:41,400 - create_spark - INFO - Spark object create....
2024-02-13 10:43:41,400 - root - INFO - Validating spark object.......
2024-02-13 10:43:41,400 - validate - WARNING - started the get_current_date method...
2024-02-13 10:43:44,338 - validate - WARNING - Validation done, go forward...
2024-02-13 10:43:44,338 - root - INFO - Reading file which is of > parquet
2024-02-13 10:43:44,338 - infest - WARNING - Load_file method started...
2024-02-13 10:43:44,783 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:43:44,786 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:43:46,209 - root - INFO - validating the dataframe...
2024-02-13 10:43:46,209 - infest - WARNING - here to count the records in the df
2024-02-13 10:43:46,604 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:43:46,604 - infest - WARNING - Load_file method started...
2024-02-13 10:43:46,996 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:43:46,998 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:43:47,211 - root - INFO - validating the dataframe...
2024-02-13 10:43:47,211 - infest - WARNING - here to count the records in the df
2024-02-13 10:43:47,817 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:43:47,818 - root - INFO - implementing data processing...
2024-02-13 10:43:47,818 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:43:47,818 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:43:47,846 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:43:47,860 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:43:47,870 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:43:47,900 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:43:47,916 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:43:47,916 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:43:47,933 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:43:50,295 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:43:50,295 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:43:50,295 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:43:50,626 - root - INFO - validating schema for dataframe....
2024-02-13 10:43:50,626 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:43:50,628 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:43:50,628 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:43:50,628 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:43:50,628 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:43:50,628 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:43:50,628 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:43:50,628 - validate - INFO - print schema done, go forward....
2024-02-13 10:43:50,628 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:43:50,629 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:43:50,629 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:43:50,629 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:43:50,629 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:43:50,629 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:43:50,630 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:43:50,630 - validate - INFO - print schema done, go forward....
2024-02-13 10:43:50,754 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:43:50,754 - root - INFO - transformation data processing....
2024-02-13 10:43:50,754 - root - INFO - displaying the df_report_1
2024-02-13 10:43:50,755 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:43:50,756 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:43:50,795 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:43:50,848 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:43:50,928 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:43:50,928 - root - INFO - display data_report2 method...
2024-02-13 10:43:50,928 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:43:50,928 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:43:51,040 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:43:58,101 - root - INFO - extracting files output....
2024-02-13 10:43:58,102 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:44:24,726 - root - INFO - i am the main method...
2024-02-13 10:44:24,726 - root - INFO - calling spark object
2024-02-13 10:44:24,726 - create_spark - INFO - get_spark_object method started
2024-02-13 10:44:24,726 - create_spark - INFO - master is local
2024-02-13 10:44:28,203 - create_spark - INFO - Spark object create....
2024-02-13 10:44:28,203 - root - INFO - Validating spark object.......
2024-02-13 10:44:28,203 - validate - WARNING - started the get_current_date method...
2024-02-13 10:44:31,111 - validate - WARNING - Validation done, go forward...
2024-02-13 10:44:31,112 - root - INFO - Reading file which is of > parquet
2024-02-13 10:44:31,112 - infest - WARNING - Load_file method started...
2024-02-13 10:44:31,605 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:44:31,608 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:44:32,938 - root - INFO - validating the dataframe...
2024-02-13 10:44:32,938 - infest - WARNING - here to count the records in the df
2024-02-13 10:44:33,299 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:44:33,299 - infest - WARNING - Load_file method started...
2024-02-13 10:44:33,678 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:44:33,679 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:44:33,883 - root - INFO - validating the dataframe...
2024-02-13 10:44:33,883 - infest - WARNING - here to count the records in the df
2024-02-13 10:44:34,431 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:44:34,431 - root - INFO - implementing data processing...
2024-02-13 10:44:34,431 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:44:34,432 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:44:34,460 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:44:34,475 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:44:34,484 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:44:34,515 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:44:34,529 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:44:34,529 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:44:34,548 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:44:36,875 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:44:36,875 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:44:36,875 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:44:37,166 - root - INFO - validating schema for dataframe....
2024-02-13 10:44:37,166 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:44:37,167 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:44:37,167 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:44:37,167 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:44:37,167 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:44:37,167 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:44:37,167 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:44:37,167 - validate - INFO - print schema done, go forward....
2024-02-13 10:44:37,167 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:44:37,168 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:44:37,168 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:44:37,168 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:44:37,168 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:44:37,169 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:44:37,169 - validate - INFO - print schema done, go forward....
2024-02-13 10:44:37,286 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:44:37,286 - root - INFO - transformation data processing....
2024-02-13 10:44:37,286 - root - INFO - displaying the df_report_1
2024-02-13 10:44:37,286 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:44:37,287 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:44:37,318 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:44:37,352 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:44:37,403 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:44:37,403 - root - INFO - display data_report2 method...
2024-02-13 10:44:37,403 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:44:37,403 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:44:37,498 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:44:44,178 - root - INFO - extracting files output....
2024-02-13 10:44:44,178 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:44:50,987 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:44:50,987 - root - INFO - total amount of time taken: 26.262074800004484 seconds...
2024-02-13 10:44:50,987 - root - INFO - Application done
2024-02-13 10:45:24,969 - root - INFO - i am the main method...
2024-02-13 10:45:24,969 - root - INFO - calling spark object
2024-02-13 10:45:24,969 - create_spark - INFO - get_spark_object method started
2024-02-13 10:45:24,969 - create_spark - INFO - master is local
2024-02-13 10:45:28,093 - create_spark - INFO - Spark object create....
2024-02-13 10:45:28,093 - root - INFO - Validating spark object.......
2024-02-13 10:45:28,094 - validate - WARNING - started the get_current_date method...
2024-02-13 10:45:30,973 - validate - WARNING - Validation done, go forward...
2024-02-13 10:45:30,973 - root - INFO - Reading file which is of > parquet
2024-02-13 10:45:30,973 - infest - WARNING - Load_file method started...
2024-02-13 10:45:31,495 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:45:31,499 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:45:33,032 - root - INFO - validating the dataframe...
2024-02-13 10:45:33,032 - infest - WARNING - here to count the records in the df
2024-02-13 10:45:33,412 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:45:33,412 - infest - WARNING - Load_file method started...
2024-02-13 10:45:33,792 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:45:33,793 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:45:34,000 - root - INFO - validating the dataframe...
2024-02-13 10:45:34,000 - infest - WARNING - here to count the records in the df
2024-02-13 10:45:34,558 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:45:34,558 - root - INFO - implementing data processing...
2024-02-13 10:45:34,558 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:45:34,559 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:45:34,587 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:45:34,602 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:45:34,612 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:45:34,640 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:45:34,654 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:45:34,654 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:45:34,672 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:45:36,864 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:45:36,865 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:45:36,865 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:45:37,108 - root - INFO - validating schema for dataframe....
2024-02-13 10:45:37,108 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:45:37,109 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:45:37,109 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:45:37,109 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:45:37,110 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:45:37,110 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:45:37,110 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:45:37,110 - validate - INFO - print schema done, go forward....
2024-02-13 10:45:37,110 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:45:37,112 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:45:37,113 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:45:37,113 - validate - INFO - print schema done, go forward....
2024-02-13 10:45:37,224 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:45:37,224 - root - INFO - transformation data processing....
2024-02-13 10:45:37,224 - root - INFO - displaying the df_report_1
2024-02-13 10:45:37,224 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:45:37,225 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:45:37,254 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:45:37,292 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:45:37,343 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:45:37,343 - root - INFO - display data_report2 method...
2024-02-13 10:45:37,343 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:45:37,343 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:45:37,427 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:45:44,202 - root - INFO - extracting files output....
2024-02-13 10:45:44,203 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:45:51,094 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:45:51,094 - root - INFO - total amount of time taken: 26.126341199997114 seconds...
2024-02-13 10:45:51,095 - root - INFO - Application done
2024-02-13 10:46:19,843 - root - INFO - i am the main method...
2024-02-13 10:46:19,844 - root - INFO - calling spark object
2024-02-13 10:46:19,844 - create_spark - INFO - get_spark_object method started
2024-02-13 10:46:19,844 - create_spark - INFO - master is local
2024-02-13 10:46:23,359 - create_spark - INFO - Spark object create....
2024-02-13 10:46:23,359 - root - INFO - Validating spark object.......
2024-02-13 10:46:23,359 - validate - WARNING - started the get_current_date method...
2024-02-13 10:46:25,835 - validate - WARNING - Validation done, go forward...
2024-02-13 10:46:25,835 - root - INFO - Reading file which is of > parquet
2024-02-13 10:46:25,835 - infest - WARNING - Load_file method started...
2024-02-13 10:46:26,311 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:46:26,315 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:46:27,622 - root - INFO - validating the dataframe...
2024-02-13 10:46:27,622 - infest - WARNING - here to count the records in the df
2024-02-13 10:46:27,989 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:46:27,989 - infest - WARNING - Load_file method started...
2024-02-13 10:46:28,370 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:46:28,372 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:46:28,566 - root - INFO - validating the dataframe...
2024-02-13 10:46:28,566 - infest - WARNING - here to count the records in the df
2024-02-13 10:46:29,160 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:46:29,160 - root - INFO - implementing data processing...
2024-02-13 10:46:29,160 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:46:29,160 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:46:29,195 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:46:29,210 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:46:29,221 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:46:29,251 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:46:29,266 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:46:29,266 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:46:29,284 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:46:31,547 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:46:31,547 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:46:31,547 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:46:31,846 - root - INFO - validating schema for dataframe....
2024-02-13 10:46:31,846 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:46:31,847 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:46:31,847 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:46:31,847 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:46:31,847 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:46:31,847 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:46:31,848 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:46:31,848 - validate - INFO - print schema done, go forward....
2024-02-13 10:46:31,848 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:46:31,849 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:46:31,849 - validate - INFO - print schema done, go forward....
2024-02-13 10:46:32,010 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:46:32,010 - root - INFO - transformation data processing....
2024-02-13 10:46:32,010 - root - INFO - displaying the df_report_1
2024-02-13 10:46:32,010 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:46:32,011 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:46:32,040 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:46:32,082 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:46:32,135 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:46:32,135 - root - INFO - display data_report2 method...
2024-02-13 10:46:32,135 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:46:32,135 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:46:32,233 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:46:38,405 - root - INFO - extracting files output....
2024-02-13 10:46:38,405 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:47:22,006 - root - INFO - i am the main method...
2024-02-13 10:47:22,006 - root - INFO - calling spark object
2024-02-13 10:47:22,006 - create_spark - INFO - get_spark_object method started
2024-02-13 10:47:22,006 - create_spark - INFO - master is local
2024-02-13 10:47:25,455 - create_spark - INFO - Spark object create....
2024-02-13 10:47:25,456 - root - INFO - Validating spark object.......
2024-02-13 10:47:25,456 - validate - WARNING - started the get_current_date method...
2024-02-13 10:47:27,968 - validate - WARNING - Validation done, go forward...
2024-02-13 10:47:27,968 - root - INFO - Reading file which is of > parquet
2024-02-13 10:47:27,968 - infest - WARNING - Load_file method started...
2024-02-13 10:47:28,395 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:47:28,398 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:47:29,753 - root - INFO - validating the dataframe...
2024-02-13 10:47:29,753 - infest - WARNING - here to count the records in the df
2024-02-13 10:47:30,171 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:47:30,172 - infest - WARNING - Load_file method started...
2024-02-13 10:47:30,614 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:47:30,616 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:47:30,823 - root - INFO - validating the dataframe...
2024-02-13 10:47:30,823 - infest - WARNING - here to count the records in the df
2024-02-13 10:47:31,414 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:47:31,415 - root - INFO - implementing data processing...
2024-02-13 10:47:31,415 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:47:31,415 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:47:31,447 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:47:31,465 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:47:31,476 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:47:31,512 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:47:31,529 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:47:31,529 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:47:31,551 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:47:33,842 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:47:33,842 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:47:33,842 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:47:34,127 - root - INFO - validating schema for dataframe....
2024-02-13 10:47:34,127 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:47:34,128 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:47:34,129 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:47:34,129 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:47:34,129 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:47:34,129 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:47:34,129 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:47:34,129 - validate - INFO - print schema done, go forward....
2024-02-13 10:47:34,129 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:47:34,130 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:47:34,130 - validate - INFO - print schema done, go forward....
2024-02-13 10:47:34,252 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:47:34,252 - root - INFO - transformation data processing....
2024-02-13 10:47:34,252 - root - INFO - displaying the df_report_1
2024-02-13 10:47:34,252 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:47:34,253 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:47:34,290 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:47:34,328 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:47:34,387 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:47:34,388 - root - INFO - display data_report2 method...
2024-02-13 10:47:34,388 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:47:34,388 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:47:34,490 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:47:41,000 - root - INFO - extracting files output....
2024-02-13 10:47:41,000 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:47:47,495 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:47:47,495 - root - INFO - total amount of time taken: 25.489626800001133 seconds...
2024-02-13 10:47:47,495 - root - INFO - Application done
2024-02-13 10:55:04,251 - root - INFO - i am the main method...
2024-02-13 10:55:04,251 - root - INFO - calling spark object
2024-02-13 10:55:04,251 - create_spark - INFO - get_spark_object method started
2024-02-13 10:55:04,251 - create_spark - INFO - master is local
2024-02-13 10:55:07,355 - create_spark - INFO - Spark object create....
2024-02-13 10:55:07,355 - root - INFO - Validating spark object.......
2024-02-13 10:55:07,355 - validate - WARNING - started the get_current_date method...
2024-02-13 10:55:09,895 - validate - WARNING - Validation done, go forward...
2024-02-13 10:55:09,895 - root - INFO - Reading file which is of > parquet
2024-02-13 10:55:09,895 - infest - WARNING - Load_file method started...
2024-02-13 10:55:10,338 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:55:10,341 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:55:11,650 - root - INFO - validating the dataframe...
2024-02-13 10:55:11,650 - infest - WARNING - here to count the records in the df
2024-02-13 10:55:12,015 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:55:12,015 - infest - WARNING - Load_file method started...
2024-02-13 10:55:12,381 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:55:12,383 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:55:12,591 - root - INFO - validating the dataframe...
2024-02-13 10:55:12,591 - infest - WARNING - here to count the records in the df
2024-02-13 10:55:13,151 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:55:13,151 - root - INFO - implementing data processing...
2024-02-13 10:55:13,152 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:55:13,152 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:55:13,179 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:55:13,194 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:55:13,204 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:55:13,233 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:55:13,248 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:55:13,248 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:55:13,268 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:55:15,526 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:55:15,526 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:55:15,526 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:55:15,770 - root - INFO - validating schema for dataframe....
2024-02-13 10:55:15,770 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:55:15,771 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:55:15,771 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:55:15,771 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:55:15,771 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:55:15,772 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:55:15,772 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:55:15,772 - validate - INFO - print schema done, go forward....
2024-02-13 10:55:15,772 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:55:15,772 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:55:15,773 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:55:15,773 - validate - INFO - print schema done, go forward....
2024-02-13 10:55:15,873 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:55:15,873 - root - INFO - transformation data processing....
2024-02-13 10:55:15,873 - root - INFO - displaying the df_report_1
2024-02-13 10:55:15,873 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:55:15,874 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:55:15,904 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:55:15,938 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:55:15,978 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:55:15,978 - root - INFO - display data_report2 method...
2024-02-13 10:55:15,978 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:55:15,978 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:55:16,052 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:55:22,981 - root - INFO - extracting files output....
2024-02-13 10:55:22,981 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:55:29,615 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:55:29,683 - root - INFO - total amount of time taken: 25.432069500006037 seconds...
2024-02-13 10:55:29,684 - root - INFO - Application done
2024-02-13 10:57:00,153 - root - INFO - i am the main method...
2024-02-13 10:57:00,153 - root - INFO - calling spark object
2024-02-13 10:57:00,153 - create_spark - INFO - get_spark_object method started
2024-02-13 10:57:00,153 - create_spark - INFO - master is local
2024-02-13 10:57:03,321 - create_spark - INFO - Spark object create....
2024-02-13 10:57:03,321 - root - INFO - Validating spark object.......
2024-02-13 10:57:03,321 - validate - WARNING - started the get_current_date method...
2024-02-13 10:57:05,736 - validate - WARNING - Validation done, go forward...
2024-02-13 10:57:05,737 - root - INFO - Reading file which is of > parquet
2024-02-13 10:57:05,737 - infest - WARNING - Load_file method started...
2024-02-13 10:57:06,184 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:57:06,187 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:57:07,505 - root - INFO - validating the dataframe...
2024-02-13 10:57:07,505 - infest - WARNING - here to count the records in the df
2024-02-13 10:57:07,862 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:57:07,862 - infest - WARNING - Load_file method started...
2024-02-13 10:57:08,233 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:57:08,235 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:57:08,444 - root - INFO - validating the dataframe...
2024-02-13 10:57:08,444 - infest - WARNING - here to count the records in the df
2024-02-13 10:57:09,031 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:57:09,032 - root - INFO - implementing data processing...
2024-02-13 10:57:09,032 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:57:09,032 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:57:09,059 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:57:09,073 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:57:09,082 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:57:09,110 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:57:09,123 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:57:09,123 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:57:09,138 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:57:11,377 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:57:11,377 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:57:11,377 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:57:11,618 - root - INFO - validating schema for dataframe....
2024-02-13 10:57:11,618 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:57:11,619 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:57:11,619 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:57:11,619 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:57:11,619 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:57:11,619 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:57:11,619 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:57:11,619 - validate - INFO - print schema done, go forward....
2024-02-13 10:57:11,619 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:57:11,620 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:57:11,621 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:57:11,621 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:57:11,621 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:57:11,621 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:57:11,621 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:57:11,621 - validate - INFO - print schema done, go forward....
2024-02-13 10:57:11,733 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:57:11,733 - root - INFO - transformation data processing....
2024-02-13 10:57:11,733 - root - INFO - displaying the df_report_1
2024-02-13 10:57:11,733 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:57:11,734 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:57:11,763 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:57:11,795 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:57:11,836 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:57:11,836 - root - INFO - display data_report2 method...
2024-02-13 10:57:11,836 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:57:11,836 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:57:11,913 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:57:18,407 - root - INFO - extracting files output....
2024-02-13 10:57:18,407 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:57:24,881 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:57:24,952 - root - INFO - total amount of time taken: 24.799482800008263 seconds...
2024-02-13 10:57:24,952 - root - INFO - Application done
2024-02-13 10:57:46,475 - root - INFO - i am the main method...
2024-02-13 10:57:46,475 - root - INFO - calling spark object
2024-02-13 10:57:46,475 - create_spark - INFO - get_spark_object method started
2024-02-13 10:57:46,475 - create_spark - INFO - master is local
2024-02-13 10:57:49,438 - create_spark - INFO - Spark object create....
2024-02-13 10:57:49,439 - root - INFO - Validating spark object.......
2024-02-13 10:57:49,439 - validate - WARNING - started the get_current_date method...
2024-02-13 10:57:51,795 - validate - WARNING - Validation done, go forward...
2024-02-13 10:57:51,795 - root - INFO - Reading file which is of > parquet
2024-02-13 10:57:51,795 - infest - WARNING - Load_file method started...
2024-02-13 10:57:52,212 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:57:52,215 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:57:53,483 - root - INFO - validating the dataframe...
2024-02-13 10:57:53,483 - infest - WARNING - here to count the records in the df
2024-02-13 10:57:53,853 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:57:53,853 - infest - WARNING - Load_file method started...
2024-02-13 10:57:54,212 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:57:54,213 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:57:54,427 - root - INFO - validating the dataframe...
2024-02-13 10:57:54,427 - infest - WARNING - here to count the records in the df
2024-02-13 10:57:54,990 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:57:54,990 - root - INFO - implementing data processing...
2024-02-13 10:57:54,990 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:57:54,990 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:57:55,019 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:57:55,035 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:57:55,046 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:57:55,075 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:57:55,088 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:57:55,088 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:57:55,104 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:57:57,254 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:57:57,254 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:57:57,254 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:57:57,530 - root - INFO - validating schema for dataframe....
2024-02-13 10:57:57,530 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:57:57,531 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:57:57,531 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:57:57,531 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:57:57,531 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:57:57,532 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:57:57,532 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:57:57,532 - validate - INFO - print schema done, go forward....
2024-02-13 10:57:57,532 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:57:57,533 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:57:57,533 - validate - INFO - print schema done, go forward....
2024-02-13 10:57:57,646 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:57:57,646 - root - INFO - transformation data processing....
2024-02-13 10:57:57,646 - root - INFO - displaying the df_report_1
2024-02-13 10:57:57,646 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:57:57,647 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:57:57,675 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:57:57,702 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:57:57,746 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:57:57,746 - root - INFO - display data_report2 method...
2024-02-13 10:57:57,746 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:57:57,746 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:57:57,827 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:58:04,437 - root - INFO - extracting files output....
2024-02-13 10:58:04,437 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:58:11,297 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:58:11,882 - root - INFO - total amount of time taken: 25.407674199988833 seconds...
2024-02-13 10:58:11,883 - root - INFO - Application done
2024-02-13 10:58:34,096 - root - INFO - i am the main method...
2024-02-13 10:58:34,096 - root - INFO - calling spark object
2024-02-13 10:58:34,096 - create_spark - INFO - get_spark_object method started
2024-02-13 10:58:34,096 - create_spark - INFO - master is local
2024-02-13 10:58:37,050 - create_spark - INFO - Spark object create....
2024-02-13 10:58:37,050 - root - INFO - Validating spark object.......
2024-02-13 10:58:37,050 - validate - WARNING - started the get_current_date method...
2024-02-13 10:58:39,363 - validate - WARNING - Validation done, go forward...
2024-02-13 10:58:39,363 - root - INFO - Reading file which is of > parquet
2024-02-13 10:58:39,363 - infest - WARNING - Load_file method started...
2024-02-13 10:58:39,772 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:58:39,775 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 10:58:41,031 - root - INFO - validating the dataframe...
2024-02-13 10:58:41,031 - infest - WARNING - here to count the records in the df
2024-02-13 10:58:41,419 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 10:58:41,419 - infest - WARNING - Load_file method started...
2024-02-13 10:58:41,774 - infest - WARNING - dataframe created  which is if csv
2024-02-13 10:58:41,775 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 10:58:41,952 - root - INFO - validating the dataframe...
2024-02-13 10:58:41,952 - infest - WARNING - here to count the records in the df
2024-02-13 10:58:42,531 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 10:58:42,531 - root - INFO - implementing data processing...
2024-02-13 10:58:42,531 - data_processing - WARNING - data_clean method() stating....
2024-02-13 10:58:42,531 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 10:58:42,553 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 10:58:42,566 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 10:58:42,573 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 10:58:42,596 - data_processing - WARNING - concat firstName and lastName
2024-02-13 10:58:42,607 - data_processing - WARNING - now check for null values in all column
2024-02-13 10:58:42,608 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 10:58:42,621 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 10:58:44,720 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 10:58:44,720 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 10:58:44,720 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 10:58:44,961 - root - INFO - validating schema for dataframe....
2024-02-13 10:58:44,961 - validate - WARNING - printing schema method starting... df_city
2024-02-13 10:58:44,962 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 10:58:44,962 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 10:58:44,962 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 10:58:44,962 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 10:58:44,962 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 10:58:44,962 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 10:58:44,963 - validate - INFO - print schema done, go forward....
2024-02-13 10:58:44,963 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 10:58:44,964 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 10:58:44,964 - validate - INFO - print schema done, go forward....
2024-02-13 10:58:45,068 - root - INFO - checking null values schema for dataframe....
2024-02-13 10:58:45,068 - root - INFO - transformation data processing....
2024-02-13 10:58:45,068 - root - INFO - displaying the df_report_1
2024-02-13 10:58:45,068 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 10:58:45,069 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 10:58:45,097 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 10:58:45,129 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 10:58:45,173 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 10:58:45,173 - root - INFO - display data_report2 method...
2024-02-13 10:58:45,173 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 10:58:45,173 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 10:58:45,252 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 10:58:51,489 - root - INFO - extracting files output....
2024-02-13 10:58:51,489 - extraction - WARNING - extracting_file method starting....
2024-02-13 10:58:58,472 - extraction - WARNING - extract_file method successfully...
2024-02-13 10:58:59,107 - root - INFO - total amount of time taken: 25.010312900005374 seconds...
2024-02-13 10:58:59,107 - root - INFO - Application done
2024-02-13 10:59:53,465 - root - INFO - i am the main method...
2024-02-13 10:59:53,465 - root - INFO - calling spark object
2024-02-13 10:59:53,465 - create_spark - INFO - get_spark_object method started
2024-02-13 10:59:53,465 - create_spark - INFO - master is local
2024-02-13 10:59:56,388 - create_spark - INFO - Spark object create....
2024-02-13 10:59:56,388 - root - INFO - Validating spark object.......
2024-02-13 10:59:56,388 - validate - WARNING - started the get_current_date method...
2024-02-13 10:59:58,832 - validate - WARNING - Validation done, go forward...
2024-02-13 10:59:58,832 - root - INFO - Reading file which is of > parquet
2024-02-13 10:59:58,832 - infest - WARNING - Load_file method started...
2024-02-13 10:59:59,264 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 10:59:59,267 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:00:00,492 - root - INFO - validating the dataframe...
2024-02-13 11:00:00,492 - infest - WARNING - here to count the records in the df
2024-02-13 11:00:00,842 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:00:00,842 - infest - WARNING - Load_file method started...
2024-02-13 11:00:01,170 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:00:01,171 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:00:01,358 - root - INFO - validating the dataframe...
2024-02-13 11:00:01,358 - infest - WARNING - here to count the records in the df
2024-02-13 11:00:01,908 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:00:01,908 - root - INFO - implementing data processing...
2024-02-13 11:00:01,909 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:00:01,909 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:00:01,933 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:00:01,947 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:00:01,955 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:00:01,978 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:00:01,991 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:00:01,991 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:00:02,006 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:00:04,118 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:00:04,118 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:00:04,118 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:00:04,362 - root - INFO - validating schema for dataframe....
2024-02-13 11:00:04,362 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:00:04,363 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:00:04,363 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:00:04,363 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:00:04,363 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:00:04,363 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:00:04,363 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:00:04,363 - validate - INFO - print schema done, go forward....
2024-02-13 11:00:04,363 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:00:04,364 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:00:04,364 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:00:04,365 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:00:04,365 - validate - INFO - print schema done, go forward....
2024-02-13 11:00:04,461 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:00:04,461 - root - INFO - transformation data processing....
2024-02-13 11:00:04,461 - root - INFO - displaying the df_report_1
2024-02-13 11:00:04,461 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:00:04,462 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:00:04,489 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:00:04,525 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:00:04,565 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:00:04,565 - root - INFO - display data_report2 method...
2024-02-13 11:00:04,565 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:00:04,565 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:00:04,638 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:00:10,772 - root - INFO - extracting files output....
2024-02-13 11:00:10,772 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:00:17,397 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:00:17,946 - root - INFO - show read data spark...
2024-02-13 11:00:18,008 - root - INFO - total amount of time taken: 24.54376320002484 seconds...
2024-02-13 11:00:18,008 - root - INFO - Application done
2024-02-13 11:08:19,277 - root - INFO - i am the main method...
2024-02-13 11:08:19,277 - root - INFO - calling spark object
2024-02-13 11:08:19,277 - create_spark - INFO - get_spark_object method started
2024-02-13 11:08:19,277 - create_spark - INFO - master is local
2024-02-13 11:08:23,318 - create_spark - INFO - Spark object create....
2024-02-13 11:08:23,318 - root - INFO - Validating spark object.......
2024-02-13 11:08:23,318 - validate - WARNING - started the get_current_date method...
2024-02-13 11:08:25,721 - validate - WARNING - Validation done, go forward...
2024-02-13 11:08:25,721 - root - INFO - Reading file which is of > parquet
2024-02-13 11:08:25,721 - infest - WARNING - Load_file method started...
2024-02-13 11:08:26,154 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:08:26,157 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:08:27,406 - root - INFO - validating the dataframe...
2024-02-13 11:08:27,406 - infest - WARNING - here to count the records in the df
2024-02-13 11:08:27,784 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:08:27,785 - infest - WARNING - Load_file method started...
2024-02-13 11:08:28,158 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:08:28,160 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:08:28,365 - root - INFO - validating the dataframe...
2024-02-13 11:08:28,365 - infest - WARNING - here to count the records in the df
2024-02-13 11:08:28,925 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:08:28,925 - root - INFO - implementing data processing...
2024-02-13 11:08:28,925 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:08:28,925 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:08:28,946 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:08:28,960 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:08:28,970 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:08:28,996 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:08:29,013 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:08:29,013 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:08:29,033 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:08:31,402 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:08:31,402 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:08:31,402 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:08:31,648 - root - INFO - validating schema for dataframe....
2024-02-13 11:08:31,648 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:08:31,649 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:08:31,649 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:08:31,649 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:08:31,649 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:08:31,649 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:08:31,649 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:08:31,649 - validate - INFO - print schema done, go forward....
2024-02-13 11:08:31,649 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:08:31,650 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:08:31,650 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:08:31,650 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:08:31,650 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:08:31,650 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:08:31,650 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:08:31,651 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:08:31,651 - validate - INFO - print schema done, go forward....
2024-02-13 11:08:31,760 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:08:31,760 - root - INFO - transformation data processing....
2024-02-13 11:08:31,760 - root - INFO - displaying the df_report_1
2024-02-13 11:08:31,760 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:08:31,761 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:08:31,787 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:08:31,820 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:08:31,866 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:08:31,866 - root - INFO - display data_report2 method...
2024-02-13 11:08:31,866 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:08:31,866 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:08:31,952 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:08:38,701 - root - INFO - extracting files output....
2024-02-13 11:08:38,701 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:08:45,314 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:08:45,391 - root - INFO - show read data spark...
2024-02-13 11:08:45,546 - root - INFO - total amount of time taken: 26.26833550000447 seconds...
2024-02-13 11:08:45,546 - root - INFO - Application done
2024-02-13 11:11:40,435 - root - INFO - i am the main method...
2024-02-13 11:11:40,435 - root - INFO - calling spark object
2024-02-13 11:11:40,435 - create_spark - INFO - get_spark_object method started
2024-02-13 11:11:40,435 - create_spark - INFO - master is local
2024-02-13 11:11:43,506 - create_spark - INFO - Spark object create....
2024-02-13 11:11:43,506 - root - INFO - Validating spark object.......
2024-02-13 11:11:43,506 - validate - WARNING - started the get_current_date method...
2024-02-13 11:11:45,932 - validate - WARNING - Validation done, go forward...
2024-02-13 11:11:45,932 - root - INFO - Reading file which is of > parquet
2024-02-13 11:11:45,932 - infest - WARNING - Load_file method started...
2024-02-13 11:11:46,370 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:11:46,373 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:11:47,743 - root - INFO - validating the dataframe...
2024-02-13 11:11:47,743 - infest - WARNING - here to count the records in the df
2024-02-13 11:11:48,154 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:11:48,155 - infest - WARNING - Load_file method started...
2024-02-13 11:11:48,582 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:11:48,584 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:11:48,807 - root - INFO - validating the dataframe...
2024-02-13 11:11:48,807 - infest - WARNING - here to count the records in the df
2024-02-13 11:11:49,393 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:11:49,393 - root - INFO - implementing data processing...
2024-02-13 11:11:49,393 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:11:49,394 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:11:49,422 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:11:49,438 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:11:49,447 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:11:49,478 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:11:49,492 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:11:49,492 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:11:49,510 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:11:52,073 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:11:52,073 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:11:52,073 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:11:52,345 - root - INFO - validating schema for dataframe....
2024-02-13 11:11:52,345 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:11:52,346 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:11:52,346 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:11:52,346 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:11:52,346 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:11:52,347 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:11:52,347 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:11:52,347 - validate - INFO - print schema done, go forward....
2024-02-13 11:11:52,347 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:11:52,348 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:11:52,348 - validate - INFO - print schema done, go forward....
2024-02-13 11:11:52,458 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:11:52,458 - root - INFO - transformation data processing....
2024-02-13 11:11:52,458 - root - INFO - displaying the df_report_1
2024-02-13 11:11:52,458 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:11:52,459 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:11:52,491 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:11:52,529 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:11:52,577 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:11:52,577 - root - INFO - display data_report2 method...
2024-02-13 11:11:52,578 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:11:52,578 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:11:52,664 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:11:59,274 - root - INFO - extracting files output....
2024-02-13 11:11:59,274 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:12:05,616 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:12:05,684 - root - INFO - show read data spark...
2024-02-13 11:12:05,846 - root - INFO - total amount of time taken: 25.41204330002074 seconds...
2024-02-13 11:12:05,846 - root - INFO - Application done
2024-02-13 11:13:13,742 - root - INFO - i am the main method...
2024-02-13 11:13:13,743 - root - INFO - calling spark object
2024-02-13 11:13:13,744 - create_spark - INFO - get_spark_object method started
2024-02-13 11:13:13,744 - create_spark - INFO - master is local
2024-02-13 11:13:16,701 - create_spark - INFO - Spark object create....
2024-02-13 11:13:16,702 - root - INFO - Validating spark object.......
2024-02-13 11:13:16,702 - validate - WARNING - started the get_current_date method...
2024-02-13 11:13:19,200 - validate - WARNING - Validation done, go forward...
2024-02-13 11:13:19,201 - root - INFO - Reading file which is of > parquet
2024-02-13 11:13:19,201 - infest - WARNING - Load_file method started...
2024-02-13 11:13:19,658 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:13:19,661 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:13:20,975 - root - INFO - validating the dataframe...
2024-02-13 11:13:20,975 - infest - WARNING - here to count the records in the df
2024-02-13 11:13:21,362 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:13:21,363 - infest - WARNING - Load_file method started...
2024-02-13 11:13:21,735 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:13:21,737 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:13:21,937 - root - INFO - validating the dataframe...
2024-02-13 11:13:21,937 - infest - WARNING - here to count the records in the df
2024-02-13 11:13:22,543 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:13:22,543 - root - INFO - implementing data processing...
2024-02-13 11:13:22,543 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:13:22,543 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:13:22,568 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:13:22,582 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:13:22,591 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:13:22,620 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:13:22,634 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:13:22,634 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:13:22,650 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:13:24,903 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:13:24,903 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:13:24,904 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:13:25,161 - root - INFO - validating schema for dataframe....
2024-02-13 11:13:25,161 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:13:25,162 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:13:25,162 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:13:25,162 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:13:25,162 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:13:25,162 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:13:25,162 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:13:25,163 - validate - INFO - print schema done, go forward....
2024-02-13 11:13:25,163 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:13:25,164 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:13:25,164 - validate - INFO - print schema done, go forward....
2024-02-13 11:13:25,273 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:13:25,273 - root - INFO - transformation data processing....
2024-02-13 11:13:25,273 - root - INFO - displaying the df_report_1
2024-02-13 11:13:25,273 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:13:25,274 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:13:25,309 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:13:25,343 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:13:25,394 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:13:25,394 - root - INFO - display data_report2 method...
2024-02-13 11:13:25,394 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:13:25,394 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:13:25,483 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:13:31,712 - root - INFO - extracting files output....
2024-02-13 11:13:31,712 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:13:37,867 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:13:37,938 - root - INFO - show read data spark...
2024-02-13 11:13:38,094 - root - INFO - total amount of time taken: 24.3511964000063 seconds...
2024-02-13 11:13:38,094 - root - INFO - Application done
2024-02-13 11:13:54,663 - root - INFO - i am the main method...
2024-02-13 11:13:54,664 - root - INFO - calling spark object
2024-02-13 11:13:54,664 - create_spark - INFO - get_spark_object method started
2024-02-13 11:13:54,664 - create_spark - INFO - master is local
2024-02-13 11:13:57,626 - create_spark - INFO - Spark object create....
2024-02-13 11:13:57,626 - root - INFO - Validating spark object.......
2024-02-13 11:13:57,626 - validate - WARNING - started the get_current_date method...
2024-02-13 11:14:00,006 - validate - WARNING - Validation done, go forward...
2024-02-13 11:14:00,006 - root - INFO - Reading file which is of > parquet
2024-02-13 11:14:00,006 - infest - WARNING - Load_file method started...
2024-02-13 11:14:00,501 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:14:00,503 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:14:01,804 - root - INFO - validating the dataframe...
2024-02-13 11:14:01,804 - infest - WARNING - here to count the records in the df
2024-02-13 11:14:02,261 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:14:02,261 - infest - WARNING - Load_file method started...
2024-02-13 11:14:02,636 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:14:02,638 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:14:02,829 - root - INFO - validating the dataframe...
2024-02-13 11:14:02,829 - infest - WARNING - here to count the records in the df
2024-02-13 11:14:03,383 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:14:03,384 - root - INFO - implementing data processing...
2024-02-13 11:14:03,384 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:14:03,384 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:14:03,411 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:14:03,427 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:14:03,438 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:14:03,466 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:14:03,478 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:14:03,479 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:14:03,496 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:14:05,647 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:14:05,647 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:14:05,647 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:14:05,878 - root - INFO - validating schema for dataframe....
2024-02-13 11:14:05,878 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:14:05,879 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:14:05,879 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:14:05,879 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:14:05,880 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:14:05,880 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:14:05,880 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:14:05,880 - validate - INFO - print schema done, go forward....
2024-02-13 11:14:05,880 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:14:05,881 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:14:05,881 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:14:05,881 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:14:05,881 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:14:05,882 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:14:05,882 - validate - INFO - print schema done, go forward....
2024-02-13 11:14:05,992 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:14:05,992 - root - INFO - transformation data processing....
2024-02-13 11:14:05,992 - root - INFO - displaying the df_report_1
2024-02-13 11:14:05,992 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:14:05,993 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:14:06,025 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:14:06,057 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:14:06,104 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:14:06,104 - root - INFO - display data_report2 method...
2024-02-13 11:14:06,104 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:14:06,104 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:14:06,194 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:14:12,314 - root - INFO - extracting files output....
2024-02-13 11:14:12,314 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:14:18,330 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:14:18,395 - root - INFO - show read data spark...
2024-02-13 11:14:18,568 - root - INFO - total amount of time taken: 23.904171900008805 seconds...
2024-02-13 11:14:18,568 - root - INFO - Application done
2024-02-13 11:14:35,313 - root - INFO - i am the main method...
2024-02-13 11:14:35,313 - root - INFO - calling spark object
2024-02-13 11:14:35,313 - create_spark - INFO - get_spark_object method started
2024-02-13 11:14:35,313 - create_spark - INFO - master is local
2024-02-13 11:14:38,246 - create_spark - INFO - Spark object create....
2024-02-13 11:14:38,246 - root - INFO - Validating spark object.......
2024-02-13 11:14:38,246 - validate - WARNING - started the get_current_date method...
2024-02-13 11:14:40,582 - validate - WARNING - Validation done, go forward...
2024-02-13 11:14:40,582 - root - INFO - Reading file which is of > parquet
2024-02-13 11:14:40,582 - infest - WARNING - Load_file method started...
2024-02-13 11:14:41,002 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:14:41,005 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:14:42,242 - root - INFO - validating the dataframe...
2024-02-13 11:14:42,242 - infest - WARNING - here to count the records in the df
2024-02-13 11:14:42,629 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:14:42,629 - infest - WARNING - Load_file method started...
2024-02-13 11:14:42,982 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:14:42,984 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:14:43,176 - root - INFO - validating the dataframe...
2024-02-13 11:14:43,176 - infest - WARNING - here to count the records in the df
2024-02-13 11:14:43,738 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:14:43,738 - root - INFO - implementing data processing...
2024-02-13 11:14:43,738 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:14:43,738 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:14:43,761 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:14:43,774 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:14:43,782 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:14:43,806 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:14:43,819 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:14:43,819 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:14:43,835 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:14:45,970 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:14:45,970 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:14:45,970 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:14:46,198 - root - INFO - validating schema for dataframe....
2024-02-13 11:14:46,198 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:14:46,199 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:14:46,199 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:14:46,199 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:14:46,199 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:14:46,199 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:14:46,199 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:14:46,199 - validate - INFO - print schema done, go forward....
2024-02-13 11:14:46,199 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:14:46,200 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:14:46,200 - validate - INFO - print schema done, go forward....
2024-02-13 11:14:46,313 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:14:46,313 - root - INFO - transformation data processing....
2024-02-13 11:14:46,313 - root - INFO - displaying the df_report_1
2024-02-13 11:14:46,313 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:14:46,314 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:14:46,341 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:14:46,375 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:14:46,418 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:14:46,418 - root - INFO - display data_report2 method...
2024-02-13 11:14:46,418 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:14:46,418 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:14:46,496 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:14:52,688 - root - INFO - extracting files output....
2024-02-13 11:14:52,688 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:14:57,850 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=596>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-13 11:14:57,853 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\seanghouch.ly\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o14.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-13 11:14:58,282 - root - INFO - i am the main method...
2024-02-13 11:14:58,282 - root - INFO - calling spark object
2024-02-13 11:14:58,282 - create_spark - INFO - get_spark_object method started
2024-02-13 11:14:58,282 - create_spark - INFO - master is local
2024-02-13 11:15:01,236 - create_spark - INFO - Spark object create....
2024-02-13 11:15:01,236 - root - INFO - Validating spark object.......
2024-02-13 11:15:01,236 - validate - WARNING - started the get_current_date method...
2024-02-13 11:15:03,568 - validate - WARNING - Validation done, go forward...
2024-02-13 11:15:03,568 - root - INFO - Reading file which is of > parquet
2024-02-13 11:15:03,568 - infest - WARNING - Load_file method started...
2024-02-13 11:15:03,999 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:15:04,002 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:15:05,256 - root - INFO - validating the dataframe...
2024-02-13 11:15:05,256 - infest - WARNING - here to count the records in the df
2024-02-13 11:15:05,642 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:15:05,642 - infest - WARNING - Load_file method started...
2024-02-13 11:15:05,987 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:15:05,988 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:15:06,175 - root - INFO - validating the dataframe...
2024-02-13 11:15:06,175 - infest - WARNING - here to count the records in the df
2024-02-13 11:15:06,721 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:15:06,721 - root - INFO - implementing data processing...
2024-02-13 11:15:06,722 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:15:06,722 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:15:06,747 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:15:06,762 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:15:06,772 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:15:06,798 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:15:06,812 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:15:06,812 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:15:06,829 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:15:08,936 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:15:08,936 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:15:08,936 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:15:09,173 - root - INFO - validating schema for dataframe....
2024-02-13 11:15:09,173 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:15:09,174 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:15:09,174 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:15:09,174 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:15:09,174 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:15:09,174 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:15:09,174 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:15:09,174 - validate - INFO - print schema done, go forward....
2024-02-13 11:15:09,174 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:15:09,175 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:15:09,176 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:15:09,176 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:15:09,176 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:15:09,176 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:15:09,176 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:15:09,176 - validate - INFO - print schema done, go forward....
2024-02-13 11:15:09,276 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:15:09,276 - root - INFO - transformation data processing....
2024-02-13 11:15:09,276 - root - INFO - displaying the df_report_1
2024-02-13 11:15:09,276 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:15:09,277 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:15:09,304 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:15:09,337 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:15:09,378 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:15:09,379 - root - INFO - display data_report2 method...
2024-02-13 11:15:09,379 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:15:09,379 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:15:09,464 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:15:15,584 - root - INFO - extracting files output....
2024-02-13 11:15:15,584 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:15:21,383 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:15:21,443 - root - INFO - show read data spark...
2024-02-13 11:15:21,585 - root - INFO - total amount of time taken: 23.302280800009612 seconds...
2024-02-13 11:15:21,585 - root - INFO - Application done
2024-02-13 11:15:51,189 - root - INFO - i am the main method...
2024-02-13 11:15:51,189 - root - INFO - calling spark object
2024-02-13 11:15:51,189 - create_spark - INFO - get_spark_object method started
2024-02-13 11:15:51,189 - create_spark - INFO - master is local
2024-02-13 11:15:54,121 - create_spark - INFO - Spark object create....
2024-02-13 11:15:54,121 - root - INFO - Validating spark object.......
2024-02-13 11:15:54,121 - validate - WARNING - started the get_current_date method...
2024-02-13 11:15:56,390 - validate - WARNING - Validation done, go forward...
2024-02-13 11:15:56,390 - root - INFO - Reading file which is of > parquet
2024-02-13 11:15:56,390 - infest - WARNING - Load_file method started...
2024-02-13 11:15:56,822 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:15:56,825 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:15:58,082 - root - INFO - validating the dataframe...
2024-02-13 11:15:58,082 - infest - WARNING - here to count the records in the df
2024-02-13 11:15:58,439 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:15:58,439 - infest - WARNING - Load_file method started...
2024-02-13 11:15:58,783 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:15:58,785 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:15:58,976 - root - INFO - validating the dataframe...
2024-02-13 11:15:58,976 - infest - WARNING - here to count the records in the df
2024-02-13 11:15:59,522 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:15:59,522 - root - INFO - implementing data processing...
2024-02-13 11:15:59,522 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:15:59,522 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:15:59,548 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:15:59,561 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:15:59,570 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:15:59,595 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:15:59,610 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:15:59,610 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:15:59,627 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:16:01,812 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:16:01,812 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:16:01,812 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:16:02,123 - root - INFO - validating schema for dataframe....
2024-02-13 11:16:02,123 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:16:02,124 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:16:02,124 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:16:02,124 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:16:02,125 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:16:02,125 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:16:02,125 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:16:02,125 - validate - INFO - print schema done, go forward....
2024-02-13 11:16:02,125 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:16:02,126 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:16:02,127 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:16:02,127 - validate - INFO - print schema done, go forward....
2024-02-13 11:16:02,237 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:16:02,237 - root - INFO - transformation data processing....
2024-02-13 11:16:02,237 - root - INFO - displaying the df_report_1
2024-02-13 11:16:02,237 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:16:02,238 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:16:02,263 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:16:02,290 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:16:02,340 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:16:02,340 - root - INFO - display data_report2 method...
2024-02-13 11:16:02,340 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:16:02,340 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:16:02,457 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:16:03,060 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=644>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-13 11:16:03,062 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\seanghouch.ly\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o14.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-13 11:16:04,234 - root - INFO - i am the main method...
2024-02-13 11:16:04,234 - root - INFO - calling spark object
2024-02-13 11:16:04,234 - create_spark - INFO - get_spark_object method started
2024-02-13 11:16:04,234 - create_spark - INFO - master is local
2024-02-13 11:16:07,165 - create_spark - INFO - Spark object create....
2024-02-13 11:16:07,165 - root - INFO - Validating spark object.......
2024-02-13 11:16:07,165 - validate - WARNING - started the get_current_date method...
2024-02-13 11:16:09,492 - validate - WARNING - Validation done, go forward...
2024-02-13 11:16:09,492 - root - INFO - Reading file which is of > parquet
2024-02-13 11:16:09,493 - infest - WARNING - Load_file method started...
2024-02-13 11:16:09,926 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:16:09,929 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:16:11,182 - root - INFO - validating the dataframe...
2024-02-13 11:16:11,182 - infest - WARNING - here to count the records in the df
2024-02-13 11:16:11,560 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:16:11,561 - infest - WARNING - Load_file method started...
2024-02-13 11:16:11,920 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:16:11,922 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:16:12,121 - root - INFO - validating the dataframe...
2024-02-13 11:16:12,121 - infest - WARNING - here to count the records in the df
2024-02-13 11:16:12,683 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:16:12,683 - root - INFO - implementing data processing...
2024-02-13 11:16:12,683 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:16:12,683 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:16:12,710 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:16:12,724 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:16:12,733 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:16:12,762 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:16:12,776 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:16:12,776 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:16:12,795 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:16:15,064 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:16:15,064 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:16:15,064 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:16:15,343 - root - INFO - validating schema for dataframe....
2024-02-13 11:16:15,343 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:16:15,344 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:16:15,344 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:16:15,344 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:16:15,344 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:16:15,345 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:16:15,345 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:16:15,345 - validate - INFO - print schema done, go forward....
2024-02-13 11:16:15,345 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:16:15,346 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:16:15,347 - validate - INFO - print schema done, go forward....
2024-02-13 11:16:15,463 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:16:15,463 - root - INFO - transformation data processing....
2024-02-13 11:16:15,463 - root - INFO - displaying the df_report_1
2024-02-13 11:16:15,463 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:16:15,464 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:16:15,498 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:16:15,530 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:16:15,574 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:16:15,574 - root - INFO - display data_report2 method...
2024-02-13 11:16:15,574 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:16:15,574 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:16:15,644 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:16:21,969 - root - INFO - extracting files output....
2024-02-13 11:16:21,970 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:16:28,358 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:16:28,419 - root - INFO - show read data spark...
2024-02-13 11:16:33,228 - root - INFO - total amount of time taken: 28.99450950001483 seconds...
2024-02-13 11:16:33,228 - root - INFO - Application done
2024-02-13 11:16:47,451 - root - INFO - i am the main method...
2024-02-13 11:16:47,451 - root - INFO - calling spark object
2024-02-13 11:16:47,452 - create_spark - INFO - get_spark_object method started
2024-02-13 11:16:47,452 - create_spark - INFO - master is local
2024-02-13 11:16:50,421 - create_spark - INFO - Spark object create....
2024-02-13 11:16:50,421 - root - INFO - Validating spark object.......
2024-02-13 11:16:50,421 - validate - WARNING - started the get_current_date method...
2024-02-13 11:16:52,740 - validate - WARNING - Validation done, go forward...
2024-02-13 11:16:52,740 - root - INFO - Reading file which is of > parquet
2024-02-13 11:16:52,740 - infest - WARNING - Load_file method started...
2024-02-13 11:16:53,158 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:16:53,161 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:16:54,419 - root - INFO - validating the dataframe...
2024-02-13 11:16:54,419 - infest - WARNING - here to count the records in the df
2024-02-13 11:16:54,752 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:16:54,753 - infest - WARNING - Load_file method started...
2024-02-13 11:16:55,095 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:16:55,096 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:16:55,284 - root - INFO - validating the dataframe...
2024-02-13 11:16:55,284 - infest - WARNING - here to count the records in the df
2024-02-13 11:16:55,826 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:16:55,826 - root - INFO - implementing data processing...
2024-02-13 11:16:55,826 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:16:55,826 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:16:55,852 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:16:55,867 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:16:55,877 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:16:55,905 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:16:55,918 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:16:55,918 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:16:55,935 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:16:58,122 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:16:58,122 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:16:58,122 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:16:58,353 - root - INFO - validating schema for dataframe....
2024-02-13 11:16:58,353 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:16:58,354 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:16:58,354 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:16:58,354 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:16:58,354 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:16:58,354 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:16:58,354 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:16:58,354 - validate - INFO - print schema done, go forward....
2024-02-13 11:16:58,354 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:16:58,355 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:16:58,355 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:16:58,356 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:16:58,356 - validate - INFO - print schema done, go forward....
2024-02-13 11:16:58,460 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:16:58,460 - root - INFO - transformation data processing....
2024-02-13 11:16:58,460 - root - INFO - displaying the df_report_1
2024-02-13 11:16:58,460 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:16:58,461 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:16:58,488 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:16:58,518 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:16:58,557 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:16:58,557 - root - INFO - display data_report2 method...
2024-02-13 11:16:58,557 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:16:58,557 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:16:58,633 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:17:04,688 - root - INFO - extracting files output....
2024-02-13 11:17:04,688 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:17:11,326 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:17:11,896 - root - INFO - show read data spark...
2024-02-13 11:17:16,706 - root - INFO - total amount of time taken: 29.255204699991737 seconds...
2024-02-13 11:17:16,706 - root - INFO - Application done
2024-02-13 11:17:25,212 - root - INFO - i am the main method...
2024-02-13 11:17:25,212 - root - INFO - calling spark object
2024-02-13 11:17:25,212 - create_spark - INFO - get_spark_object method started
2024-02-13 11:17:25,212 - create_spark - INFO - master is local
2024-02-13 11:17:28,153 - create_spark - INFO - Spark object create....
2024-02-13 11:17:28,153 - root - INFO - Validating spark object.......
2024-02-13 11:17:28,153 - validate - WARNING - started the get_current_date method...
2024-02-13 11:17:30,450 - validate - WARNING - Validation done, go forward...
2024-02-13 11:17:30,450 - root - INFO - Reading file which is of > parquet
2024-02-13 11:17:30,450 - infest - WARNING - Load_file method started...
2024-02-13 11:17:30,871 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:17:30,874 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:17:32,162 - root - INFO - validating the dataframe...
2024-02-13 11:17:32,162 - infest - WARNING - here to count the records in the df
2024-02-13 11:17:32,504 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:17:32,504 - infest - WARNING - Load_file method started...
2024-02-13 11:17:32,831 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:17:32,832 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:17:33,001 - root - INFO - validating the dataframe...
2024-02-13 11:17:33,001 - infest - WARNING - here to count the records in the df
2024-02-13 11:17:33,531 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:17:33,531 - root - INFO - implementing data processing...
2024-02-13 11:17:33,531 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:17:33,531 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:17:33,557 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:17:33,570 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:17:33,579 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:17:33,603 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:17:33,615 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:17:33,615 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:17:33,629 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:17:35,805 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:17:35,805 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:17:35,805 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:17:36,045 - root - INFO - validating schema for dataframe....
2024-02-13 11:17:36,045 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:17:36,046 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:17:36,046 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:17:36,046 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:17:36,046 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:17:36,046 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:17:36,046 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:17:36,046 - validate - INFO - print schema done, go forward....
2024-02-13 11:17:36,046 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:17:36,047 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:17:36,048 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:17:36,048 - validate - INFO - print schema done, go forward....
2024-02-13 11:17:36,151 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:17:36,151 - root - INFO - transformation data processing....
2024-02-13 11:17:36,151 - root - INFO - displaying the df_report_1
2024-02-13 11:17:36,151 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:17:36,152 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:17:36,179 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:17:36,210 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:17:36,249 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:17:36,249 - root - INFO - display data_report2 method...
2024-02-13 11:17:36,250 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:17:36,250 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:17:36,331 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:17:42,581 - root - INFO - extracting files output....
2024-02-13 11:17:42,581 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:17:48,652 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:17:48,724 - root - INFO - show read data spark...
2024-02-13 11:17:53,329 - root - INFO - total amount of time taken: 28.11748750001425 seconds...
2024-02-13 11:17:53,329 - root - INFO - Application done
2024-02-13 11:18:55,889 - root - INFO - i am the main method...
2024-02-13 11:18:55,889 - root - INFO - calling spark object
2024-02-13 11:18:55,889 - create_spark - INFO - get_spark_object method started
2024-02-13 11:18:55,889 - create_spark - INFO - master is local
2024-02-13 11:18:58,801 - create_spark - INFO - Spark object create....
2024-02-13 11:18:58,801 - root - INFO - Validating spark object.......
2024-02-13 11:18:58,801 - validate - WARNING - started the get_current_date method...
2024-02-13 11:19:01,112 - validate - WARNING - Validation done, go forward...
2024-02-13 11:19:01,113 - root - INFO - Reading file which is of > parquet
2024-02-13 11:19:01,113 - infest - WARNING - Load_file method started...
2024-02-13 11:19:01,516 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:19:01,518 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:19:02,836 - root - INFO - validating the dataframe...
2024-02-13 11:19:02,836 - infest - WARNING - here to count the records in the df
2024-02-13 11:19:03,200 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:19:03,200 - infest - WARNING - Load_file method started...
2024-02-13 11:19:03,559 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:19:03,560 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:19:03,760 - root - INFO - validating the dataframe...
2024-02-13 11:19:03,760 - infest - WARNING - here to count the records in the df
2024-02-13 11:19:04,299 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:19:04,299 - root - INFO - implementing data processing...
2024-02-13 11:19:04,300 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:19:04,300 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:19:04,322 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:19:04,335 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:19:04,343 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:19:04,368 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:19:04,381 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:19:04,381 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:19:04,396 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:19:06,511 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:19:06,511 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:19:06,511 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:19:06,732 - root - INFO - validating schema for dataframe....
2024-02-13 11:19:06,732 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:19:06,733 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:19:06,734 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:19:06,734 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:19:06,734 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:19:06,734 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:19:06,734 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:19:06,734 - validate - INFO - print schema done, go forward....
2024-02-13 11:19:06,734 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:19:06,735 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:19:06,735 - validate - INFO - print schema done, go forward....
2024-02-13 11:19:06,838 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:19:06,838 - root - INFO - transformation data processing....
2024-02-13 11:19:06,838 - root - INFO - displaying the df_report_1
2024-02-13 11:19:06,838 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:19:06,839 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:19:06,863 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:19:06,894 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:19:06,930 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:19:06,930 - root - INFO - display data_report2 method...
2024-02-13 11:19:06,930 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:19:06,930 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:19:07,000 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:19:13,409 - root - INFO - extracting files output....
2024-02-13 11:19:13,409 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:19:19,339 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:19:19,423 - root - INFO - show read data spark...
2024-02-13 11:19:23,970 - root - INFO - total amount of time taken: 28.081710999977076 seconds...
2024-02-13 11:19:23,970 - root - INFO - Application done
2024-02-13 11:20:59,602 - root - INFO - i am the main method...
2024-02-13 11:20:59,602 - root - INFO - calling spark object
2024-02-13 11:20:59,602 - create_spark - INFO - get_spark_object method started
2024-02-13 11:20:59,602 - create_spark - INFO - master is local
2024-02-13 11:21:02,425 - create_spark - INFO - Spark object create....
2024-02-13 11:21:02,425 - root - INFO - Validating spark object.......
2024-02-13 11:21:02,425 - validate - WARNING - started the get_current_date method...
2024-02-13 11:21:04,700 - validate - WARNING - Validation done, go forward...
2024-02-13 11:21:04,700 - root - INFO - Reading file which is of > parquet
2024-02-13 11:21:04,700 - infest - WARNING - Load_file method started...
2024-02-13 11:21:05,120 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:21:05,122 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:21:06,353 - root - INFO - validating the dataframe...
2024-02-13 11:21:06,353 - infest - WARNING - here to count the records in the df
2024-02-13 11:21:06,707 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:21:06,707 - infest - WARNING - Load_file method started...
2024-02-13 11:21:07,035 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:21:07,037 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:21:07,218 - root - INFO - validating the dataframe...
2024-02-13 11:21:07,218 - infest - WARNING - here to count the records in the df
2024-02-13 11:21:07,766 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:21:07,766 - root - INFO - implementing data processing...
2024-02-13 11:21:07,766 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:21:07,766 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:21:07,789 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:21:07,803 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:21:07,811 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:21:07,837 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:21:07,849 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:21:07,850 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:21:07,868 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:21:09,993 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:21:09,993 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:21:09,993 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:21:10,236 - root - INFO - validating schema for dataframe....
2024-02-13 11:21:10,236 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:21:10,237 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:21:10,237 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:21:10,237 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:21:10,238 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:21:10,238 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:21:10,238 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:21:10,238 - validate - INFO - print schema done, go forward....
2024-02-13 11:21:10,238 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:21:10,239 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:21:10,239 - validate - INFO - print schema done, go forward....
2024-02-13 11:21:10,342 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:21:10,342 - root - INFO - transformation data processing....
2024-02-13 11:21:10,342 - root - INFO - displaying the df_report_1
2024-02-13 11:21:10,342 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:21:10,343 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:21:10,373 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:21:10,412 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:21:10,457 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:21:10,457 - root - INFO - display data_report2 method...
2024-02-13 11:21:10,457 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:21:10,457 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:21:10,539 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:21:16,915 - root - INFO - extracting files output....
2024-02-13 11:21:16,915 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:21:23,488 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:21:24,056 - root - INFO - show read data spark...
2024-02-13 11:21:28,841 - root - INFO - total amount of time taken: 29.2399992000137 seconds...
2024-02-13 11:21:28,842 - root - INFO - Application done
2024-02-13 11:22:15,279 - root - INFO - i am the main method...
2024-02-13 11:22:15,279 - root - INFO - calling spark object
2024-02-13 11:22:15,279 - create_spark - INFO - get_spark_object method started
2024-02-13 11:22:15,279 - create_spark - INFO - master is local
2024-02-13 11:22:18,109 - create_spark - INFO - Spark object create....
2024-02-13 11:22:18,109 - root - INFO - Validating spark object.......
2024-02-13 11:22:18,109 - validate - WARNING - started the get_current_date method...
2024-02-13 11:22:20,397 - validate - WARNING - Validation done, go forward...
2024-02-13 11:22:20,397 - root - INFO - Reading file which is of > parquet
2024-02-13 11:22:20,397 - infest - WARNING - Load_file method started...
2024-02-13 11:22:20,842 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 11:22:20,845 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 11:22:22,143 - root - INFO - validating the dataframe...
2024-02-13 11:22:22,143 - infest - WARNING - here to count the records in the df
2024-02-13 11:22:22,552 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 11:22:22,552 - infest - WARNING - Load_file method started...
2024-02-13 11:22:22,887 - infest - WARNING - dataframe created  which is if csv
2024-02-13 11:22:22,889 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 11:22:23,076 - root - INFO - validating the dataframe...
2024-02-13 11:22:23,076 - infest - WARNING - here to count the records in the df
2024-02-13 11:22:23,597 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 11:22:23,597 - root - INFO - implementing data processing...
2024-02-13 11:22:23,597 - data_processing - WARNING - data_clean method() stating....
2024-02-13 11:22:23,597 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 11:22:23,621 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 11:22:23,635 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 11:22:23,643 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 11:22:23,670 - data_processing - WARNING - concat firstName and lastName
2024-02-13 11:22:23,684 - data_processing - WARNING - now check for null values in all column
2024-02-13 11:22:23,684 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 11:22:23,702 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 11:22:25,839 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 11:22:25,839 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 11:22:25,839 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 11:22:26,067 - root - INFO - validating schema for dataframe....
2024-02-13 11:22:26,067 - validate - WARNING - printing schema method starting... df_city
2024-02-13 11:22:26,068 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 11:22:26,068 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 11:22:26,068 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 11:22:26,068 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 11:22:26,068 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 11:22:26,068 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 11:22:26,068 - validate - INFO - print schema done, go forward....
2024-02-13 11:22:26,068 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 11:22:26,069 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 11:22:26,071 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 11:22:26,071 - validate - INFO - print schema done, go forward....
2024-02-13 11:22:26,168 - root - INFO - checking null values schema for dataframe....
2024-02-13 11:22:26,168 - root - INFO - transformation data processing....
2024-02-13 11:22:26,168 - root - INFO - displaying the df_report_1
2024-02-13 11:22:26,168 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 11:22:26,168 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 11:22:26,194 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 11:22:26,226 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 11:22:26,262 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 11:22:26,262 - root - INFO - display data_report2 method...
2024-02-13 11:22:26,262 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 11:22:26,262 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 11:22:26,329 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 11:22:32,404 - root - INFO - extracting files output....
2024-02-13 11:22:32,405 - extraction - WARNING - extracting_file method starting....
2024-02-13 11:22:38,755 - extraction - WARNING - extract_file method successfully...
2024-02-13 11:22:38,831 - root - INFO - show read data spark...
2024-02-13 11:22:43,734 - root - INFO - total amount of time taken: 28.454631700005848 seconds...
2024-02-13 11:22:43,734 - root - INFO - Application done
2024-02-13 14:31:56,673 - root - INFO - i am the main method...
2024-02-13 14:31:56,673 - root - INFO - calling spark object
2024-02-13 14:31:56,673 - create_spark - INFO - get_spark_object method started
2024-02-13 14:31:56,673 - create_spark - INFO - master is local
2024-02-13 14:31:59,648 - create_spark - INFO - Spark object create....
2024-02-13 14:31:59,648 - root - INFO - Validating spark object.......
2024-02-13 14:31:59,648 - validate - WARNING - started the get_current_date method...
2024-02-13 14:32:02,172 - validate - WARNING - Validation done, go forward...
2024-02-13 14:32:02,172 - root - INFO - Reading file which is of > parquet
2024-02-13 14:32:02,172 - infest - WARNING - Load_file method started...
2024-02-13 14:32:02,674 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 14:32:02,677 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 14:32:04,118 - root - INFO - validating the dataframe...
2024-02-13 14:32:04,118 - infest - WARNING - here to count the records in the df
2024-02-13 14:32:04,586 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 14:32:04,586 - infest - WARNING - Load_file method started...
2024-02-13 14:32:05,006 - infest - WARNING - dataframe created  which is if csv
2024-02-13 14:32:05,008 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 14:32:05,273 - root - INFO - validating the dataframe...
2024-02-13 14:32:05,273 - infest - WARNING - here to count the records in the df
2024-02-13 14:32:05,918 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 14:32:05,919 - root - INFO - implementing data processing...
2024-02-13 14:32:05,919 - data_processing - WARNING - data_clean method() stating....
2024-02-13 14:32:05,919 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 14:32:05,954 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 14:32:05,975 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 14:32:05,986 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 14:32:06,023 - data_processing - WARNING - concat firstName and lastName
2024-02-13 14:32:06,058 - data_processing - WARNING - now check for null values in all column
2024-02-13 14:32:06,058 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 14:32:06,094 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 14:32:08,602 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 14:32:08,603 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 14:32:08,603 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 14:32:08,941 - root - INFO - validating schema for dataframe....
2024-02-13 14:32:08,941 - validate - WARNING - printing schema method starting... df_city
2024-02-13 14:32:08,943 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 14:32:08,943 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 14:32:08,943 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 14:32:08,943 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 14:32:08,943 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 14:32:08,943 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 14:32:08,943 - validate - INFO - print schema done, go forward....
2024-02-13 14:32:08,944 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 14:32:08,944 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 14:32:08,945 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 14:32:08,945 - validate - INFO - print schema done, go forward....
2024-02-13 14:32:09,060 - root - INFO - checking null values schema for dataframe....
2024-02-13 14:32:09,060 - root - INFO - transformation data processing....
2024-02-13 14:32:09,060 - root - INFO - displaying the df_report_1
2024-02-13 14:32:09,060 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 14:32:09,061 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 14:32:09,091 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 14:32:09,130 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 14:32:09,181 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 14:32:09,181 - root - INFO - display data_report2 method...
2024-02-13 14:32:09,181 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 14:32:09,181 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 14:32:09,278 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 14:32:16,230 - root - INFO - extracting files output....
2024-02-13 14:32:16,230 - extraction - WARNING - extracting_file method starting....
2024-02-13 14:32:22,935 - extraction - WARNING - extract_file method successfully...
2024-02-13 14:32:23,047 - root - INFO - show read data spark...
2024-02-13 14:32:28,130 - root - INFO - writing into have table
2024-02-13 14:54:00,482 - root - INFO - i am the main method...
2024-02-13 14:54:00,482 - root - INFO - calling spark object
2024-02-13 14:54:00,482 - create_spark - INFO - get_spark_object method started
2024-02-13 14:54:00,482 - create_spark - INFO - master is local
2024-02-13 14:54:04,438 - create_spark - INFO - Spark object create....
2024-02-13 14:54:04,438 - root - INFO - Validating spark object.......
2024-02-13 14:54:04,438 - validate - WARNING - started the get_current_date method...
2024-02-13 14:54:06,843 - validate - WARNING - Validation done, go forward...
2024-02-13 14:54:06,843 - root - INFO - Reading file which is of > parquet
2024-02-13 14:54:06,843 - infest - WARNING - Load_file method started...
2024-02-13 14:54:07,298 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 14:54:07,300 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 14:54:08,597 - root - INFO - validating the dataframe...
2024-02-13 14:54:08,597 - infest - WARNING - here to count the records in the df
2024-02-13 14:54:08,974 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 14:54:08,974 - infest - WARNING - Load_file method started...
2024-02-13 14:54:09,348 - infest - WARNING - dataframe created  which is if csv
2024-02-13 14:54:09,350 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 14:54:09,554 - root - INFO - validating the dataframe...
2024-02-13 14:54:09,554 - infest - WARNING - here to count the records in the df
2024-02-13 14:54:10,190 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 14:54:10,190 - root - INFO - implementing data processing...
2024-02-13 14:54:10,190 - data_processing - WARNING - data_clean method() stating....
2024-02-13 14:54:10,190 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 14:54:10,222 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 14:54:10,241 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 14:54:10,251 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 14:54:10,285 - data_processing - WARNING - concat firstName and lastName
2024-02-13 14:54:10,302 - data_processing - WARNING - now check for null values in all column
2024-02-13 14:54:10,302 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 14:54:10,318 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 14:54:12,456 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 14:54:12,456 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 14:54:12,456 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 14:54:12,718 - root - INFO - validating schema for dataframe....
2024-02-13 14:54:12,718 - validate - WARNING - printing schema method starting... df_city
2024-02-13 14:54:12,719 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 14:54:12,719 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 14:54:12,719 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 14:54:12,720 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 14:54:12,720 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 14:54:12,720 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 14:54:12,720 - validate - INFO - print schema done, go forward....
2024-02-13 14:54:12,720 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 14:54:12,721 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 14:54:12,721 - validate - INFO - print schema done, go forward....
2024-02-13 14:54:12,841 - root - INFO - checking null values schema for dataframe....
2024-02-13 14:54:12,841 - root - INFO - transformation data processing....
2024-02-13 14:54:12,841 - root - INFO - displaying the df_report_1
2024-02-13 14:54:12,841 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 14:54:12,842 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 14:54:12,876 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 14:54:12,915 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 14:54:12,965 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 14:54:12,966 - root - INFO - display data_report2 method...
2024-02-13 14:54:12,966 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 14:54:12,966 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 14:54:13,052 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 14:54:19,489 - root - INFO - extracting files output....
2024-02-13 14:54:19,489 - extraction - WARNING - extracting_file method starting....
2024-02-13 14:54:25,834 - extraction - WARNING - extract_file method successfully...
2024-02-13 14:54:25,915 - root - INFO - show read data spark...
2024-02-13 14:54:30,714 - root - INFO - writing into have table
2024-02-13 14:57:25,064 - root - INFO - i am the main method...
2024-02-13 14:57:25,065 - root - INFO - calling spark object
2024-02-13 14:57:25,065 - create_spark - INFO - get_spark_object method started
2024-02-13 14:57:25,065 - create_spark - INFO - master is local
2024-02-13 14:57:28,112 - create_spark - INFO - Spark object create....
2024-02-13 14:57:28,112 - root - INFO - Validating spark object.......
2024-02-13 14:57:28,112 - validate - WARNING - started the get_current_date method...
2024-02-13 14:57:30,572 - validate - WARNING - Validation done, go forward...
2024-02-13 14:57:30,572 - root - INFO - Reading file which is of > parquet
2024-02-13 14:57:30,572 - infest - WARNING - Load_file method started...
2024-02-13 14:57:31,069 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 14:57:31,072 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 14:57:32,383 - root - INFO - validating the dataframe...
2024-02-13 14:57:32,383 - infest - WARNING - here to count the records in the df
2024-02-13 14:57:32,766 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 14:57:32,767 - infest - WARNING - Load_file method started...
2024-02-13 14:57:33,145 - infest - WARNING - dataframe created  which is if csv
2024-02-13 14:57:33,147 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 14:57:33,347 - root - INFO - validating the dataframe...
2024-02-13 14:57:33,347 - infest - WARNING - here to count the records in the df
2024-02-13 14:57:33,926 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 14:57:33,926 - root - INFO - implementing data processing...
2024-02-13 14:57:33,927 - data_processing - WARNING - data_clean method() stating....
2024-02-13 14:57:33,927 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 14:57:33,974 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 14:57:33,991 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 14:57:34,002 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 14:57:34,040 - data_processing - WARNING - concat firstName and lastName
2024-02-13 14:57:34,058 - data_processing - WARNING - now check for null values in all column
2024-02-13 14:57:34,058 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 14:57:34,085 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 14:57:36,382 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 14:57:36,382 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 14:57:36,383 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 14:57:36,662 - root - INFO - validating schema for dataframe....
2024-02-13 14:57:36,662 - validate - WARNING - printing schema method starting... df_city
2024-02-13 14:57:36,664 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 14:57:36,664 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 14:57:36,664 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 14:57:36,664 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 14:57:36,664 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 14:57:36,664 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 14:57:36,664 - validate - INFO - print schema done, go forward....
2024-02-13 14:57:36,664 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 14:57:36,665 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 14:57:36,665 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 14:57:36,665 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 14:57:36,665 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 14:57:36,666 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 14:57:36,666 - validate - INFO - print schema done, go forward....
2024-02-13 14:57:36,798 - root - INFO - checking null values schema for dataframe....
2024-02-13 14:57:36,798 - root - INFO - transformation data processing....
2024-02-13 14:57:36,798 - root - INFO - displaying the df_report_1
2024-02-13 14:57:36,798 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 14:57:36,799 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 14:57:36,837 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 14:57:36,875 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 14:57:36,934 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 14:57:36,934 - root - INFO - display data_report2 method...
2024-02-13 14:57:36,934 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 14:57:36,934 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 14:57:37,017 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 14:57:43,564 - root - INFO - extracting files output....
2024-02-13 14:57:43,564 - extraction - WARNING - extracting_file method starting....
2024-02-13 14:57:49,931 - extraction - WARNING - extract_file method successfully...
2024-02-13 14:57:50,013 - root - INFO - show read data spark...
2024-02-13 14:57:54,557 - root - INFO - writing into have table
2024-02-13 14:57:54,557 - root - INFO - successfully written into Hive
2024-02-13 14:57:54,558 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:00:43,410 - root - INFO - i am the main method...
2024-02-13 15:00:43,410 - root - INFO - calling spark object
2024-02-13 15:00:43,410 - create_spark - INFO - get_spark_object method started
2024-02-13 15:00:43,410 - create_spark - INFO - master is local
2024-02-13 15:00:46,370 - create_spark - INFO - Spark object create....
2024-02-13 15:00:46,370 - root - INFO - Validating spark object.......
2024-02-13 15:00:46,370 - validate - WARNING - started the get_current_date method...
2024-02-13 15:00:48,738 - validate - WARNING - Validation done, go forward...
2024-02-13 15:00:48,738 - root - INFO - Reading file which is of > parquet
2024-02-13 15:00:48,738 - infest - WARNING - Load_file method started...
2024-02-13 15:00:49,174 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:00:49,177 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:00:50,443 - root - INFO - validating the dataframe...
2024-02-13 15:00:50,443 - infest - WARNING - here to count the records in the df
2024-02-13 15:00:50,799 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:00:50,800 - infest - WARNING - Load_file method started...
2024-02-13 15:00:51,158 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:00:51,160 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:00:51,339 - root - INFO - validating the dataframe...
2024-02-13 15:00:51,339 - infest - WARNING - here to count the records in the df
2024-02-13 15:00:51,844 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:00:51,844 - root - INFO - implementing data processing...
2024-02-13 15:00:51,844 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:00:51,845 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:00:51,869 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:00:51,883 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:00:51,892 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:00:51,917 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:00:51,933 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:00:51,933 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:00:51,951 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:00:54,073 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:00:54,073 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:00:54,073 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:00:54,326 - root - INFO - validating schema for dataframe....
2024-02-13 15:00:54,326 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:00:54,327 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:00:54,327 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:00:54,327 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:00:54,327 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:00:54,327 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:00:54,327 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:00:54,327 - validate - INFO - print schema done, go forward....
2024-02-13 15:00:54,327 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:00:54,328 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:00:54,328 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:00:54,328 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:00:54,328 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:00:54,328 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:00:54,329 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:00:54,329 - validate - INFO - print schema done, go forward....
2024-02-13 15:00:54,425 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:00:54,425 - root - INFO - transformation data processing....
2024-02-13 15:00:54,425 - root - INFO - displaying the df_report_1
2024-02-13 15:00:54,425 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:00:54,426 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:00:54,453 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:00:54,485 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:00:54,524 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:00:54,524 - root - INFO - display data_report2 method...
2024-02-13 15:00:54,524 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:00:54,524 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:00:54,602 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:01:01,046 - root - INFO - extracting files output....
2024-02-13 15:01:01,046 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:01:07,338 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:01:07,418 - root - INFO - show read data spark...
2024-02-13 15:01:12,144 - root - INFO - writing into have table
2024-02-13 15:01:12,145 - root - INFO - successfully written into Hive
2024-02-13 15:01:12,145 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:06:59,925 - root - INFO - i am the main method...
2024-02-13 15:06:59,925 - root - INFO - calling spark object
2024-02-13 15:06:59,925 - create_spark - INFO - get_spark_object method started
2024-02-13 15:06:59,925 - create_spark - INFO - master is local
2024-02-13 15:07:02,913 - create_spark - INFO - Spark object create....
2024-02-13 15:07:02,913 - root - INFO - Validating spark object.......
2024-02-13 15:07:02,913 - validate - WARNING - started the get_current_date method...
2024-02-13 15:07:05,322 - validate - WARNING - Validation done, go forward...
2024-02-13 15:07:05,322 - root - INFO - Reading file which is of > parquet
2024-02-13 15:07:05,322 - infest - WARNING - Load_file method started...
2024-02-13 15:07:05,801 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:07:05,804 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:07:07,071 - root - INFO - validating the dataframe...
2024-02-13 15:07:07,071 - infest - WARNING - here to count the records in the df
2024-02-13 15:07:07,447 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:07:07,447 - infest - WARNING - Load_file method started...
2024-02-13 15:07:07,812 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:07:07,813 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:07:08,025 - root - INFO - validating the dataframe...
2024-02-13 15:07:08,025 - infest - WARNING - here to count the records in the df
2024-02-13 15:07:08,646 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:07:08,646 - root - INFO - implementing data processing...
2024-02-13 15:07:08,646 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:07:08,646 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:07:08,671 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:07:08,683 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:07:08,691 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:07:08,715 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:07:08,726 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:07:08,726 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:07:08,738 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:07:10,877 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:07:10,877 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:07:10,878 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:07:11,126 - root - INFO - validating schema for dataframe....
2024-02-13 15:07:11,126 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:07:11,127 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:07:11,127 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:07:11,127 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:07:11,127 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:07:11,127 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:07:11,127 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:07:11,127 - validate - INFO - print schema done, go forward....
2024-02-13 15:07:11,127 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:07:11,128 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:07:11,129 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:07:11,129 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:07:11,129 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:07:11,129 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:07:11,129 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:07:11,129 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:07:11,129 - validate - INFO - print schema done, go forward....
2024-02-13 15:07:11,223 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:07:11,223 - root - INFO - transformation data processing....
2024-02-13 15:07:11,223 - root - INFO - displaying the df_report_1
2024-02-13 15:07:11,223 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:07:11,224 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:07:11,248 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:07:11,275 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:07:11,310 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:07:11,311 - root - INFO - display data_report2 method...
2024-02-13 15:07:11,311 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:07:11,311 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:07:11,379 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:07:17,787 - root - INFO - extracting files output....
2024-02-13 15:07:17,787 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:07:24,164 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:07:24,246 - root - INFO - show read data spark...
2024-02-13 15:07:29,381 - root - INFO - writing into have table
2024-02-13 15:07:29,381 - root - INFO - successfully written into Hive
2024-02-13 15:07:29,382 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:07:37,145 - root - INFO - total amount of time taken: 37.22071659998619 seconds...
2024-02-13 15:07:37,145 - root - INFO - Application done
2024-02-13 15:08:54,748 - root - INFO - i am the main method...
2024-02-13 15:08:54,748 - root - INFO - calling spark object
2024-02-13 15:08:54,748 - create_spark - INFO - get_spark_object method started
2024-02-13 15:08:54,748 - create_spark - INFO - master is local
2024-02-13 15:08:57,815 - create_spark - INFO - Spark object create....
2024-02-13 15:08:57,815 - root - INFO - Validating spark object.......
2024-02-13 15:08:57,815 - validate - WARNING - started the get_current_date method...
2024-02-13 15:09:00,200 - validate - WARNING - Validation done, go forward...
2024-02-13 15:09:00,200 - root - INFO - Reading file which is of > parquet
2024-02-13 15:09:00,200 - infest - WARNING - Load_file method started...
2024-02-13 15:09:00,609 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:09:00,613 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:09:01,959 - root - INFO - validating the dataframe...
2024-02-13 15:09:01,959 - infest - WARNING - here to count the records in the df
2024-02-13 15:09:02,305 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:09:02,305 - infest - WARNING - Load_file method started...
2024-02-13 15:09:02,639 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:09:02,641 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:09:02,833 - root - INFO - validating the dataframe...
2024-02-13 15:09:02,833 - infest - WARNING - here to count the records in the df
2024-02-13 15:09:03,367 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:09:03,367 - root - INFO - implementing data processing...
2024-02-13 15:09:03,367 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:09:03,367 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:09:03,391 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:09:03,404 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:09:03,413 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:09:03,439 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:09:03,453 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:09:03,453 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:09:03,468 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:09:05,590 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:09:05,590 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:09:05,590 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:09:05,827 - root - INFO - validating schema for dataframe....
2024-02-13 15:09:05,827 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:09:05,828 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:09:05,828 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:09:05,828 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:09:05,828 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:09:05,828 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:09:05,828 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:09:05,828 - validate - INFO - print schema done, go forward....
2024-02-13 15:09:05,828 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:09:05,829 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:09:05,830 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:09:05,830 - validate - INFO - print schema done, go forward....
2024-02-13 15:09:05,930 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:09:05,930 - root - INFO - transformation data processing....
2024-02-13 15:09:05,930 - root - INFO - displaying the df_report_1
2024-02-13 15:09:05,930 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:09:05,930 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:09:05,962 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:09:05,999 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:09:06,045 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:09:06,045 - root - INFO - display data_report2 method...
2024-02-13 15:09:06,045 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:09:06,045 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:09:06,148 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:09:12,283 - root - INFO - extracting files output....
2024-02-13 15:09:12,283 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:09:18,533 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:09:18,604 - root - INFO - show read data spark...
2024-02-13 15:09:23,395 - root - INFO - writing into have table
2024-02-13 15:09:23,395 - root - INFO - successfully written into Hive
2024-02-13 15:09:23,396 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:09:39,822 - root - INFO - i am the main method...
2024-02-13 15:09:39,822 - root - INFO - calling spark object
2024-02-13 15:09:39,822 - create_spark - INFO - get_spark_object method started
2024-02-13 15:09:39,822 - create_spark - INFO - master is local
2024-02-13 15:09:42,786 - create_spark - INFO - Spark object create....
2024-02-13 15:09:42,786 - root - INFO - Validating spark object.......
2024-02-13 15:09:42,786 - validate - WARNING - started the get_current_date method...
2024-02-13 15:09:45,161 - validate - WARNING - Validation done, go forward...
2024-02-13 15:09:45,161 - root - INFO - Reading file which is of > parquet
2024-02-13 15:09:45,162 - infest - WARNING - Load_file method started...
2024-02-13 15:09:45,596 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:09:45,600 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:09:46,814 - root - INFO - validating the dataframe...
2024-02-13 15:09:46,814 - infest - WARNING - here to count the records in the df
2024-02-13 15:09:47,174 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:09:47,174 - infest - WARNING - Load_file method started...
2024-02-13 15:09:47,530 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:09:47,532 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:09:47,733 - root - INFO - validating the dataframe...
2024-02-13 15:09:47,733 - infest - WARNING - here to count the records in the df
2024-02-13 15:09:48,263 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:09:48,263 - root - INFO - implementing data processing...
2024-02-13 15:09:48,263 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:09:48,263 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:09:48,287 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:09:48,300 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:09:48,309 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:09:48,333 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:09:48,346 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:09:48,346 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:09:48,362 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:09:50,464 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:09:50,464 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:09:50,464 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:09:50,711 - root - INFO - validating schema for dataframe....
2024-02-13 15:09:50,711 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:09:50,712 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:09:50,712 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:09:50,712 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:09:50,712 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:09:50,712 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:09:50,712 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:09:50,712 - validate - INFO - print schema done, go forward....
2024-02-13 15:09:50,712 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:09:50,713 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:09:50,713 - validate - INFO - print schema done, go forward....
2024-02-13 15:09:50,807 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:09:50,807 - root - INFO - transformation data processing....
2024-02-13 15:09:50,807 - root - INFO - displaying the df_report_1
2024-02-13 15:09:50,807 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:09:50,808 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:09:50,830 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:09:50,857 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:09:50,887 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:09:50,887 - root - INFO - display data_report2 method...
2024-02-13 15:09:50,887 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:09:50,887 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:09:50,949 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:09:57,390 - root - INFO - extracting files output....
2024-02-13 15:09:57,390 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:10:03,598 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:10:03,678 - root - INFO - show read data spark...
2024-02-13 15:10:08,517 - root - INFO - writing into have table
2024-02-13 15:10:08,517 - root - INFO - successfully written into Hive
2024-02-13 15:10:08,518 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:10:16,340 - root - INFO - total amount of time taken: 36.5183855999785 seconds...
2024-02-13 15:10:16,340 - root - INFO - Application done
2024-02-13 15:11:26,553 - root - INFO - i am the main method...
2024-02-13 15:11:26,553 - root - INFO - calling spark object
2024-02-13 15:11:26,553 - create_spark - INFO - get_spark_object method started
2024-02-13 15:11:26,553 - create_spark - INFO - master is local
2024-02-13 15:11:29,517 - create_spark - INFO - Spark object create....
2024-02-13 15:11:29,517 - root - INFO - Validating spark object.......
2024-02-13 15:11:29,517 - validate - WARNING - started the get_current_date method...
2024-02-13 15:11:32,005 - validate - WARNING - Validation done, go forward...
2024-02-13 15:11:32,005 - root - INFO - Reading file which is of > parquet
2024-02-13 15:11:32,006 - infest - WARNING - Load_file method started...
2024-02-13 15:11:32,482 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:11:32,485 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:11:33,770 - root - INFO - validating the dataframe...
2024-02-13 15:11:33,770 - infest - WARNING - here to count the records in the df
2024-02-13 15:11:34,149 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:11:34,149 - infest - WARNING - Load_file method started...
2024-02-13 15:11:34,531 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:11:34,532 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:11:34,757 - root - INFO - validating the dataframe...
2024-02-13 15:11:34,757 - infest - WARNING - here to count the records in the df
2024-02-13 15:11:35,287 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:11:35,287 - root - INFO - implementing data processing...
2024-02-13 15:11:35,287 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:11:35,287 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:11:35,309 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:11:35,323 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:11:35,331 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:11:35,355 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:11:35,368 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:11:35,368 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:11:35,383 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:11:37,513 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:11:37,513 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:11:37,513 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:11:37,744 - root - INFO - validating schema for dataframe....
2024-02-13 15:11:37,744 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:11:37,745 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:11:37,745 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:11:37,745 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:11:37,745 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:11:37,745 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:11:37,745 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:11:37,745 - validate - INFO - print schema done, go forward....
2024-02-13 15:11:37,745 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:11:37,746 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:11:37,746 - validate - INFO - print schema done, go forward....
2024-02-13 15:11:37,840 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:11:37,840 - root - INFO - transformation data processing....
2024-02-13 15:11:37,840 - root - INFO - displaying the df_report_1
2024-02-13 15:11:37,840 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:11:37,841 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:11:37,869 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:11:37,897 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:11:37,929 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:11:37,929 - root - INFO - display data_report2 method...
2024-02-13 15:11:37,929 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:11:37,929 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:11:37,995 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:11:44,062 - root - INFO - extracting files output....
2024-02-13 15:11:44,062 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:11:50,111 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:11:50,188 - root - INFO - show read data spark...
2024-02-13 15:11:55,021 - root - INFO - writing into have table
2024-02-13 15:11:55,021 - root - INFO - successfully written into Hive
2024-02-13 15:11:55,022 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:12:03,026 - root - INFO - total amount of time taken: 36.4719996000058 seconds...
2024-02-13 15:12:03,026 - root - INFO - Application done
2024-02-13 15:20:02,019 - root - INFO - i am the main method...
2024-02-13 15:20:02,019 - root - INFO - calling spark object
2024-02-13 15:20:02,019 - create_spark - INFO - get_spark_object method started
2024-02-13 15:20:02,019 - create_spark - INFO - master is local
2024-02-13 15:20:05,125 - create_spark - INFO - Spark object create....
2024-02-13 15:20:05,125 - root - INFO - Validating spark object.......
2024-02-13 15:20:05,125 - validate - WARNING - started the get_current_date method...
2024-02-13 15:20:07,659 - validate - WARNING - Validation done, go forward...
2024-02-13 15:20:07,660 - root - INFO - Reading file which is of > parquet
2024-02-13 15:20:07,660 - infest - WARNING - Load_file method started...
2024-02-13 15:20:08,082 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:20:08,085 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:20:09,434 - root - INFO - validating the dataframe...
2024-02-13 15:20:09,434 - infest - WARNING - here to count the records in the df
2024-02-13 15:20:09,820 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:20:09,820 - infest - WARNING - Load_file method started...
2024-02-13 15:20:10,190 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:20:10,191 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:20:10,387 - root - INFO - validating the dataframe...
2024-02-13 15:20:10,387 - infest - WARNING - here to count the records in the df
2024-02-13 15:20:10,990 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:20:10,991 - root - INFO - implementing data processing...
2024-02-13 15:20:10,991 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:20:10,991 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:20:11,025 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:20:11,043 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:20:11,055 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:20:11,091 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:20:11,106 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:20:11,106 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:20:11,125 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:20:13,307 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:20:13,307 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:20:13,307 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:20:13,563 - root - INFO - validating schema for dataframe....
2024-02-13 15:20:13,563 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:20:13,565 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:20:13,565 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:20:13,565 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:20:13,565 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:20:13,565 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:20:13,565 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:20:13,565 - validate - INFO - print schema done, go forward....
2024-02-13 15:20:13,565 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:20:13,566 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:20:13,567 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:20:13,567 - validate - INFO - print schema done, go forward....
2024-02-13 15:20:13,682 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:20:13,682 - root - INFO - transformation data processing....
2024-02-13 15:20:13,682 - root - INFO - displaying the df_report_1
2024-02-13 15:20:13,682 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:20:13,683 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:20:13,712 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:20:13,739 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:20:13,777 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:20:13,777 - root - INFO - display data_report2 method...
2024-02-13 15:20:13,777 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:20:13,777 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:20:13,855 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:20:20,509 - root - INFO - extracting files output....
2024-02-13 15:20:20,509 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:20:27,000 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:20:27,091 - root - INFO - show read data spark...
2024-02-13 15:20:32,164 - root - INFO - writing into have table
2024-02-13 15:20:32,164 - root - INFO - successfully written into Hive
2024-02-13 15:20:32,165 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:20:39,866 - root - INFO - total amount of time taken: 37.84614730000612 seconds...
2024-02-13 15:20:39,867 - root - INFO - Application done
2024-02-13 15:21:33,104 - root - INFO - i am the main method...
2024-02-13 15:21:33,104 - root - INFO - calling spark object
2024-02-13 15:21:33,104 - create_spark - INFO - get_spark_object method started
2024-02-13 15:21:33,104 - create_spark - INFO - master is local
2024-02-13 15:21:36,210 - create_spark - INFO - Spark object create....
2024-02-13 15:21:36,211 - root - INFO - Validating spark object.......
2024-02-13 15:21:36,211 - validate - WARNING - started the get_current_date method...
2024-02-13 15:21:38,634 - validate - WARNING - Validation done, go forward...
2024-02-13 15:21:38,634 - root - INFO - Reading file which is of > parquet
2024-02-13 15:21:38,634 - infest - WARNING - Load_file method started...
2024-02-13 15:21:39,058 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:21:39,061 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:21:40,374 - root - INFO - validating the dataframe...
2024-02-13 15:21:40,374 - infest - WARNING - here to count the records in the df
2024-02-13 15:21:40,817 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:21:40,818 - infest - WARNING - Load_file method started...
2024-02-13 15:21:41,210 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:21:41,212 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:21:41,417 - root - INFO - validating the dataframe...
2024-02-13 15:21:41,417 - infest - WARNING - here to count the records in the df
2024-02-13 15:21:41,979 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:21:41,979 - root - INFO - implementing data processing...
2024-02-13 15:21:41,979 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:21:41,979 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:21:42,004 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:21:42,017 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:21:42,026 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:21:42,053 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:21:42,067 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:21:42,067 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:21:42,084 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:21:44,292 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:21:44,293 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:21:44,293 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:21:44,527 - root - INFO - validating schema for dataframe....
2024-02-13 15:21:44,527 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:21:44,528 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:21:44,528 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:21:44,528 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:21:44,528 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:21:44,528 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:21:44,528 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:21:44,528 - validate - INFO - print schema done, go forward....
2024-02-13 15:21:44,528 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:21:44,529 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:21:44,530 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:21:44,530 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:21:44,530 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:21:44,530 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:21:44,530 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:21:44,530 - validate - INFO - print schema done, go forward....
2024-02-13 15:21:44,635 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:21:44,635 - root - INFO - transformation data processing....
2024-02-13 15:21:44,635 - root - INFO - displaying the df_report_1
2024-02-13 15:21:44,635 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:21:44,636 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:21:44,666 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:21:44,698 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:21:44,737 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:21:44,738 - root - INFO - display data_report2 method...
2024-02-13 15:21:44,738 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:21:44,738 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:21:44,829 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:21:51,188 - root - INFO - extracting files output....
2024-02-13 15:21:51,188 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:21:57,388 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:21:57,468 - root - INFO - show read data spark...
2024-02-13 15:22:02,183 - root - INFO - writing into have table
2024-02-13 15:24:18,655 - root - INFO - i am the main method...
2024-02-13 15:24:18,655 - root - INFO - calling spark object
2024-02-13 15:24:18,656 - create_spark - INFO - get_spark_object method started
2024-02-13 15:24:18,656 - create_spark - INFO - master is local
2024-02-13 15:24:21,795 - create_spark - INFO - Spark object create....
2024-02-13 15:24:21,795 - root - INFO - Validating spark object.......
2024-02-13 15:24:21,796 - validate - WARNING - started the get_current_date method...
2024-02-13 15:24:24,200 - validate - WARNING - Validation done, go forward...
2024-02-13 15:24:24,200 - root - INFO - Reading file which is of > parquet
2024-02-13 15:24:24,200 - infest - WARNING - Load_file method started...
2024-02-13 15:24:24,645 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:24:24,648 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:24:25,951 - root - INFO - validating the dataframe...
2024-02-13 15:24:25,951 - infest - WARNING - here to count the records in the df
2024-02-13 15:24:26,347 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:24:26,348 - infest - WARNING - Load_file method started...
2024-02-13 15:24:26,756 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:24:26,758 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:24:26,973 - root - INFO - validating the dataframe...
2024-02-13 15:24:26,973 - infest - WARNING - here to count the records in the df
2024-02-13 15:24:27,525 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:24:27,525 - root - INFO - implementing data processing...
2024-02-13 15:24:27,525 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:24:27,525 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:24:27,552 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:24:27,566 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:24:27,575 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:24:27,603 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:24:27,616 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:24:27,616 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:24:27,633 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:24:29,820 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:24:29,821 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:24:29,821 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:24:30,051 - root - INFO - validating schema for dataframe....
2024-02-13 15:24:30,051 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:24:30,052 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:24:30,052 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:24:30,052 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:24:30,052 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:24:30,052 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:24:30,052 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:24:30,052 - validate - INFO - print schema done, go forward....
2024-02-13 15:24:30,052 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:24:30,053 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:24:30,053 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:24:30,053 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:24:30,053 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:24:30,053 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:24:30,053 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:24:30,054 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:24:30,054 - validate - INFO - print schema done, go forward....
2024-02-13 15:24:30,164 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:24:30,164 - root - INFO - transformation data processing....
2024-02-13 15:24:30,164 - root - INFO - displaying the df_report_1
2024-02-13 15:24:30,164 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:24:30,165 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:24:30,192 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:24:30,222 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:24:30,261 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:24:30,261 - root - INFO - display data_report2 method...
2024-02-13 15:24:30,261 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:24:30,261 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:24:30,339 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:24:36,387 - root - INFO - extracting files output....
2024-02-13 15:24:36,387 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:24:42,547 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:24:42,635 - root - INFO - show read data spark...
2024-02-13 15:24:47,277 - root - INFO - writing into have table
2024-02-13 15:25:12,794 - root - INFO - i am the main method...
2024-02-13 15:25:12,794 - root - INFO - calling spark object
2024-02-13 15:25:12,794 - create_spark - INFO - get_spark_object method started
2024-02-13 15:25:12,794 - create_spark - INFO - master is local
2024-02-13 15:25:15,864 - create_spark - INFO - Spark object create....
2024-02-13 15:25:15,864 - root - INFO - Validating spark object.......
2024-02-13 15:25:15,865 - validate - WARNING - started the get_current_date method...
2024-02-13 15:25:18,273 - validate - WARNING - Validation done, go forward...
2024-02-13 15:25:18,273 - root - INFO - Reading file which is of > parquet
2024-02-13 15:25:18,274 - infest - WARNING - Load_file method started...
2024-02-13 15:25:18,714 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:25:18,717 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:25:20,048 - root - INFO - validating the dataframe...
2024-02-13 15:25:20,048 - infest - WARNING - here to count the records in the df
2024-02-13 15:25:20,407 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:25:20,407 - infest - WARNING - Load_file method started...
2024-02-13 15:25:20,747 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:25:20,748 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:25:20,940 - root - INFO - validating the dataframe...
2024-02-13 15:25:20,940 - infest - WARNING - here to count the records in the df
2024-02-13 15:25:21,517 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:25:21,518 - root - INFO - implementing data processing...
2024-02-13 15:25:21,518 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:25:21,518 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:25:21,549 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:25:21,565 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:25:21,575 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:25:21,605 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:25:21,619 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:25:21,620 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:25:21,637 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:25:23,933 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:25:23,934 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:25:23,934 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:25:24,306 - root - INFO - validating schema for dataframe....
2024-02-13 15:25:24,306 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:25:24,307 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:25:24,307 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:25:24,307 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:25:24,308 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:25:24,308 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:25:24,308 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:25:24,308 - validate - INFO - print schema done, go forward....
2024-02-13 15:25:24,308 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:25:24,309 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:25:24,309 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:25:24,309 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:25:24,310 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:25:24,310 - validate - INFO - print schema done, go forward....
2024-02-13 15:25:24,449 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:25:24,449 - root - INFO - transformation data processing....
2024-02-13 15:25:24,449 - root - INFO - displaying the df_report_1
2024-02-13 15:25:24,449 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:25:24,450 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:25:24,491 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:25:24,538 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:25:24,591 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:25:24,591 - root - INFO - display data_report2 method...
2024-02-13 15:25:24,591 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:25:24,591 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:25:24,665 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:25:31,226 - root - INFO - extracting files output....
2024-02-13 15:25:31,227 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:25:37,630 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:25:37,727 - root - INFO - show read data spark...
2024-02-13 15:25:42,821 - root - INFO - writing into have table
2024-02-13 15:29:30,263 - root - INFO - i am the main method...
2024-02-13 15:29:30,263 - root - INFO - calling spark object
2024-02-13 15:29:30,263 - create_spark - INFO - get_spark_object method started
2024-02-13 15:29:30,263 - create_spark - INFO - master is local
2024-02-13 15:29:33,277 - create_spark - INFO - Spark object create....
2024-02-13 15:29:33,278 - root - INFO - Validating spark object.......
2024-02-13 15:29:33,278 - validate - WARNING - started the get_current_date method...
2024-02-13 15:29:35,698 - validate - WARNING - Validation done, go forward...
2024-02-13 15:29:35,698 - root - INFO - Reading file which is of > parquet
2024-02-13 15:29:35,698 - infest - WARNING - Load_file method started...
2024-02-13 15:29:36,169 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:29:36,172 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:29:37,510 - root - INFO - validating the dataframe...
2024-02-13 15:29:37,510 - infest - WARNING - here to count the records in the df
2024-02-13 15:29:37,900 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:29:37,900 - infest - WARNING - Load_file method started...
2024-02-13 15:29:38,281 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:29:38,283 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:29:38,489 - root - INFO - validating the dataframe...
2024-02-13 15:29:38,489 - infest - WARNING - here to count the records in the df
2024-02-13 15:29:39,092 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:29:39,093 - root - INFO - implementing data processing...
2024-02-13 15:29:39,093 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:29:39,093 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:29:39,129 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:29:39,145 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:29:39,155 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:29:39,182 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:29:39,196 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:29:39,196 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:29:39,214 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:29:41,454 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:29:41,454 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:29:41,454 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:29:41,726 - root - INFO - validating schema for dataframe....
2024-02-13 15:29:41,726 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:29:41,727 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:29:41,727 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:29:41,727 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:29:41,728 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:29:41,728 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:29:41,728 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:29:41,728 - validate - INFO - print schema done, go forward....
2024-02-13 15:29:41,728 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:29:41,729 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:29:41,729 - validate - INFO - print schema done, go forward....
2024-02-13 15:29:41,833 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:29:41,833 - root - INFO - transformation data processing....
2024-02-13 15:29:41,833 - root - INFO - displaying the df_report_1
2024-02-13 15:29:41,833 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:29:41,834 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:29:41,861 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:29:41,891 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:29:41,934 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:29:41,934 - root - INFO - display data_report2 method...
2024-02-13 15:29:41,935 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:29:41,935 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:29:42,019 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:29:48,636 - root - INFO - extracting files output....
2024-02-13 15:29:48,636 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:29:55,475 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:29:55,565 - root - INFO - show read data spark...
2024-02-13 15:30:00,823 - root - INFO - writing into have table
2024-02-13 15:31:50,207 - root - INFO - i am the main method...
2024-02-13 15:31:50,207 - root - INFO - calling spark object
2024-02-13 15:31:50,207 - create_spark - INFO - get_spark_object method started
2024-02-13 15:31:50,207 - create_spark - INFO - master is local
2024-02-13 15:31:53,267 - create_spark - INFO - Spark object create....
2024-02-13 15:31:53,267 - root - INFO - Validating spark object.......
2024-02-13 15:31:53,267 - validate - WARNING - started the get_current_date method...
2024-02-13 15:31:55,808 - validate - WARNING - Validation done, go forward...
2024-02-13 15:31:55,808 - root - INFO - Reading file which is of > parquet
2024-02-13 15:31:55,808 - infest - WARNING - Load_file method started...
2024-02-13 15:31:56,263 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:31:56,266 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:31:57,581 - root - INFO - validating the dataframe...
2024-02-13 15:31:57,581 - infest - WARNING - here to count the records in the df
2024-02-13 15:31:57,944 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:31:57,944 - infest - WARNING - Load_file method started...
2024-02-13 15:31:58,330 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:31:58,332 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:31:58,517 - root - INFO - validating the dataframe...
2024-02-13 15:31:58,517 - infest - WARNING - here to count the records in the df
2024-02-13 15:31:59,031 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:31:59,031 - root - INFO - implementing data processing...
2024-02-13 15:31:59,032 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:31:59,032 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:31:59,064 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:31:59,078 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:31:59,087 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:31:59,115 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:31:59,128 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:31:59,128 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:31:59,143 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:32:01,298 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:32:01,298 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:32:01,298 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:32:01,532 - root - INFO - validating schema for dataframe....
2024-02-13 15:32:01,532 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:32:01,533 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:32:01,533 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:32:01,533 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:32:01,533 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:32:01,533 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:32:01,533 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:32:01,533 - validate - INFO - print schema done, go forward....
2024-02-13 15:32:01,533 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:32:01,534 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:32:01,535 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:32:01,535 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:32:01,535 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:32:01,535 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:32:01,535 - validate - INFO - print schema done, go forward....
2024-02-13 15:32:01,630 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:32:01,630 - root - INFO - transformation data processing....
2024-02-13 15:32:01,630 - root - INFO - displaying the df_report_1
2024-02-13 15:32:01,630 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:32:01,630 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:32:01,656 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:32:01,685 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:32:01,725 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:32:01,725 - root - INFO - display data_report2 method...
2024-02-13 15:32:01,725 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:32:01,725 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:32:01,793 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:32:08,092 - root - INFO - extracting files output....
2024-02-13 15:32:08,092 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:32:14,151 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:32:14,230 - root - INFO - show read data spark...
2024-02-13 15:32:19,200 - root - INFO - writing into have table
2024-02-13 15:32:30,495 - root - INFO - successfully written into Hive
2024-02-13 15:32:30,496 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:32:37,430 - root - INFO - total amount of time taken: 47.223660100018606 seconds...
2024-02-13 15:32:37,430 - root - INFO - Application done
2024-02-13 15:33:47,010 - root - INFO - i am the main method...
2024-02-13 15:33:47,010 - root - INFO - calling spark object
2024-02-13 15:33:47,010 - create_spark - INFO - get_spark_object method started
2024-02-13 15:33:47,010 - create_spark - INFO - master is local
2024-02-13 15:33:49,938 - create_spark - INFO - Spark object create....
2024-02-13 15:33:49,938 - root - INFO - Validating spark object.......
2024-02-13 15:33:49,938 - validate - WARNING - started the get_current_date method...
2024-02-13 15:33:52,289 - validate - WARNING - Validation done, go forward...
2024-02-13 15:33:52,289 - root - INFO - Reading file which is of > parquet
2024-02-13 15:33:52,289 - infest - WARNING - Load_file method started...
2024-02-13 15:33:52,733 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:33:52,736 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:33:54,009 - root - INFO - validating the dataframe...
2024-02-13 15:33:54,009 - infest - WARNING - here to count the records in the df
2024-02-13 15:33:54,359 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:33:54,359 - infest - WARNING - Load_file method started...
2024-02-13 15:33:54,728 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:33:54,730 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:33:54,927 - root - INFO - validating the dataframe...
2024-02-13 15:33:54,927 - infest - WARNING - here to count the records in the df
2024-02-13 15:33:55,471 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:33:55,471 - root - INFO - implementing data processing...
2024-02-13 15:33:55,471 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:33:55,471 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:33:55,499 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:33:55,513 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:33:55,523 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:33:55,551 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:33:55,566 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:33:55,566 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:33:55,583 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:33:57,741 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:33:57,741 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:33:57,741 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:33:57,973 - root - INFO - validating schema for dataframe....
2024-02-13 15:33:57,973 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:33:57,974 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:33:57,974 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:33:57,974 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:33:57,974 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:33:57,974 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:33:57,974 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:33:57,974 - validate - INFO - print schema done, go forward....
2024-02-13 15:33:57,974 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:33:57,975 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:33:57,975 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:33:57,975 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:33:57,975 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:33:57,975 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:33:57,976 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:33:57,976 - validate - INFO - print schema done, go forward....
2024-02-13 15:33:58,077 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:33:58,077 - root - INFO - transformation data processing....
2024-02-13 15:33:58,077 - root - INFO - displaying the df_report_1
2024-02-13 15:33:58,077 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:33:58,078 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:33:58,102 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:33:58,129 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:33:58,159 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:33:58,159 - root - INFO - display data_report2 method...
2024-02-13 15:33:58,160 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:33:58,160 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:33:58,223 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:34:04,349 - root - INFO - extracting files output....
2024-02-13 15:34:04,349 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:34:10,326 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:34:10,403 - root - INFO - show read data spark...
2024-02-13 15:34:14,973 - root - INFO - writing into have table
2024-02-13 15:34:26,323 - root - INFO - successfully written into Hive
2024-02-13 15:34:26,323 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:34:46,963 - root - INFO - i am the main method...
2024-02-13 15:34:46,963 - root - INFO - calling spark object
2024-02-13 15:34:46,963 - create_spark - INFO - get_spark_object method started
2024-02-13 15:34:46,964 - create_spark - INFO - master is local
2024-02-13 15:34:49,933 - create_spark - INFO - Spark object create....
2024-02-13 15:34:49,933 - root - INFO - Validating spark object.......
2024-02-13 15:34:49,933 - validate - WARNING - started the get_current_date method...
2024-02-13 15:34:52,352 - validate - WARNING - Validation done, go forward...
2024-02-13 15:34:52,352 - root - INFO - Reading file which is of > parquet
2024-02-13 15:34:52,352 - infest - WARNING - Load_file method started...
2024-02-13 15:34:52,789 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:34:52,792 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:34:54,068 - root - INFO - validating the dataframe...
2024-02-13 15:34:54,068 - infest - WARNING - here to count the records in the df
2024-02-13 15:34:54,448 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:34:54,448 - infest - WARNING - Load_file method started...
2024-02-13 15:34:54,819 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:34:54,821 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:34:55,009 - root - INFO - validating the dataframe...
2024-02-13 15:34:55,009 - infest - WARNING - here to count the records in the df
2024-02-13 15:34:55,529 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:34:55,529 - root - INFO - implementing data processing...
2024-02-13 15:34:55,529 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:34:55,529 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:34:55,556 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:34:55,572 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:34:55,581 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:34:55,609 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:34:55,623 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:34:55,623 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:34:55,641 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:34:57,859 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:34:57,859 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:34:57,859 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:34:58,082 - root - INFO - validating schema for dataframe....
2024-02-13 15:34:58,082 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:34:58,083 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:34:58,083 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:34:58,083 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:34:58,083 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:34:58,083 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:34:58,083 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:34:58,083 - validate - INFO - print schema done, go forward....
2024-02-13 15:34:58,083 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:34:58,084 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:34:58,084 - validate - INFO - print schema done, go forward....
2024-02-13 15:34:58,185 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:34:58,185 - root - INFO - transformation data processing....
2024-02-13 15:34:58,185 - root - INFO - displaying the df_report_1
2024-02-13 15:34:58,185 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:34:58,186 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:34:58,217 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:34:58,249 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:34:58,288 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:34:58,288 - root - INFO - display data_report2 method...
2024-02-13 15:34:58,288 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:34:58,288 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:34:58,360 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:35:04,436 - root - INFO - extracting files output....
2024-02-13 15:35:04,436 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:35:10,388 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:35:10,466 - root - INFO - show read data spark...
2024-02-13 15:35:15,015 - root - INFO - writing into have table
2024-02-13 15:35:25,039 - root - INFO - successfully written into Hive
2024-02-13 15:35:25,039 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:35:31,186 - root - INFO - total amount of time taken: 44.22235769999679 seconds...
2024-02-13 15:35:31,186 - root - INFO - Application done
2024-02-13 15:41:13,405 - root - INFO - i am the main method...
2024-02-13 15:41:13,406 - root - INFO - calling spark object
2024-02-13 15:41:13,406 - create_spark - INFO - get_spark_object method started
2024-02-13 15:41:13,406 - create_spark - INFO - master is local
2024-02-13 15:41:16,484 - create_spark - INFO - Spark object create....
2024-02-13 15:41:16,484 - root - INFO - Validating spark object.......
2024-02-13 15:41:16,484 - validate - WARNING - started the get_current_date method...
2024-02-13 15:41:18,986 - validate - WARNING - Validation done, go forward...
2024-02-13 15:41:18,987 - root - INFO - Reading file which is of > parquet
2024-02-13 15:41:18,987 - infest - WARNING - Load_file method started...
2024-02-13 15:41:19,451 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:41:19,454 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:41:20,761 - root - INFO - validating the dataframe...
2024-02-13 15:41:20,761 - infest - WARNING - here to count the records in the df
2024-02-13 15:41:21,137 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:41:21,137 - infest - WARNING - Load_file method started...
2024-02-13 15:41:21,497 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:41:21,499 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:41:21,684 - root - INFO - validating the dataframe...
2024-02-13 15:41:21,684 - infest - WARNING - here to count the records in the df
2024-02-13 15:41:22,196 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:41:22,196 - root - INFO - implementing data processing...
2024-02-13 15:41:22,196 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:41:22,196 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:41:22,223 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:41:22,237 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:41:22,246 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:41:22,275 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:41:22,289 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:41:22,289 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:41:22,305 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:41:24,549 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:41:24,549 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:41:24,549 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:41:24,802 - root - INFO - validating schema for dataframe....
2024-02-13 15:41:24,802 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:41:24,803 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:41:24,803 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:41:24,803 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:41:24,803 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:41:24,803 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:41:24,803 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:41:24,803 - validate - INFO - print schema done, go forward....
2024-02-13 15:41:24,803 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:41:24,804 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:41:24,804 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:41:24,804 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:41:24,804 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:41:24,804 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:41:24,805 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:41:24,805 - validate - INFO - print schema done, go forward....
2024-02-13 15:41:24,914 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:41:24,914 - root - INFO - transformation data processing....
2024-02-13 15:41:24,914 - root - INFO - displaying the df_report_1
2024-02-13 15:41:24,914 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:41:24,915 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:41:24,942 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:41:24,971 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:41:25,006 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:41:25,007 - root - INFO - display data_report2 method...
2024-02-13 15:41:25,007 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:41:25,007 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:41:25,075 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:41:31,727 - root - INFO - extracting files output....
2024-02-13 15:41:31,728 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:41:38,317 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:41:38,388 - root - INFO - show read data spark...
2024-02-13 15:41:43,426 - root - INFO - writing into have table
2024-02-13 15:41:55,776 - root - INFO - successfully written into Hive
2024-02-13 15:41:55,777 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 15:43:42,537 - root - INFO - i am the main method...
2024-02-13 15:43:42,538 - root - INFO - calling spark object
2024-02-13 15:43:42,538 - create_spark - INFO - get_spark_object method started
2024-02-13 15:43:42,538 - create_spark - INFO - master is local
2024-02-13 15:43:45,726 - create_spark - INFO - Spark object create....
2024-02-13 15:43:45,726 - root - INFO - Validating spark object.......
2024-02-13 15:43:45,726 - validate - WARNING - started the get_current_date method...
2024-02-13 15:43:48,255 - validate - WARNING - Validation done, go forward...
2024-02-13 15:43:48,255 - root - INFO - Reading file which is of > parquet
2024-02-13 15:43:48,255 - infest - WARNING - Load_file method started...
2024-02-13 15:43:48,717 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 15:43:48,720 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 15:43:50,202 - root - INFO - validating the dataframe...
2024-02-13 15:43:50,202 - infest - WARNING - here to count the records in the df
2024-02-13 15:43:50,583 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 15:43:50,583 - infest - WARNING - Load_file method started...
2024-02-13 15:43:50,930 - infest - WARNING - dataframe created  which is if csv
2024-02-13 15:43:50,932 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 15:43:51,134 - root - INFO - validating the dataframe...
2024-02-13 15:43:51,134 - infest - WARNING - here to count the records in the df
2024-02-13 15:43:51,685 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 15:43:51,686 - root - INFO - implementing data processing...
2024-02-13 15:43:51,686 - data_processing - WARNING - data_clean method() stating....
2024-02-13 15:43:51,686 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 15:43:51,712 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 15:43:51,726 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 15:43:51,735 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 15:43:51,762 - data_processing - WARNING - concat firstName and lastName
2024-02-13 15:43:51,776 - data_processing - WARNING - now check for null values in all column
2024-02-13 15:43:51,776 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 15:43:51,792 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 15:43:54,085 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 15:43:54,085 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 15:43:54,085 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 15:43:54,349 - root - INFO - validating schema for dataframe....
2024-02-13 15:43:54,349 - validate - WARNING - printing schema method starting... df_city
2024-02-13 15:43:54,350 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 15:43:54,350 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 15:43:54,350 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 15:43:54,350 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 15:43:54,350 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 15:43:54,350 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 15:43:54,350 - validate - INFO - print schema done, go forward....
2024-02-13 15:43:54,350 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 15:43:54,351 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 15:43:54,352 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 15:43:54,352 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 15:43:54,352 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 15:43:54,352 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 15:43:54,352 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 15:43:54,352 - validate - INFO - print schema done, go forward....
2024-02-13 15:43:54,463 - root - INFO - checking null values schema for dataframe....
2024-02-13 15:43:54,463 - root - INFO - transformation data processing....
2024-02-13 15:43:54,463 - root - INFO - displaying the df_report_1
2024-02-13 15:43:54,463 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 15:43:54,464 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 15:43:54,495 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 15:43:54,526 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 15:43:54,569 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 15:43:54,570 - root - INFO - display data_report2 method...
2024-02-13 15:43:54,570 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 15:43:54,570 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 15:43:54,655 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 15:44:00,958 - root - INFO - extracting files output....
2024-02-13 15:44:00,958 - extraction - WARNING - extracting_file method starting....
2024-02-13 15:44:07,252 - extraction - WARNING - extract_file method successfully...
2024-02-13 15:44:07,327 - root - INFO - show read data spark...
2024-02-13 15:44:12,052 - root - INFO - writing into have table
2024-02-13 15:44:12,052 - root - INFO - successfully written into Hive
2024-02-13 15:44:12,053 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 16:24:40,450 - root - INFO - i am the main method...
2024-02-13 16:24:40,451 - root - INFO - calling spark object
2024-02-13 16:24:40,451 - create_spark - INFO - get_spark_object method started
2024-02-13 16:24:40,451 - create_spark - INFO - master is local
2024-02-13 16:24:44,323 - create_spark - INFO - Spark object create....
2024-02-13 16:24:44,323 - root - INFO - Validating spark object.......
2024-02-13 16:24:44,323 - validate - WARNING - started the get_current_date method...
2024-02-13 16:24:46,760 - validate - WARNING - Validation done, go forward...
2024-02-13 16:24:46,760 - root - INFO - Reading file which is of > parquet
2024-02-13 16:24:46,761 - infest - WARNING - Load_file method started...
2024-02-13 16:24:47,231 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 16:24:47,234 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 16:24:48,751 - root - INFO - validating the dataframe...
2024-02-13 16:24:48,751 - infest - WARNING - here to count the records in the df
2024-02-13 16:24:49,307 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 16:24:49,307 - infest - WARNING - Load_file method started...
2024-02-13 16:24:49,760 - infest - WARNING - dataframe created  which is if csv
2024-02-13 16:24:49,762 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 16:24:49,979 - root - INFO - validating the dataframe...
2024-02-13 16:24:49,979 - infest - WARNING - here to count the records in the df
2024-02-13 16:24:50,593 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 16:24:50,593 - root - INFO - implementing data processing...
2024-02-13 16:24:50,593 - data_processing - WARNING - data_clean method() stating....
2024-02-13 16:24:50,593 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 16:24:50,618 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 16:24:50,631 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 16:24:50,639 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 16:24:50,663 - data_processing - WARNING - concat firstName and lastName
2024-02-13 16:24:50,676 - data_processing - WARNING - now check for null values in all column
2024-02-13 16:24:50,676 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 16:24:50,690 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 16:24:52,905 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 16:24:52,905 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 16:24:52,905 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 16:24:53,184 - root - INFO - validating schema for dataframe....
2024-02-13 16:24:53,184 - validate - WARNING - printing schema method starting... df_city
2024-02-13 16:24:53,185 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 16:24:53,186 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 16:24:53,186 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 16:24:53,186 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 16:24:53,186 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 16:24:53,186 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 16:24:53,186 - validate - INFO - print schema done, go forward....
2024-02-13 16:24:53,186 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 16:24:53,187 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 16:24:53,188 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 16:24:53,188 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 16:24:53,188 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 16:24:53,188 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 16:24:53,188 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 16:24:53,188 - validate - INFO - print schema done, go forward....
2024-02-13 16:24:53,298 - root - INFO - checking null values schema for dataframe....
2024-02-13 16:24:53,298 - root - INFO - transformation data processing....
2024-02-13 16:24:53,298 - root - INFO - displaying the df_report_1
2024-02-13 16:24:53,298 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 16:24:53,299 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 16:24:53,331 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 16:24:53,366 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 16:24:53,411 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 16:24:53,411 - root - INFO - display data_report2 method...
2024-02-13 16:24:53,411 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 16:24:53,411 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 16:24:53,507 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 16:24:59,911 - root - INFO - extracting files output....
2024-02-13 16:24:59,911 - extraction - WARNING - extracting_file method starting....
2024-02-13 16:25:06,201 - extraction - WARNING - extract_file method successfully...
2024-02-13 16:25:06,287 - root - INFO - show read data spark...
2024-02-13 16:25:11,506 - root - INFO - writing into have table
2024-02-13 16:25:11,506 - root - INFO - successfully written into Hive
2024-02-13 16:25:11,507 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 16:27:22,688 - root - INFO - i am the main method...
2024-02-13 16:27:22,688 - root - INFO - calling spark object
2024-02-13 16:27:22,688 - create_spark - INFO - get_spark_object method started
2024-02-13 16:27:22,688 - create_spark - INFO - master is local
2024-02-13 16:27:26,139 - create_spark - INFO - Spark object create....
2024-02-13 16:27:26,140 - root - INFO - Validating spark object.......
2024-02-13 16:27:26,140 - validate - WARNING - started the get_current_date method...
2024-02-13 16:27:28,647 - validate - WARNING - Validation done, go forward...
2024-02-13 16:27:28,648 - root - INFO - Reading file which is of > parquet
2024-02-13 16:27:28,648 - infest - WARNING - Load_file method started...
2024-02-13 16:27:29,177 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 16:27:29,182 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 16:27:30,548 - root - INFO - validating the dataframe...
2024-02-13 16:27:30,548 - infest - WARNING - here to count the records in the df
2024-02-13 16:27:30,932 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 16:27:30,933 - infest - WARNING - Load_file method started...
2024-02-13 16:27:31,331 - infest - WARNING - dataframe created  which is if csv
2024-02-13 16:27:31,332 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 16:27:31,555 - root - INFO - validating the dataframe...
2024-02-13 16:27:31,555 - infest - WARNING - here to count the records in the df
2024-02-13 16:27:32,196 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 16:27:32,196 - root - INFO - implementing data processing...
2024-02-13 16:27:32,197 - data_processing - WARNING - data_clean method() stating....
2024-02-13 16:27:32,197 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 16:27:32,222 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 16:27:32,237 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 16:27:32,245 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 16:27:32,272 - data_processing - WARNING - concat firstName and lastName
2024-02-13 16:27:32,286 - data_processing - WARNING - now check for null values in all column
2024-02-13 16:27:32,286 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 16:27:32,303 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 16:27:34,473 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 16:27:34,473 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 16:27:34,473 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 16:27:34,710 - root - INFO - validating schema for dataframe....
2024-02-13 16:27:34,710 - validate - WARNING - printing schema method starting... df_city
2024-02-13 16:27:34,711 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 16:27:34,711 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 16:27:34,711 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 16:27:34,711 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 16:27:34,711 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 16:27:34,711 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 16:27:34,711 - validate - INFO - print schema done, go forward....
2024-02-13 16:27:34,711 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 16:27:34,712 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 16:27:34,712 - validate - INFO - print schema done, go forward....
2024-02-13 16:27:34,815 - root - INFO - checking null values schema for dataframe....
2024-02-13 16:27:34,815 - root - INFO - transformation data processing....
2024-02-13 16:27:34,815 - root - INFO - displaying the df_report_1
2024-02-13 16:27:34,815 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 16:27:34,816 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 16:27:34,845 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 16:27:34,876 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 16:27:34,911 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 16:27:34,911 - root - INFO - display data_report2 method...
2024-02-13 16:27:34,911 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 16:27:34,911 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 16:27:35,019 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 16:27:41,460 - root - INFO - extracting files output....
2024-02-13 16:27:41,460 - extraction - WARNING - extracting_file method starting....
2024-02-13 16:27:48,064 - extraction - WARNING - extract_file method successfully...
2024-02-13 16:27:48,145 - root - INFO - show read data spark...
2024-02-13 16:27:53,231 - root - INFO - writing into have table
2024-02-13 16:27:53,231 - root - INFO - successfully written into Hive
2024-02-13 16:27:53,232 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 16:31:21,836 - root - INFO - i am the main method...
2024-02-13 16:31:21,836 - root - INFO - calling spark object
2024-02-13 16:31:21,836 - create_spark - INFO - get_spark_object method started
2024-02-13 16:31:21,836 - create_spark - INFO - master is local
2024-02-13 16:31:24,790 - create_spark - INFO - Spark object create....
2024-02-13 16:31:24,790 - root - INFO - Validating spark object.......
2024-02-13 16:31:24,790 - validate - WARNING - started the get_current_date method...
2024-02-13 16:31:27,190 - validate - WARNING - Validation done, go forward...
2024-02-13 16:31:27,191 - root - INFO - Reading file which is of > parquet
2024-02-13 16:31:27,191 - infest - WARNING - Load_file method started...
2024-02-13 16:31:27,632 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 16:31:27,635 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 16:31:28,918 - root - INFO - validating the dataframe...
2024-02-13 16:31:28,918 - infest - WARNING - here to count the records in the df
2024-02-13 16:31:29,280 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 16:31:29,280 - infest - WARNING - Load_file method started...
2024-02-13 16:31:29,617 - infest - WARNING - dataframe created  which is if csv
2024-02-13 16:31:29,619 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 16:31:29,797 - root - INFO - validating the dataframe...
2024-02-13 16:31:29,797 - infest - WARNING - here to count the records in the df
2024-02-13 16:31:30,404 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 16:31:30,404 - root - INFO - implementing data processing...
2024-02-13 16:31:30,404 - data_processing - WARNING - data_clean method() stating....
2024-02-13 16:31:30,404 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 16:31:30,430 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 16:31:30,444 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 16:31:30,452 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 16:31:30,479 - data_processing - WARNING - concat firstName and lastName
2024-02-13 16:31:30,492 - data_processing - WARNING - now check for null values in all column
2024-02-13 16:31:30,492 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 16:31:30,507 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 16:31:32,733 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 16:31:32,733 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 16:31:32,734 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 16:31:32,977 - root - INFO - validating schema for dataframe....
2024-02-13 16:31:32,977 - validate - WARNING - printing schema method starting... df_city
2024-02-13 16:31:32,978 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 16:31:32,978 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 16:31:32,978 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 16:31:32,978 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 16:31:32,978 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 16:31:32,978 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 16:31:32,978 - validate - INFO - print schema done, go forward....
2024-02-13 16:31:32,978 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 16:31:32,979 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 16:31:32,980 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 16:31:32,980 - validate - INFO - print schema done, go forward....
2024-02-13 16:31:33,093 - root - INFO - checking null values schema for dataframe....
2024-02-13 16:31:33,093 - root - INFO - transformation data processing....
2024-02-13 16:31:33,093 - root - INFO - displaying the df_report_1
2024-02-13 16:31:33,093 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 16:31:33,094 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 16:31:33,124 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 16:31:33,154 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 16:31:33,193 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 16:31:33,193 - root - INFO - display data_report2 method...
2024-02-13 16:31:33,193 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 16:31:33,193 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 16:31:33,273 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 16:31:39,544 - root - INFO - extracting files output....
2024-02-13 16:31:39,544 - extraction - WARNING - extracting_file method starting....
2024-02-13 16:31:46,024 - extraction - WARNING - extract_file method successfully...
2024-02-13 16:31:46,108 - root - INFO - show read data spark...
2024-02-13 16:31:50,811 - root - INFO - writing into have table
2024-02-13 16:31:50,811 - root - INFO - successfully written into Hive
2024-02-13 16:31:50,812 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 16:32:02,997 - root - INFO - i am the main method...
2024-02-13 16:32:02,997 - root - INFO - calling spark object
2024-02-13 16:32:02,997 - create_spark - INFO - get_spark_object method started
2024-02-13 16:32:02,997 - create_spark - INFO - master is local
2024-02-13 16:32:06,194 - create_spark - INFO - Spark object create....
2024-02-13 16:32:06,194 - root - INFO - Validating spark object.......
2024-02-13 16:32:06,194 - validate - WARNING - started the get_current_date method...
2024-02-13 16:32:08,662 - validate - WARNING - Validation done, go forward...
2024-02-13 16:32:08,662 - root - INFO - Reading file which is of > parquet
2024-02-13 16:32:08,662 - infest - WARNING - Load_file method started...
2024-02-13 16:32:09,123 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 16:32:09,126 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 16:32:10,380 - root - INFO - validating the dataframe...
2024-02-13 16:32:10,380 - infest - WARNING - here to count the records in the df
2024-02-13 16:32:10,754 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 16:32:10,754 - infest - WARNING - Load_file method started...
2024-02-13 16:32:11,125 - infest - WARNING - dataframe created  which is if csv
2024-02-13 16:32:11,126 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 16:32:11,322 - root - INFO - validating the dataframe...
2024-02-13 16:32:11,322 - infest - WARNING - here to count the records in the df
2024-02-13 16:32:11,916 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 16:32:11,916 - root - INFO - implementing data processing...
2024-02-13 16:32:11,916 - data_processing - WARNING - data_clean method() stating....
2024-02-13 16:32:11,916 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 16:32:11,942 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 16:32:11,954 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 16:32:11,962 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 16:32:11,990 - data_processing - WARNING - concat firstName and lastName
2024-02-13 16:32:12,003 - data_processing - WARNING - now check for null values in all column
2024-02-13 16:32:12,003 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 16:32:12,019 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 16:32:14,183 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 16:32:14,183 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 16:32:14,183 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 16:32:14,423 - root - INFO - validating schema for dataframe....
2024-02-13 16:32:14,423 - validate - WARNING - printing schema method starting... df_city
2024-02-13 16:32:14,424 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 16:32:14,424 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 16:32:14,424 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 16:32:14,424 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 16:32:14,424 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 16:32:14,424 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 16:32:14,424 - validate - INFO - print schema done, go forward....
2024-02-13 16:32:14,424 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 16:32:14,425 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 16:32:14,426 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 16:32:14,426 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 16:32:14,426 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 16:32:14,426 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 16:32:14,426 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 16:32:14,426 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 16:32:14,426 - validate - INFO - print schema done, go forward....
2024-02-13 16:32:14,529 - root - INFO - checking null values schema for dataframe....
2024-02-13 16:32:14,529 - root - INFO - transformation data processing....
2024-02-13 16:32:14,529 - root - INFO - displaying the df_report_1
2024-02-13 16:32:14,529 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 16:32:14,530 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 16:32:14,555 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 16:32:14,585 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 16:32:14,621 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 16:32:14,621 - root - INFO - display data_report2 method...
2024-02-13 16:32:14,621 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 16:32:14,621 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 16:32:14,703 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 16:32:20,743 - root - INFO - extracting files output....
2024-02-13 16:32:20,743 - extraction - WARNING - extracting_file method starting....
2024-02-13 16:32:26,976 - extraction - WARNING - extract_file method successfully...
2024-02-13 16:32:27,057 - root - INFO - show read data spark...
2024-02-13 16:32:31,559 - root - INFO - writing into have table
2024-02-13 16:32:31,559 - root - INFO - successfully written into Hive
2024-02-13 16:32:31,560 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 16:41:00,909 - root - INFO - i am the main method...
2024-02-13 16:41:00,909 - root - INFO - calling spark object
2024-02-13 16:41:00,909 - create_spark - INFO - get_spark_object method started
2024-02-13 16:41:00,909 - create_spark - INFO - master is local
2024-02-13 16:41:04,059 - create_spark - INFO - Spark object create....
2024-02-13 16:41:04,060 - root - INFO - Validating spark object.......
2024-02-13 16:41:04,060 - validate - WARNING - started the get_current_date method...
2024-02-13 16:41:06,616 - validate - WARNING - Validation done, go forward...
2024-02-13 16:41:06,616 - root - INFO - Reading file which is of > parquet
2024-02-13 16:41:06,616 - infest - WARNING - Load_file method started...
2024-02-13 16:41:07,106 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 16:41:07,109 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 16:41:08,523 - root - INFO - validating the dataframe...
2024-02-13 16:41:08,523 - infest - WARNING - here to count the records in the df
2024-02-13 16:41:08,910 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 16:41:08,910 - infest - WARNING - Load_file method started...
2024-02-13 16:41:09,300 - infest - WARNING - dataframe created  which is if csv
2024-02-13 16:41:09,302 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 16:41:09,523 - root - INFO - validating the dataframe...
2024-02-13 16:41:09,523 - infest - WARNING - here to count the records in the df
2024-02-13 16:41:10,128 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 16:41:10,128 - root - INFO - implementing data processing...
2024-02-13 16:41:10,128 - data_processing - WARNING - data_clean method() stating....
2024-02-13 16:41:10,128 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 16:41:10,159 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 16:41:10,175 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 16:41:10,185 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 16:41:10,218 - data_processing - WARNING - concat firstName and lastName
2024-02-13 16:41:10,233 - data_processing - WARNING - now check for null values in all column
2024-02-13 16:41:10,233 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 16:41:10,251 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 16:41:12,454 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 16:41:12,454 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 16:41:12,454 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 16:41:12,764 - root - INFO - validating schema for dataframe....
2024-02-13 16:41:12,764 - validate - WARNING - printing schema method starting... df_city
2024-02-13 16:41:12,765 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 16:41:12,765 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 16:41:12,765 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 16:41:12,765 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 16:41:12,766 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 16:41:12,766 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 16:41:12,766 - validate - INFO - print schema done, go forward....
2024-02-13 16:41:12,766 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 16:41:12,767 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 16:41:12,767 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 16:41:12,767 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 16:41:12,768 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 16:41:12,768 - validate - INFO - print schema done, go forward....
2024-02-13 16:41:12,889 - root - INFO - checking null values schema for dataframe....
2024-02-13 16:41:12,889 - root - INFO - transformation data processing....
2024-02-13 16:41:12,889 - root - INFO - displaying the df_report_1
2024-02-13 16:41:12,889 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 16:41:12,890 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 16:41:12,926 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 16:41:12,960 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 16:41:13,004 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 16:41:13,004 - root - INFO - display data_report2 method...
2024-02-13 16:41:13,004 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 16:41:13,004 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 16:41:13,083 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 16:41:19,743 - root - INFO - extracting files output....
2024-02-13 16:41:19,743 - extraction - WARNING - extracting_file method starting....
2024-02-13 16:41:26,523 - extraction - WARNING - extract_file method successfully...
2024-02-13 16:41:26,615 - root - INFO - show read data spark...
2024-02-13 16:41:31,655 - root - INFO - writing into have table
2024-02-13 16:41:31,656 - root - INFO - successfully written into Hive
2024-02-13 16:41:31,656 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 16:41:50,397 - root - INFO - i am the main method...
2024-02-13 16:41:50,398 - root - INFO - calling spark object
2024-02-13 16:41:50,398 - create_spark - INFO - get_spark_object method started
2024-02-13 16:41:50,398 - create_spark - INFO - master is local
2024-02-13 16:41:53,465 - create_spark - INFO - Spark object create....
2024-02-13 16:41:53,466 - root - INFO - Validating spark object.......
2024-02-13 16:41:53,466 - validate - WARNING - started the get_current_date method...
2024-02-13 16:41:55,904 - validate - WARNING - Validation done, go forward...
2024-02-13 16:41:55,905 - root - INFO - Reading file which is of > parquet
2024-02-13 16:41:55,905 - infest - WARNING - Load_file method started...
2024-02-13 16:41:56,372 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 16:41:56,375 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 16:41:57,670 - root - INFO - validating the dataframe...
2024-02-13 16:41:57,670 - infest - WARNING - here to count the records in the df
2024-02-13 16:41:58,049 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 16:41:58,049 - infest - WARNING - Load_file method started...
2024-02-13 16:41:58,431 - infest - WARNING - dataframe created  which is if csv
2024-02-13 16:41:58,432 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 16:41:58,635 - root - INFO - validating the dataframe...
2024-02-13 16:41:58,635 - infest - WARNING - here to count the records in the df
2024-02-13 16:41:59,243 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 16:41:59,243 - root - INFO - implementing data processing...
2024-02-13 16:41:59,244 - data_processing - WARNING - data_clean method() stating....
2024-02-13 16:41:59,244 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 16:41:59,275 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 16:41:59,289 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 16:41:59,298 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 16:41:59,325 - data_processing - WARNING - concat firstName and lastName
2024-02-13 16:41:59,338 - data_processing - WARNING - now check for null values in all column
2024-02-13 16:41:59,339 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 16:41:59,353 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 16:42:01,546 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 16:42:01,546 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 16:42:01,546 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 16:42:01,786 - root - INFO - validating schema for dataframe....
2024-02-13 16:42:01,786 - validate - WARNING - printing schema method starting... df_city
2024-02-13 16:42:01,787 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 16:42:01,787 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 16:42:01,787 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 16:42:01,787 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 16:42:01,787 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 16:42:01,787 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 16:42:01,787 - validate - INFO - print schema done, go forward....
2024-02-13 16:42:01,787 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 16:42:01,788 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 16:42:01,788 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 16:42:01,788 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 16:42:01,788 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 16:42:01,788 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 16:42:01,789 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 16:42:01,789 - validate - INFO - print schema done, go forward....
2024-02-13 16:42:01,906 - root - INFO - checking null values schema for dataframe....
2024-02-13 16:42:01,906 - root - INFO - transformation data processing....
2024-02-13 16:42:01,906 - root - INFO - displaying the df_report_1
2024-02-13 16:42:01,906 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 16:42:01,907 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 16:42:01,935 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 16:42:01,966 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 16:42:02,009 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 16:42:02,009 - root - INFO - display data_report2 method...
2024-02-13 16:42:02,009 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 16:42:02,009 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 16:42:02,091 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 16:42:08,863 - root - INFO - extracting files output....
2024-02-13 16:42:08,863 - extraction - WARNING - extracting_file method starting....
2024-02-13 16:42:15,329 - extraction - WARNING - extract_file method successfully...
2024-02-13 16:42:15,403 - root - INFO - show read data spark...
2024-02-13 16:42:20,183 - root - INFO - writing into have table
2024-02-13 16:42:20,183 - root - INFO - successfully written into Hive
2024-02-13 16:42:20,184 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:13:19,664 - root - INFO - i am the main method...
2024-02-13 17:13:19,664 - root - INFO - calling spark object
2024-02-13 17:13:19,664 - create_spark - INFO - get_spark_object method started
2024-02-13 17:13:19,664 - create_spark - INFO - master is local
2024-02-13 17:13:23,888 - create_spark - INFO - Spark object create....
2024-02-13 17:13:23,888 - root - INFO - Validating spark object.......
2024-02-13 17:13:23,888 - validate - WARNING - started the get_current_date method...
2024-02-13 17:13:26,430 - validate - WARNING - Validation done, go forward...
2024-02-13 17:13:26,430 - root - INFO - Reading file which is of > parquet
2024-02-13 17:13:26,430 - infest - WARNING - Load_file method started...
2024-02-13 17:13:26,989 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:13:26,993 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:13:28,487 - root - INFO - validating the dataframe...
2024-02-13 17:13:28,487 - infest - WARNING - here to count the records in the df
2024-02-13 17:13:28,918 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:13:28,919 - infest - WARNING - Load_file method started...
2024-02-13 17:13:29,335 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:13:29,336 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:13:29,561 - root - INFO - validating the dataframe...
2024-02-13 17:13:29,561 - infest - WARNING - here to count the records in the df
2024-02-13 17:13:30,156 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:13:30,156 - root - INFO - implementing data processing...
2024-02-13 17:13:30,156 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:13:30,156 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:13:30,182 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:13:30,197 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:13:30,204 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:13:30,231 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:13:30,247 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:13:30,247 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:13:30,264 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:13:32,532 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:13:32,532 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:13:32,532 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:13:32,776 - root - INFO - validating schema for dataframe....
2024-02-13 17:13:32,776 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:13:32,777 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:13:32,777 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:13:32,777 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:13:32,777 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:13:32,777 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:13:32,778 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:13:32,778 - validate - INFO - print schema done, go forward....
2024-02-13 17:13:32,778 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:13:32,779 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:13:32,779 - validate - INFO - print schema done, go forward....
2024-02-13 17:13:32,889 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:13:32,889 - root - INFO - transformation data processing....
2024-02-13 17:13:32,889 - root - INFO - displaying the df_report_1
2024-02-13 17:13:32,889 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:13:32,890 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:13:32,918 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:13:32,949 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:13:32,988 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:13:32,989 - root - INFO - display data_report2 method...
2024-02-13 17:13:32,989 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:13:32,989 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:13:33,064 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:13:39,582 - root - INFO - extracting files output....
2024-02-13 17:13:39,582 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:13:46,015 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:13:46,100 - root - INFO - show read data spark...
2024-02-13 17:13:50,961 - root - INFO - writing into have table
2024-02-13 17:13:50,961 - root - INFO - successfully written into Hive
2024-02-13 17:13:50,962 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:16:08,230 - root - INFO - i am the main method...
2024-02-13 17:16:08,230 - root - INFO - calling spark object
2024-02-13 17:16:08,230 - create_spark - INFO - get_spark_object method started
2024-02-13 17:16:08,230 - create_spark - INFO - master is local
2024-02-13 17:16:11,215 - create_spark - INFO - Spark object create....
2024-02-13 17:16:11,215 - root - INFO - Validating spark object.......
2024-02-13 17:16:11,215 - validate - WARNING - started the get_current_date method...
2024-02-13 17:16:13,668 - validate - WARNING - Validation done, go forward...
2024-02-13 17:16:13,668 - root - INFO - Reading file which is of > parquet
2024-02-13 17:16:13,668 - infest - WARNING - Load_file method started...
2024-02-13 17:16:14,135 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:16:14,138 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:16:15,408 - root - INFO - validating the dataframe...
2024-02-13 17:16:15,408 - infest - WARNING - here to count the records in the df
2024-02-13 17:16:15,818 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:16:15,818 - infest - WARNING - Load_file method started...
2024-02-13 17:16:16,177 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:16:16,179 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:16:16,354 - root - INFO - validating the dataframe...
2024-02-13 17:16:16,354 - infest - WARNING - here to count the records in the df
2024-02-13 17:16:16,883 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:16:16,884 - root - INFO - implementing data processing...
2024-02-13 17:16:16,884 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:16:16,884 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:16:16,916 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:16:16,931 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:16:16,940 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:16:16,969 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:16:16,983 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:16:16,984 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:16:17,000 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:16:19,196 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:16:19,196 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:16:19,196 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:16:19,441 - root - INFO - validating schema for dataframe....
2024-02-13 17:16:19,441 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:16:19,442 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:16:19,442 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:16:19,442 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:16:19,443 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:16:19,443 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:16:19,443 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:16:19,443 - validate - INFO - print schema done, go forward....
2024-02-13 17:16:19,443 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:16:19,444 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:16:19,444 - validate - INFO - print schema done, go forward....
2024-02-13 17:16:19,555 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:16:19,555 - root - INFO - transformation data processing....
2024-02-13 17:16:19,555 - root - INFO - displaying the df_report_1
2024-02-13 17:16:19,555 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:16:19,556 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:16:19,591 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:16:19,621 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:16:19,661 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:16:19,661 - root - INFO - display data_report2 method...
2024-02-13 17:16:19,661 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:16:19,661 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:16:19,732 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:16:26,086 - root - INFO - extracting files output....
2024-02-13 17:16:26,086 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:16:32,412 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:16:32,490 - root - INFO - show read data spark...
2024-02-13 17:16:37,167 - root - INFO - writing into have table
2024-02-13 17:16:37,167 - root - INFO - successfully written into Hive
2024-02-13 17:16:37,169 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:16:55,191 - root - INFO - i am the main method...
2024-02-13 17:16:55,191 - root - INFO - calling spark object
2024-02-13 17:16:55,191 - create_spark - INFO - get_spark_object method started
2024-02-13 17:16:55,191 - create_spark - INFO - master is local
2024-02-13 17:16:58,140 - create_spark - INFO - Spark object create....
2024-02-13 17:16:58,140 - root - INFO - Validating spark object.......
2024-02-13 17:16:58,141 - validate - WARNING - started the get_current_date method...
2024-02-13 17:17:00,542 - validate - WARNING - Validation done, go forward...
2024-02-13 17:17:00,542 - root - INFO - Reading file which is of > parquet
2024-02-13 17:17:00,542 - infest - WARNING - Load_file method started...
2024-02-13 17:17:00,962 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:17:00,965 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:17:02,332 - root - INFO - validating the dataframe...
2024-02-13 17:17:02,332 - infest - WARNING - here to count the records in the df
2024-02-13 17:17:02,788 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:17:02,788 - infest - WARNING - Load_file method started...
2024-02-13 17:17:03,186 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:17:03,188 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:17:03,372 - root - INFO - validating the dataframe...
2024-02-13 17:17:03,372 - infest - WARNING - here to count the records in the df
2024-02-13 17:17:03,941 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:17:03,941 - root - INFO - implementing data processing...
2024-02-13 17:17:03,941 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:17:03,941 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:17:03,970 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:17:03,984 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:17:03,993 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:17:04,023 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:17:04,039 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:17:04,040 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:17:04,059 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:17:06,411 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:17:06,411 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:17:06,411 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:17:06,710 - root - INFO - validating schema for dataframe....
2024-02-13 17:17:06,710 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:17:06,711 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:17:06,711 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:17:06,711 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:17:06,711 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:17:06,711 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:17:06,712 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:17:06,712 - validate - INFO - print schema done, go forward....
2024-02-13 17:17:06,712 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:17:06,713 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:17:06,714 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:17:06,714 - validate - INFO - print schema done, go forward....
2024-02-13 17:17:06,829 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:17:06,829 - root - INFO - transformation data processing....
2024-02-13 17:17:06,829 - root - INFO - displaying the df_report_1
2024-02-13 17:17:06,829 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:17:06,830 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:17:06,864 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:17:06,901 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:17:06,950 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:17:06,951 - root - INFO - display data_report2 method...
2024-02-13 17:17:06,951 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:17:06,951 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:17:07,023 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:17:13,496 - root - INFO - extracting files output....
2024-02-13 17:17:13,497 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:17:19,724 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:17:19,810 - root - INFO - show read data spark...
2024-02-13 17:17:24,619 - root - INFO - writing into have table
2024-02-13 17:17:24,619 - root - INFO - successfully written into Hive
2024-02-13 17:17:24,620 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:17:34,824 - root - INFO - i am the main method...
2024-02-13 17:17:34,824 - root - INFO - calling spark object
2024-02-13 17:17:34,824 - create_spark - INFO - get_spark_object method started
2024-02-13 17:17:34,824 - create_spark - INFO - master is local
2024-02-13 17:17:37,872 - create_spark - INFO - Spark object create....
2024-02-13 17:17:37,872 - root - INFO - Validating spark object.......
2024-02-13 17:17:37,872 - validate - WARNING - started the get_current_date method...
2024-02-13 17:17:40,308 - validate - WARNING - Validation done, go forward...
2024-02-13 17:17:40,308 - root - INFO - Reading file which is of > parquet
2024-02-13 17:17:40,309 - infest - WARNING - Load_file method started...
2024-02-13 17:17:40,806 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:17:40,809 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:17:42,094 - root - INFO - validating the dataframe...
2024-02-13 17:17:42,094 - infest - WARNING - here to count the records in the df
2024-02-13 17:17:42,456 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:17:42,457 - infest - WARNING - Load_file method started...
2024-02-13 17:17:42,816 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:17:42,818 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:17:43,028 - root - INFO - validating the dataframe...
2024-02-13 17:17:43,028 - infest - WARNING - here to count the records in the df
2024-02-13 17:17:43,713 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:17:43,714 - root - INFO - implementing data processing...
2024-02-13 17:17:43,714 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:17:43,714 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:17:43,737 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:17:43,750 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:17:43,759 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:17:43,784 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:17:43,797 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:17:43,797 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:17:43,810 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:17:45,937 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:17:45,937 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:17:45,937 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:17:46,173 - root - INFO - validating schema for dataframe....
2024-02-13 17:17:46,173 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:17:46,174 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:17:46,174 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:17:46,174 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:17:46,174 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:17:46,174 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:17:46,174 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:17:46,174 - validate - INFO - print schema done, go forward....
2024-02-13 17:17:46,174 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:17:46,175 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:17:46,176 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:17:46,176 - validate - INFO - print schema done, go forward....
2024-02-13 17:17:46,287 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:17:46,287 - root - INFO - transformation data processing....
2024-02-13 17:17:46,287 - root - INFO - displaying the df_report_1
2024-02-13 17:17:46,287 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:17:46,288 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:17:46,316 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:17:46,346 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:17:46,383 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:17:46,383 - root - INFO - display data_report2 method...
2024-02-13 17:17:46,383 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:17:46,383 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:17:46,459 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:17:52,575 - root - INFO - extracting files output....
2024-02-13 17:17:52,575 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:17:58,788 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:17:58,879 - root - INFO - show read data spark...
2024-02-13 17:18:03,846 - root - INFO - writing into have table
2024-02-13 17:18:18,671 - root - INFO - successfully written into Hive
2024-02-13 17:18:18,671 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:18:55,395 - root - INFO - i am the main method...
2024-02-13 17:18:55,395 - root - INFO - calling spark object
2024-02-13 17:18:55,395 - create_spark - INFO - get_spark_object method started
2024-02-13 17:18:55,395 - create_spark - INFO - master is local
2024-02-13 17:18:58,363 - create_spark - INFO - Spark object create....
2024-02-13 17:18:58,363 - root - INFO - Validating spark object.......
2024-02-13 17:18:58,363 - validate - WARNING - started the get_current_date method...
2024-02-13 17:19:01,239 - validate - WARNING - Validation done, go forward...
2024-02-13 17:19:01,239 - root - INFO - Reading file which is of > parquet
2024-02-13 17:19:01,239 - infest - WARNING - Load_file method started...
2024-02-13 17:19:01,704 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:19:01,707 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:19:03,057 - root - INFO - validating the dataframe...
2024-02-13 17:19:03,057 - infest - WARNING - here to count the records in the df
2024-02-13 17:19:03,431 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:19:03,432 - infest - WARNING - Load_file method started...
2024-02-13 17:19:03,767 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:19:03,769 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:19:03,955 - root - INFO - validating the dataframe...
2024-02-13 17:19:03,955 - infest - WARNING - here to count the records in the df
2024-02-13 17:19:04,488 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:19:04,488 - root - INFO - implementing data processing...
2024-02-13 17:19:04,488 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:19:04,488 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:19:04,514 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:19:04,528 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:19:04,539 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:19:04,570 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:19:04,587 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:19:04,588 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:19:04,607 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:19:06,702 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:19:06,702 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:19:06,703 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:19:06,934 - root - INFO - validating schema for dataframe....
2024-02-13 17:19:06,934 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:19:06,935 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:19:06,935 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:19:06,935 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:19:06,935 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:19:06,935 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:19:06,935 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:19:06,935 - validate - INFO - print schema done, go forward....
2024-02-13 17:19:06,935 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:19:06,936 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:19:06,936 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:19:06,937 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:19:06,937 - validate - INFO - print schema done, go forward....
2024-02-13 17:19:07,037 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:19:07,037 - root - INFO - transformation data processing....
2024-02-13 17:19:07,037 - root - INFO - displaying the df_report_1
2024-02-13 17:19:07,037 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:19:07,038 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:19:07,067 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:19:07,097 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:19:07,133 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:19:07,133 - root - INFO - display data_report2 method...
2024-02-13 17:19:07,133 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:19:07,133 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:19:07,206 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:19:13,334 - root - INFO - extracting files output....
2024-02-13 17:19:13,334 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:19:19,605 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:19:19,679 - root - INFO - show read data spark...
2024-02-13 17:19:24,382 - root - INFO - writing into have table
2024-02-13 17:19:35,921 - root - INFO - successfully written into Hive
2024-02-13 17:19:35,921 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:22:33,289 - root - INFO - i am the main method...
2024-02-13 17:22:33,289 - root - INFO - calling spark object
2024-02-13 17:22:33,289 - create_spark - INFO - get_spark_object method started
2024-02-13 17:22:33,289 - create_spark - INFO - master is local
2024-02-13 17:22:36,248 - create_spark - INFO - Spark object create....
2024-02-13 17:22:36,249 - root - INFO - Validating spark object.......
2024-02-13 17:22:36,249 - validate - WARNING - started the get_current_date method...
2024-02-13 17:22:38,633 - validate - WARNING - Validation done, go forward...
2024-02-13 17:22:38,634 - root - INFO - Reading file which is of > parquet
2024-02-13 17:22:38,634 - infest - WARNING - Load_file method started...
2024-02-13 17:22:39,090 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:22:39,094 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:22:40,439 - root - INFO - validating the dataframe...
2024-02-13 17:22:40,439 - infest - WARNING - here to count the records in the df
2024-02-13 17:22:40,817 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:22:40,817 - infest - WARNING - Load_file method started...
2024-02-13 17:22:41,185 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:22:41,187 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:22:41,411 - root - INFO - validating the dataframe...
2024-02-13 17:22:41,411 - infest - WARNING - here to count the records in the df
2024-02-13 17:22:41,986 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:22:41,987 - root - INFO - implementing data processing...
2024-02-13 17:22:41,987 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:22:41,987 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:22:42,012 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:22:42,026 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:22:42,035 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:22:42,062 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:22:42,076 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:22:42,077 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:22:42,092 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:22:44,312 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:22:44,312 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:22:44,312 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:22:44,557 - root - INFO - validating schema for dataframe....
2024-02-13 17:22:44,557 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:22:44,558 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:22:44,558 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:22:44,558 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:22:44,558 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:22:44,558 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:22:44,558 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:22:44,559 - validate - INFO - print schema done, go forward....
2024-02-13 17:22:44,559 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:22:44,560 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:22:44,560 - validate - INFO - print schema done, go forward....
2024-02-13 17:22:44,698 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:22:44,698 - root - INFO - transformation data processing....
2024-02-13 17:22:44,698 - root - INFO - displaying the df_report_1
2024-02-13 17:22:44,698 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:22:44,699 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:22:44,738 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:22:44,779 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:22:44,832 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:22:44,832 - root - INFO - display data_report2 method...
2024-02-13 17:22:44,832 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:22:44,833 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:22:44,924 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:22:51,028 - root - INFO - extracting files output....
2024-02-13 17:22:51,028 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:22:57,589 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:22:57,691 - root - INFO - show read data spark...
2024-02-13 17:23:02,473 - root - INFO - writing into have table
2024-02-13 17:23:02,473 - root - INFO - successfully written into Hive
2024-02-13 17:23:02,474 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:25:19,537 - root - INFO - i am the main method...
2024-02-13 17:25:19,537 - root - INFO - calling spark object
2024-02-13 17:25:19,537 - create_spark - INFO - get_spark_object method started
2024-02-13 17:25:19,537 - create_spark - INFO - master is local
2024-02-13 17:25:22,490 - create_spark - INFO - Spark object create....
2024-02-13 17:25:22,490 - root - INFO - Validating spark object.......
2024-02-13 17:25:22,490 - validate - WARNING - started the get_current_date method...
2024-02-13 17:25:24,868 - validate - WARNING - Validation done, go forward...
2024-02-13 17:25:24,869 - root - INFO - Reading file which is of > parquet
2024-02-13 17:25:24,869 - infest - WARNING - Load_file method started...
2024-02-13 17:25:25,339 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:25:25,342 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:25:26,617 - root - INFO - validating the dataframe...
2024-02-13 17:25:26,617 - infest - WARNING - here to count the records in the df
2024-02-13 17:25:27,000 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:25:27,001 - infest - WARNING - Load_file method started...
2024-02-13 17:25:27,392 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:25:27,395 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:25:27,612 - root - INFO - validating the dataframe...
2024-02-13 17:25:27,612 - infest - WARNING - here to count the records in the df
2024-02-13 17:25:28,193 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:25:28,194 - root - INFO - implementing data processing...
2024-02-13 17:25:28,194 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:25:28,194 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:25:28,217 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:25:28,231 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:25:28,240 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:25:28,266 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:25:28,280 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:25:28,280 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:25:28,297 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:25:30,498 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:25:30,498 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:25:30,498 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:25:30,755 - root - INFO - validating schema for dataframe....
2024-02-13 17:25:30,755 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:25:30,756 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:25:30,756 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:25:30,756 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:25:30,756 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:25:30,756 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:25:30,756 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:25:30,756 - validate - INFO - print schema done, go forward....
2024-02-13 17:25:30,756 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:25:30,757 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:25:30,758 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:25:30,758 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:25:30,758 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:25:30,758 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:25:30,758 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:25:30,758 - validate - INFO - print schema done, go forward....
2024-02-13 17:25:30,852 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:25:30,852 - root - INFO - transformation data processing....
2024-02-13 17:25:30,852 - root - INFO - displaying the df_report_1
2024-02-13 17:25:30,852 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:25:30,853 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:25:30,876 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:25:30,907 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:25:30,941 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:25:30,942 - root - INFO - display data_report2 method...
2024-02-13 17:25:30,942 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:25:30,942 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:25:31,009 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:25:36,914 - root - INFO - extracting files output....
2024-02-13 17:25:36,914 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:25:42,911 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:25:42,983 - root - INFO - show read data spark...
2024-02-13 17:25:47,763 - root - INFO - writing into have table
2024-02-13 17:25:47,763 - root - INFO - successfully written into Hive
2024-02-13 17:25:47,764 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:26:37,926 - root - INFO - i am the main method...
2024-02-13 17:26:37,926 - root - INFO - calling spark object
2024-02-13 17:26:37,926 - create_spark - INFO - get_spark_object method started
2024-02-13 17:26:37,926 - create_spark - INFO - master is local
2024-02-13 17:26:40,867 - create_spark - INFO - Spark object create....
2024-02-13 17:26:40,867 - root - INFO - Validating spark object.......
2024-02-13 17:26:40,867 - validate - WARNING - started the get_current_date method...
2024-02-13 17:26:43,199 - validate - WARNING - Validation done, go forward...
2024-02-13 17:26:43,199 - root - INFO - Reading file which is of > parquet
2024-02-13 17:26:43,199 - infest - WARNING - Load_file method started...
2024-02-13 17:26:43,613 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:26:43,616 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:26:44,839 - root - INFO - validating the dataframe...
2024-02-13 17:26:44,839 - infest - WARNING - here to count the records in the df
2024-02-13 17:26:45,221 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:26:45,221 - infest - WARNING - Load_file method started...
2024-02-13 17:26:45,583 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:26:45,585 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:26:45,780 - root - INFO - validating the dataframe...
2024-02-13 17:26:45,780 - infest - WARNING - here to count the records in the df
2024-02-13 17:26:46,379 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:26:46,379 - root - INFO - implementing data processing...
2024-02-13 17:26:46,379 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:26:46,379 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:26:46,410 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:26:46,426 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:26:46,435 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:26:46,464 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:26:46,479 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:26:46,479 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:26:46,496 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:26:48,561 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:26:48,561 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:26:48,561 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:26:48,790 - root - INFO - validating schema for dataframe....
2024-02-13 17:26:48,790 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:26:48,791 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:26:48,791 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:26:48,791 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:26:48,791 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:26:48,791 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:26:48,791 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:26:48,791 - validate - INFO - print schema done, go forward....
2024-02-13 17:26:48,791 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:26:48,792 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:26:48,793 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:26:48,793 - validate - INFO - print schema done, go forward....
2024-02-13 17:26:48,886 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:26:48,886 - root - INFO - transformation data processing....
2024-02-13 17:26:48,886 - root - INFO - displaying the df_report_1
2024-02-13 17:26:48,886 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:26:48,887 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:26:48,917 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:26:48,950 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:26:48,988 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:26:48,988 - root - INFO - display data_report2 method...
2024-02-13 17:26:48,988 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:26:48,988 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:26:49,064 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:26:55,000 - root - INFO - extracting files output....
2024-02-13 17:26:55,000 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:27:00,944 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:27:01,023 - root - INFO - show read data spark...
2024-02-13 17:27:05,910 - root - INFO - writing into have table
2024-02-13 17:27:05,910 - root - INFO - successfully written into Hive
2024-02-13 17:27:05,911 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:27:28,639 - root - INFO - i am the main method...
2024-02-13 17:27:28,640 - root - INFO - calling spark object
2024-02-13 17:27:28,640 - create_spark - INFO - get_spark_object method started
2024-02-13 17:27:28,640 - create_spark - INFO - master is local
2024-02-13 17:27:31,602 - create_spark - INFO - Spark object create....
2024-02-13 17:27:31,602 - root - INFO - Validating spark object.......
2024-02-13 17:27:31,602 - validate - WARNING - started the get_current_date method...
2024-02-13 17:27:33,958 - validate - WARNING - Validation done, go forward...
2024-02-13 17:27:33,958 - root - INFO - Reading file which is of > parquet
2024-02-13 17:27:33,958 - infest - WARNING - Load_file method started...
2024-02-13 17:27:34,370 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:27:34,373 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:27:35,652 - root - INFO - validating the dataframe...
2024-02-13 17:27:35,652 - infest - WARNING - here to count the records in the df
2024-02-13 17:27:36,011 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:27:36,011 - infest - WARNING - Load_file method started...
2024-02-13 17:27:36,366 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:27:36,368 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:27:36,565 - root - INFO - validating the dataframe...
2024-02-13 17:27:36,565 - infest - WARNING - here to count the records in the df
2024-02-13 17:27:37,125 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:27:37,125 - root - INFO - implementing data processing...
2024-02-13 17:27:37,125 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:27:37,125 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:27:37,147 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:27:37,159 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:27:37,166 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:27:37,189 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:27:37,200 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:27:37,200 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:27:37,215 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:27:39,322 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:27:39,322 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:27:39,323 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:27:39,569 - root - INFO - validating schema for dataframe....
2024-02-13 17:27:39,569 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:27:39,570 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:27:39,570 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:27:39,570 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:27:39,570 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:27:39,570 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:27:39,570 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:27:39,570 - validate - INFO - print schema done, go forward....
2024-02-13 17:27:39,570 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:27:39,571 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:27:39,571 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:27:39,571 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:27:39,571 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:27:39,572 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:27:39,572 - validate - INFO - print schema done, go forward....
2024-02-13 17:27:39,688 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:27:39,688 - root - INFO - transformation data processing....
2024-02-13 17:27:39,688 - root - INFO - displaying the df_report_1
2024-02-13 17:27:39,688 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:27:39,689 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:27:39,716 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:27:39,742 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:27:39,774 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:27:39,774 - root - INFO - display data_report2 method...
2024-02-13 17:27:39,774 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:27:39,774 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:27:39,848 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:27:46,121 - root - INFO - extracting files output....
2024-02-13 17:27:46,121 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:27:52,354 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:27:52,424 - root - INFO - show read data spark...
2024-02-13 17:27:57,027 - root - INFO - writing into have table
2024-02-13 17:27:57,027 - root - INFO - successfully written into Hive
2024-02-13 17:27:57,028 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:30:57,621 - root - INFO - i am the main method...
2024-02-13 17:30:57,621 - root - INFO - calling spark object
2024-02-13 17:30:57,622 - create_spark - INFO - get_spark_object method started
2024-02-13 17:30:57,622 - create_spark - INFO - master is local
2024-02-13 17:31:00,565 - create_spark - INFO - Spark object create....
2024-02-13 17:31:00,565 - root - INFO - Validating spark object.......
2024-02-13 17:31:00,566 - validate - WARNING - started the get_current_date method...
2024-02-13 17:31:02,920 - validate - WARNING - Validation done, go forward...
2024-02-13 17:31:02,920 - root - INFO - Reading file which is of > parquet
2024-02-13 17:31:02,921 - infest - WARNING - Load_file method started...
2024-02-13 17:31:03,332 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:31:03,334 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:31:04,609 - root - INFO - validating the dataframe...
2024-02-13 17:31:04,609 - infest - WARNING - here to count the records in the df
2024-02-13 17:31:04,970 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:31:04,970 - infest - WARNING - Load_file method started...
2024-02-13 17:31:05,309 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:31:05,311 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:31:05,503 - root - INFO - validating the dataframe...
2024-02-13 17:31:05,503 - infest - WARNING - here to count the records in the df
2024-02-13 17:31:06,094 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:31:06,094 - root - INFO - implementing data processing...
2024-02-13 17:31:06,094 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:31:06,094 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:31:06,118 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:31:06,132 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:31:06,140 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:31:06,169 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:31:06,181 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:31:06,182 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:31:06,199 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:31:08,365 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:31:08,365 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:31:08,365 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:31:08,590 - root - INFO - validating schema for dataframe....
2024-02-13 17:31:08,590 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:31:08,591 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:31:08,591 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:31:08,591 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:31:08,591 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:31:08,591 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:31:08,591 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:31:08,591 - validate - INFO - print schema done, go forward....
2024-02-13 17:31:08,591 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:31:08,592 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:31:08,593 - validate - INFO - print schema done, go forward....
2024-02-13 17:31:08,691 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:31:08,691 - root - INFO - transformation data processing....
2024-02-13 17:31:08,691 - root - INFO - displaying the df_report_1
2024-02-13 17:31:08,691 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:31:08,692 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:31:08,723 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:31:08,756 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:31:08,803 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:31:08,803 - root - INFO - display data_report2 method...
2024-02-13 17:31:08,803 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:31:08,803 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:31:08,887 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:31:15,289 - root - INFO - extracting files output....
2024-02-13 17:31:15,289 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:31:21,534 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:31:21,617 - root - INFO - show read data spark...
2024-02-13 17:31:24,763 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=696>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-13 17:31:24,765 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\seanghouch.ly\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o20.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-13 17:31:25,082 - root - INFO - i am the main method...
2024-02-13 17:31:25,082 - root - INFO - calling spark object
2024-02-13 17:31:25,082 - create_spark - INFO - get_spark_object method started
2024-02-13 17:31:25,082 - create_spark - INFO - master is local
2024-02-13 17:31:28,268 - create_spark - INFO - Spark object create....
2024-02-13 17:31:28,268 - root - INFO - Validating spark object.......
2024-02-13 17:31:28,269 - validate - WARNING - started the get_current_date method...
2024-02-13 17:31:30,658 - validate - WARNING - Validation done, go forward...
2024-02-13 17:31:30,659 - root - INFO - Reading file which is of > parquet
2024-02-13 17:31:30,659 - infest - WARNING - Load_file method started...
2024-02-13 17:31:31,091 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:31:31,094 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:31:32,376 - root - INFO - validating the dataframe...
2024-02-13 17:31:32,376 - infest - WARNING - here to count the records in the df
2024-02-13 17:31:32,755 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:31:32,755 - infest - WARNING - Load_file method started...
2024-02-13 17:31:33,130 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:31:33,132 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:31:33,326 - root - INFO - validating the dataframe...
2024-02-13 17:31:33,326 - infest - WARNING - here to count the records in the df
2024-02-13 17:31:33,930 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:31:33,930 - root - INFO - implementing data processing...
2024-02-13 17:31:33,930 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:31:33,930 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:31:33,957 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:31:33,970 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:31:33,979 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:31:34,005 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:31:34,019 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:31:34,019 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:31:34,036 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:31:36,197 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:31:36,197 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:31:36,197 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:31:36,429 - root - INFO - validating schema for dataframe....
2024-02-13 17:31:36,429 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:31:36,430 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:31:36,431 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:31:36,431 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:31:36,431 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:31:36,431 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:31:36,431 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:31:36,431 - validate - INFO - print schema done, go forward....
2024-02-13 17:31:36,431 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:31:36,432 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:31:36,433 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:31:36,433 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:31:36,433 - validate - INFO - print schema done, go forward....
2024-02-13 17:31:36,547 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:31:36,547 - root - INFO - transformation data processing....
2024-02-13 17:31:36,547 - root - INFO - displaying the df_report_1
2024-02-13 17:31:36,547 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:31:36,548 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:31:36,579 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:31:36,608 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:31:36,645 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:31:36,645 - root - INFO - display data_report2 method...
2024-02-13 17:31:36,645 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:31:36,645 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:31:36,729 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:31:42,869 - root - INFO - extracting files output....
2024-02-13 17:31:42,869 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:31:48,910 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:31:48,985 - root - INFO - show read data spark...
2024-02-13 17:31:53,666 - root - INFO - writing into have table
2024-02-13 17:31:53,667 - root - INFO - successfully written into Hive
2024-02-13 17:31:53,667 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:33:46,767 - root - INFO - i am the main method...
2024-02-13 17:33:46,767 - root - INFO - calling spark object
2024-02-13 17:33:46,767 - create_spark - INFO - get_spark_object method started
2024-02-13 17:33:46,767 - create_spark - INFO - master is local
2024-02-13 17:33:49,705 - create_spark - INFO - Spark object create....
2024-02-13 17:33:49,705 - root - INFO - Validating spark object.......
2024-02-13 17:33:49,705 - validate - WARNING - started the get_current_date method...
2024-02-13 17:33:52,064 - validate - WARNING - Validation done, go forward...
2024-02-13 17:33:52,064 - root - INFO - Reading file which is of > parquet
2024-02-13 17:33:52,065 - infest - WARNING - Load_file method started...
2024-02-13 17:33:52,516 - infest - WARNING - dataframe created  which is if parquet
2024-02-13 17:33:52,518 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-13 17:33:53,854 - root - INFO - validating the dataframe...
2024-02-13 17:33:53,854 - infest - WARNING - here to count the records in the df
2024-02-13 17:33:54,229 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-13 17:33:54,230 - infest - WARNING - Load_file method started...
2024-02-13 17:33:54,599 - infest - WARNING - dataframe created  which is if csv
2024-02-13 17:33:54,601 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-13 17:33:54,806 - root - INFO - validating the dataframe...
2024-02-13 17:33:54,806 - infest - WARNING - here to count the records in the df
2024-02-13 17:33:55,362 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-13 17:33:55,363 - root - INFO - implementing data processing...
2024-02-13 17:33:55,363 - data_processing - WARNING - data_clean method() stating....
2024-02-13 17:33:55,363 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-13 17:33:55,390 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-13 17:33:55,404 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-13 17:33:55,413 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-13 17:33:55,442 - data_processing - WARNING - concat firstName and lastName
2024-02-13 17:33:55,458 - data_processing - WARNING - now check for null values in all column
2024-02-13 17:33:55,458 - data_processing - WARNING - drop the null values in the respective column...
2024-02-13 17:33:55,475 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-13 17:33:57,657 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-13 17:33:57,657 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-13 17:33:57,657 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-13 17:33:57,954 - root - INFO - validating schema for dataframe....
2024-02-13 17:33:57,954 - validate - WARNING - printing schema method starting... df_city
2024-02-13 17:33:57,955 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-13 17:33:57,955 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-13 17:33:57,955 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-13 17:33:57,955 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-13 17:33:57,956 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-13 17:33:57,956 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-13 17:33:57,956 - validate - INFO - print schema done, go forward....
2024-02-13 17:33:57,956 - validate - WARNING - printing schema method starting... df_fact
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-13 17:33:57,957 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-13 17:33:57,957 - validate - INFO - print schema done, go forward....
2024-02-13 17:33:58,059 - root - INFO - checking null values schema for dataframe....
2024-02-13 17:33:58,059 - root - INFO - transformation data processing....
2024-02-13 17:33:58,059 - root - INFO - displaying the df_report_1
2024-02-13 17:33:58,059 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-13 17:33:58,060 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-13 17:33:58,087 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-13 17:33:58,118 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-13 17:33:58,153 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-13 17:33:58,153 - root - INFO - display data_report2 method...
2024-02-13 17:33:58,153 - data_transformation - WARNING - executing data_report2 method...
2024-02-13 17:33:58,153 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-13 17:33:58,227 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-13 17:34:04,533 - root - INFO - extracting files output....
2024-02-13 17:34:04,533 - extraction - WARNING - extracting_file method starting....
2024-02-13 17:34:10,790 - extraction - WARNING - extract_file method successfully...
2024-02-13 17:34:10,859 - root - INFO - show read data spark...
2024-02-13 17:34:15,540 - root - INFO - writing into have table
2024-02-13 17:34:15,540 - root - INFO - successfully written into Hive
2024-02-13 17:34:15,541 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-13 17:34:19,104 - root - INFO - total amount of time taken: 32.33745630001067 seconds...
2024-02-13 17:34:19,105 - root - INFO - Application done
2024-02-14 08:29:02,278 - root - INFO - i am the main method...
2024-02-14 08:29:02,278 - root - INFO - calling spark object
2024-02-14 08:29:02,278 - create_spark - INFO - get_spark_object method started
2024-02-14 08:29:02,278 - create_spark - INFO - master is local
2024-02-14 08:29:07,325 - create_spark - INFO - Spark object create....
2024-02-14 08:29:07,326 - root - INFO - Validating spark object.......
2024-02-14 08:29:07,326 - validate - WARNING - started the get_current_date method...
2024-02-14 08:29:10,603 - validate - WARNING - Validation done, go forward...
2024-02-14 08:29:10,603 - root - INFO - Reading file which is of > parquet
2024-02-14 08:29:10,603 - infest - WARNING - Load_file method started...
2024-02-14 08:29:11,162 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 08:29:11,166 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 08:29:12,661 - root - INFO - validating the dataframe...
2024-02-14 08:29:12,661 - infest - WARNING - here to count the records in the df
2024-02-14 08:29:13,083 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 08:29:13,083 - infest - WARNING - Load_file method started...
2024-02-14 08:29:13,489 - infest - WARNING - dataframe created  which is if csv
2024-02-14 08:29:13,490 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 08:29:13,690 - root - INFO - validating the dataframe...
2024-02-14 08:29:13,690 - infest - WARNING - here to count the records in the df
2024-02-14 08:29:14,585 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 08:29:14,585 - root - INFO - implementing data processing...
2024-02-14 08:29:14,585 - data_processing - WARNING - data_clean method() stating....
2024-02-14 08:29:14,585 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 08:29:14,613 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 08:29:14,628 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 08:29:14,639 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 08:29:14,673 - data_processing - WARNING - concat firstName and lastName
2024-02-14 08:29:14,688 - data_processing - WARNING - now check for null values in all column
2024-02-14 08:29:14,688 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 08:29:14,705 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 08:29:16,930 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 08:29:16,930 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 08:29:16,930 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 08:29:17,234 - root - INFO - validating schema for dataframe....
2024-02-14 08:29:17,234 - validate - WARNING - printing schema method starting... df_city
2024-02-14 08:29:17,235 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 08:29:17,235 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 08:29:17,235 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 08:29:17,235 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 08:29:17,235 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 08:29:17,235 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 08:29:17,235 - validate - INFO - print schema done, go forward....
2024-02-14 08:29:17,235 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 08:29:17,236 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 08:29:17,236 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 08:29:17,237 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 08:29:17,237 - validate - INFO - print schema done, go forward....
2024-02-14 08:29:17,359 - root - INFO - checking null values schema for dataframe....
2024-02-14 08:29:17,359 - root - INFO - transformation data processing....
2024-02-14 08:29:17,359 - root - INFO - displaying the df_report_1
2024-02-14 08:29:17,359 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 08:29:17,360 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 08:29:17,396 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 08:29:17,431 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 08:29:17,480 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 08:29:17,480 - root - INFO - display data_report2 method...
2024-02-14 08:29:17,480 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 08:29:17,480 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 08:29:17,570 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 08:29:24,373 - root - INFO - extracting files output....
2024-02-14 08:29:24,374 - extraction - WARNING - extracting_file method starting....
2024-02-14 08:29:30,865 - extraction - WARNING - extract_file method successfully...
2024-02-14 08:29:30,946 - root - INFO - show read data spark...
2024-02-14 08:29:35,763 - root - INFO - writing into have table
2024-02-14 08:29:35,764 - root - INFO - successfully written into Hive
2024-02-14 08:29:35,765 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 08:29:40,023 - root - INFO - total amount of time taken: 37.74470039999994 seconds...
2024-02-14 08:29:40,023 - root - INFO - Application done
2024-02-14 08:30:58,431 - root - INFO - i am the main method...
2024-02-14 08:30:58,431 - root - INFO - calling spark object
2024-02-14 08:30:58,432 - create_spark - INFO - get_spark_object method started
2024-02-14 08:30:58,432 - create_spark - INFO - master is local
2024-02-14 08:31:01,639 - create_spark - INFO - Spark object create....
2024-02-14 08:31:01,639 - root - INFO - Validating spark object.......
2024-02-14 08:31:01,639 - validate - WARNING - started the get_current_date method...
2024-02-14 08:31:04,120 - validate - WARNING - Validation done, go forward...
2024-02-14 08:31:04,121 - root - INFO - Reading file which is of > parquet
2024-02-14 08:31:04,121 - infest - WARNING - Load_file method started...
2024-02-14 08:31:04,572 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 08:31:04,575 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 08:31:05,950 - root - INFO - validating the dataframe...
2024-02-14 08:31:05,950 - infest - WARNING - here to count the records in the df
2024-02-14 08:31:06,342 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 08:31:06,343 - infest - WARNING - Load_file method started...
2024-02-14 08:31:06,738 - infest - WARNING - dataframe created  which is if csv
2024-02-14 08:31:06,741 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 08:31:07,020 - root - INFO - validating the dataframe...
2024-02-14 08:31:07,020 - infest - WARNING - here to count the records in the df
2024-02-14 08:31:07,837 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 08:31:07,838 - root - INFO - implementing data processing...
2024-02-14 08:31:07,838 - data_processing - WARNING - data_clean method() stating....
2024-02-14 08:31:07,838 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 08:31:07,866 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 08:31:07,884 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 08:31:07,894 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 08:31:07,925 - data_processing - WARNING - concat firstName and lastName
2024-02-14 08:31:07,938 - data_processing - WARNING - now check for null values in all column
2024-02-14 08:31:07,938 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 08:31:07,985 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 08:31:10,153 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 08:31:10,153 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 08:31:10,153 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 08:31:10,407 - root - INFO - validating schema for dataframe....
2024-02-14 08:31:10,407 - validate - WARNING - printing schema method starting... df_city
2024-02-14 08:31:10,408 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 08:31:10,408 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 08:31:10,408 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 08:31:10,408 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 08:31:10,408 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 08:31:10,408 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 08:31:10,408 - validate - INFO - print schema done, go forward....
2024-02-14 08:31:10,408 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 08:31:10,409 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 08:31:10,409 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 08:31:10,410 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 08:31:10,410 - validate - INFO - print schema done, go forward....
2024-02-14 08:31:10,521 - root - INFO - checking null values schema for dataframe....
2024-02-14 08:31:10,521 - root - INFO - transformation data processing....
2024-02-14 08:31:10,521 - root - INFO - displaying the df_report_1
2024-02-14 08:31:10,521 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 08:31:10,522 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 08:31:10,554 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 08:31:10,597 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 08:31:10,640 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 08:31:10,640 - root - INFO - display data_report2 method...
2024-02-14 08:31:10,640 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 08:31:10,640 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 08:31:10,724 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 08:31:17,427 - root - INFO - extracting files output....
2024-02-14 08:31:17,428 - extraction - WARNING - extracting_file method starting....
2024-02-14 08:31:24,222 - extraction - WARNING - extract_file method successfully...
2024-02-14 08:31:24,340 - root - INFO - show read data spark...
2024-02-14 08:31:29,392 - root - INFO - writing into have table
2024-02-14 08:31:29,392 - root - INFO - successfully written into Hive
2024-02-14 08:31:29,393 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 08:32:09,673 - root - INFO - i am the main method...
2024-02-14 08:32:09,673 - root - INFO - calling spark object
2024-02-14 08:32:09,673 - create_spark - INFO - get_spark_object method started
2024-02-14 08:32:09,673 - create_spark - INFO - master is local
2024-02-14 08:32:12,787 - create_spark - INFO - Spark object create....
2024-02-14 08:32:12,787 - root - INFO - Validating spark object.......
2024-02-14 08:32:12,787 - validate - WARNING - started the get_current_date method...
2024-02-14 08:32:15,193 - validate - WARNING - Validation done, go forward...
2024-02-14 08:32:15,193 - root - INFO - Reading file which is of > parquet
2024-02-14 08:32:15,193 - infest - WARNING - Load_file method started...
2024-02-14 08:32:15,650 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 08:32:15,653 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 08:32:16,989 - root - INFO - validating the dataframe...
2024-02-14 08:32:16,989 - infest - WARNING - here to count the records in the df
2024-02-14 08:32:17,389 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 08:32:17,390 - infest - WARNING - Load_file method started...
2024-02-14 08:32:17,787 - infest - WARNING - dataframe created  which is if csv
2024-02-14 08:32:17,788 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 08:32:18,039 - root - INFO - validating the dataframe...
2024-02-14 08:32:18,039 - infest - WARNING - here to count the records in the df
2024-02-14 08:32:18,680 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 08:32:18,681 - root - INFO - implementing data processing...
2024-02-14 08:32:18,681 - data_processing - WARNING - data_clean method() stating....
2024-02-14 08:32:18,681 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 08:32:18,723 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 08:32:18,746 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 08:32:18,759 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 08:32:18,795 - data_processing - WARNING - concat firstName and lastName
2024-02-14 08:32:18,819 - data_processing - WARNING - now check for null values in all column
2024-02-14 08:32:18,819 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 08:32:18,843 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 08:32:21,079 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 08:32:21,079 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 08:32:21,079 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 08:32:21,370 - root - INFO - validating schema for dataframe....
2024-02-14 08:32:21,370 - validate - WARNING - printing schema method starting... df_city
2024-02-14 08:32:21,371 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 08:32:21,371 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 08:32:21,372 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 08:32:21,372 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 08:32:21,372 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 08:32:21,372 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 08:32:21,372 - validate - INFO - print schema done, go forward....
2024-02-14 08:32:21,372 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 08:32:21,374 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 08:32:21,374 - validate - INFO - print schema done, go forward....
2024-02-14 08:32:21,495 - root - INFO - checking null values schema for dataframe....
2024-02-14 08:32:21,495 - root - INFO - transformation data processing....
2024-02-14 08:32:21,495 - root - INFO - displaying the df_report_1
2024-02-14 08:32:21,495 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 08:32:21,496 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 08:32:21,530 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 08:32:21,570 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 08:32:21,623 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 08:32:21,623 - root - INFO - display data_report2 method...
2024-02-14 08:32:21,623 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 08:32:21,624 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 08:32:21,711 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 08:32:28,833 - root - INFO - extracting files output....
2024-02-14 08:32:28,834 - extraction - WARNING - extracting_file method starting....
2024-02-14 08:32:35,380 - extraction - WARNING - extract_file method successfully...
2024-02-14 08:32:35,464 - root - INFO - show read data spark...
2024-02-14 08:32:40,471 - root - INFO - writing into have table
2024-02-14 08:32:40,471 - root - INFO - successfully written into Hive
2024-02-14 08:32:40,472 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 08:34:18,828 - root - INFO - i am the main method...
2024-02-14 08:34:18,829 - root - INFO - calling spark object
2024-02-14 08:34:18,829 - create_spark - INFO - get_spark_object method started
2024-02-14 08:34:18,829 - create_spark - INFO - master is local
2024-02-14 08:34:22,962 - create_spark - INFO - Spark object create....
2024-02-14 08:34:22,962 - root - INFO - Validating spark object.......
2024-02-14 08:34:22,962 - validate - WARNING - started the get_current_date method...
2024-02-14 08:34:25,413 - validate - WARNING - Validation done, go forward...
2024-02-14 08:34:25,413 - root - INFO - Reading file which is of > parquet
2024-02-14 08:34:25,413 - infest - WARNING - Load_file method started...
2024-02-14 08:34:25,891 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 08:34:25,894 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 08:34:27,319 - root - INFO - validating the dataframe...
2024-02-14 08:34:27,319 - infest - WARNING - here to count the records in the df
2024-02-14 08:34:27,714 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 08:34:27,715 - infest - WARNING - Load_file method started...
2024-02-14 08:34:28,060 - infest - WARNING - dataframe created  which is if csv
2024-02-14 08:34:28,062 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 08:34:28,257 - root - INFO - validating the dataframe...
2024-02-14 08:34:28,257 - infest - WARNING - here to count the records in the df
2024-02-14 08:34:28,808 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 08:34:28,808 - root - INFO - implementing data processing...
2024-02-14 08:34:28,808 - data_processing - WARNING - data_clean method() stating....
2024-02-14 08:34:28,808 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 08:34:28,833 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 08:34:28,850 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 08:34:28,859 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 08:34:28,887 - data_processing - WARNING - concat firstName and lastName
2024-02-14 08:34:28,900 - data_processing - WARNING - now check for null values in all column
2024-02-14 08:34:28,900 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 08:34:28,916 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 08:34:31,065 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 08:34:31,065 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 08:34:31,065 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 08:34:31,302 - root - INFO - validating schema for dataframe....
2024-02-14 08:34:31,302 - validate - WARNING - printing schema method starting... df_city
2024-02-14 08:34:31,303 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 08:34:31,303 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 08:34:31,303 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 08:34:31,303 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 08:34:31,303 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 08:34:31,304 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 08:34:31,304 - validate - INFO - print schema done, go forward....
2024-02-14 08:34:31,304 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 08:34:31,304 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 08:34:31,305 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 08:34:31,305 - validate - INFO - print schema done, go forward....
2024-02-14 08:34:31,414 - root - INFO - checking null values schema for dataframe....
2024-02-14 08:34:31,414 - root - INFO - transformation data processing....
2024-02-14 08:34:31,414 - root - INFO - displaying the df_report_1
2024-02-14 08:34:31,414 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 08:34:31,415 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 08:34:31,446 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 08:34:31,475 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 08:34:31,518 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 08:34:31,518 - root - INFO - display data_report2 method...
2024-02-14 08:34:31,518 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 08:34:31,518 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 08:34:31,590 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 08:34:38,040 - root - INFO - extracting files output....
2024-02-14 08:34:38,041 - extraction - WARNING - extracting_file method starting....
2024-02-14 08:34:44,369 - extraction - WARNING - extract_file method successfully...
2024-02-14 08:34:44,445 - root - INFO - show read data spark...
2024-02-14 08:34:49,090 - root - INFO - writing into have table
2024-02-14 08:34:49,090 - root - INFO - successfully written into Hive
2024-02-14 08:34:49,091 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 08:34:55,141 - root - INFO - i am the main method...
2024-02-14 08:34:55,141 - root - INFO - calling spark object
2024-02-14 08:34:55,141 - create_spark - INFO - get_spark_object method started
2024-02-14 08:34:55,141 - create_spark - INFO - master is local
2024-02-14 08:34:58,141 - create_spark - INFO - Spark object create....
2024-02-14 08:34:58,141 - root - INFO - Validating spark object.......
2024-02-14 08:34:58,141 - validate - WARNING - started the get_current_date method...
2024-02-14 08:35:00,640 - validate - WARNING - Validation done, go forward...
2024-02-14 08:35:00,640 - root - INFO - Reading file which is of > parquet
2024-02-14 08:35:00,640 - infest - WARNING - Load_file method started...
2024-02-14 08:35:01,087 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 08:35:01,090 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 08:35:02,386 - root - INFO - validating the dataframe...
2024-02-14 08:35:02,386 - infest - WARNING - here to count the records in the df
2024-02-14 08:35:02,726 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 08:35:02,727 - infest - WARNING - Load_file method started...
2024-02-14 08:35:03,114 - infest - WARNING - dataframe created  which is if csv
2024-02-14 08:35:03,115 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 08:35:03,297 - root - INFO - validating the dataframe...
2024-02-14 08:35:03,297 - infest - WARNING - here to count the records in the df
2024-02-14 08:35:03,853 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 08:35:03,853 - root - INFO - implementing data processing...
2024-02-14 08:35:03,853 - data_processing - WARNING - data_clean method() stating....
2024-02-14 08:35:03,853 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 08:35:03,885 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 08:35:03,899 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 08:35:03,909 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 08:35:03,936 - data_processing - WARNING - concat firstName and lastName
2024-02-14 08:35:03,952 - data_processing - WARNING - now check for null values in all column
2024-02-14 08:35:03,952 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 08:35:03,972 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 08:35:06,280 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 08:35:06,280 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 08:35:06,280 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 08:35:06,601 - root - INFO - validating schema for dataframe....
2024-02-14 08:35:06,601 - validate - WARNING - printing schema method starting... df_city
2024-02-14 08:35:06,602 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 08:35:06,602 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 08:35:06,602 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 08:35:06,602 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 08:35:06,602 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 08:35:06,602 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 08:35:06,602 - validate - INFO - print schema done, go forward....
2024-02-14 08:35:06,602 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 08:35:06,604 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 08:35:06,604 - validate - INFO - print schema done, go forward....
2024-02-14 08:35:06,712 - root - INFO - checking null values schema for dataframe....
2024-02-14 08:35:06,712 - root - INFO - transformation data processing....
2024-02-14 08:35:06,712 - root - INFO - displaying the df_report_1
2024-02-14 08:35:06,712 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 08:35:06,713 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 08:35:06,749 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 08:35:06,791 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 08:35:06,849 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 08:35:06,850 - root - INFO - display data_report2 method...
2024-02-14 08:35:06,850 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 08:35:06,850 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 08:35:06,933 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 08:35:13,440 - root - INFO - extracting files output....
2024-02-14 08:35:13,440 - extraction - WARNING - extracting_file method starting....
2024-02-14 08:35:19,993 - extraction - WARNING - extract_file method successfully...
2024-02-14 08:35:20,085 - root - INFO - show read data spark...
2024-02-14 08:35:25,296 - root - INFO - writing into have table
2024-02-14 08:35:25,296 - root - INFO - successfully written into Hive
2024-02-14 08:35:25,297 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 08:35:27,837 - root - INFO - total amount of time taken: 32.69631120000008 seconds...
2024-02-14 08:35:27,838 - root - INFO - Application done
2024-02-14 08:52:18,398 - root - INFO - i am the main method...
2024-02-14 08:52:18,398 - root - INFO - calling spark object
2024-02-14 08:52:18,398 - create_spark - INFO - get_spark_object method started
2024-02-14 08:52:18,398 - create_spark - INFO - master is local
2024-02-14 08:58:46,910 - root - INFO - i am the main method...
2024-02-14 08:58:46,911 - root - INFO - calling spark object
2024-02-14 08:58:46,911 - create_spark - INFO - get_spark_object method started
2024-02-14 08:58:46,911 - create_spark - INFO - master is local
2024-02-14 08:58:51,205 - create_spark - INFO - Spark object create....
2024-02-14 08:58:51,205 - root - INFO - Validating spark object.......
2024-02-14 08:58:51,205 - validate - WARNING - started the get_current_date method...
2024-02-14 08:58:54,344 - validate - WARNING - Validation done, go forward...
2024-02-14 08:58:54,345 - root - INFO - Reading file which is of > parquet
2024-02-14 08:58:54,345 - infest - WARNING - Load_file method started...
2024-02-14 08:58:54,873 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 08:58:54,876 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 08:58:56,237 - root - INFO - validating the dataframe...
2024-02-14 08:58:56,237 - infest - WARNING - here to count the records in the df
2024-02-14 08:58:56,644 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 08:58:56,644 - infest - WARNING - Load_file method started...
2024-02-14 08:58:57,050 - infest - WARNING - dataframe created  which is if csv
2024-02-14 08:58:57,052 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 08:58:57,296 - root - INFO - validating the dataframe...
2024-02-14 08:58:57,296 - infest - WARNING - here to count the records in the df
2024-02-14 08:58:57,853 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 08:58:57,854 - root - INFO - implementing data processing...
2024-02-14 08:58:57,854 - data_processing - WARNING - data_clean method() stating....
2024-02-14 08:58:57,854 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 08:58:57,879 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 08:58:57,894 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 08:58:57,904 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 08:58:57,932 - data_processing - WARNING - concat firstName and lastName
2024-02-14 08:58:57,946 - data_processing - WARNING - now check for null values in all column
2024-02-14 08:58:57,946 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 08:58:57,961 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 08:59:00,210 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 08:59:00,210 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 08:59:00,211 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 08:59:00,484 - root - INFO - validating schema for dataframe....
2024-02-14 08:59:00,484 - validate - WARNING - printing schema method starting... df_city
2024-02-14 08:59:00,485 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 08:59:00,485 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 08:59:00,485 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 08:59:00,485 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 08:59:00,485 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 08:59:00,486 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 08:59:00,486 - validate - INFO - print schema done, go forward....
2024-02-14 08:59:00,486 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 08:59:00,487 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 08:59:00,488 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 08:59:00,488 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 08:59:00,488 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 08:59:00,488 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 08:59:00,488 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 08:59:00,488 - validate - INFO - print schema done, go forward....
2024-02-14 08:59:00,611 - root - INFO - checking null values schema for dataframe....
2024-02-14 08:59:00,611 - root - INFO - transformation data processing....
2024-02-14 08:59:00,611 - root - INFO - displaying the df_report_1
2024-02-14 08:59:00,611 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 08:59:00,612 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 08:59:00,640 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 08:59:00,669 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 08:59:00,711 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 08:59:00,712 - root - INFO - display data_report2 method...
2024-02-14 08:59:00,712 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 08:59:00,712 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 08:59:00,795 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 08:59:07,570 - root - INFO - extracting files output....
2024-02-14 08:59:07,570 - extraction - WARNING - extracting_file method starting....
2024-02-14 08:59:14,264 - extraction - WARNING - extract_file method successfully...
2024-02-14 08:59:14,359 - root - INFO - show read data spark...
2024-02-14 08:59:19,703 - root - INFO - writing into have table
2024-02-14 08:59:19,704 - root - INFO - successfully written into Hive
2024-02-14 08:59:19,705 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 08:59:22,343 - root - INFO - total amount of time taken: 35.43325050000021 seconds...
2024-02-14 08:59:22,344 - root - INFO - Application done
2024-02-14 09:00:08,593 - root - INFO - i am the main method...
2024-02-14 09:00:08,593 - root - INFO - calling spark object
2024-02-14 09:00:08,593 - create_spark - INFO - get_spark_object method started
2024-02-14 09:00:08,593 - create_spark - INFO - master is local
2024-02-14 09:00:11,765 - create_spark - INFO - Spark object create....
2024-02-14 09:00:11,765 - root - INFO - Validating spark object.......
2024-02-14 09:00:11,765 - validate - WARNING - started the get_current_date method...
2024-02-14 09:00:14,224 - validate - WARNING - Validation done, go forward...
2024-02-14 09:00:14,224 - root - INFO - Reading file which is of > parquet
2024-02-14 09:00:14,225 - infest - WARNING - Load_file method started...
2024-02-14 09:00:14,680 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:00:14,683 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:00:15,967 - root - INFO - validating the dataframe...
2024-02-14 09:00:15,967 - infest - WARNING - here to count the records in the df
2024-02-14 09:00:16,348 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:00:16,348 - infest - WARNING - Load_file method started...
2024-02-14 09:00:16,716 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:00:16,718 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:00:16,947 - root - INFO - validating the dataframe...
2024-02-14 09:00:16,947 - infest - WARNING - here to count the records in the df
2024-02-14 09:00:17,548 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:00:17,548 - root - INFO - implementing data processing...
2024-02-14 09:00:17,548 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:00:17,548 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:00:17,574 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:00:17,588 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:00:17,597 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:00:17,625 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:00:17,638 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:00:17,639 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:00:17,654 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:00:19,845 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:00:19,845 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:00:19,845 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:00:20,117 - root - INFO - validating schema for dataframe....
2024-02-14 09:00:20,117 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:00:20,118 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:00:20,118 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:00:20,118 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:00:20,118 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:00:20,118 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:00:20,118 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:00:20,118 - validate - INFO - print schema done, go forward....
2024-02-14 09:00:20,118 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:00:20,120 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:00:20,121 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:00:20,121 - validate - INFO - print schema done, go forward....
2024-02-14 09:00:20,231 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:00:20,231 - root - INFO - transformation data processing....
2024-02-14 09:00:20,231 - root - INFO - displaying the df_report_1
2024-02-14 09:00:20,231 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:00:20,232 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:00:20,260 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:00:20,297 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:00:20,350 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:00:20,350 - root - INFO - display data_report2 method...
2024-02-14 09:00:20,350 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:00:20,350 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:00:20,450 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:00:26,919 - root - INFO - extracting files output....
2024-02-14 09:00:26,919 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:00:33,363 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:00:33,444 - root - INFO - show read data spark...
2024-02-14 09:00:38,294 - root - INFO - writing into have table
2024-02-14 09:00:38,294 - root - INFO - successfully written into Hive
2024-02-14 09:00:38,295 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:00:40,950 - root - INFO - total amount of time taken: 32.357187100000374 seconds...
2024-02-14 09:00:40,951 - root - INFO - Application done
2024-02-14 09:00:56,637 - root - INFO - i am the main method...
2024-02-14 09:00:56,637 - root - INFO - calling spark object
2024-02-14 09:00:56,637 - create_spark - INFO - get_spark_object method started
2024-02-14 09:00:56,637 - create_spark - INFO - master is local
2024-02-14 09:00:59,602 - create_spark - INFO - Spark object create....
2024-02-14 09:00:59,602 - root - INFO - Validating spark object.......
2024-02-14 09:00:59,602 - validate - WARNING - started the get_current_date method...
2024-02-14 09:01:01,972 - validate - WARNING - Validation done, go forward...
2024-02-14 09:01:01,972 - root - INFO - Reading file which is of > parquet
2024-02-14 09:01:01,973 - infest - WARNING - Load_file method started...
2024-02-14 09:01:02,393 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:01:02,396 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:01:03,699 - root - INFO - validating the dataframe...
2024-02-14 09:01:03,699 - infest - WARNING - here to count the records in the df
2024-02-14 09:01:04,069 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:01:04,070 - infest - WARNING - Load_file method started...
2024-02-14 09:01:04,421 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:01:04,422 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:01:04,618 - root - INFO - validating the dataframe...
2024-02-14 09:01:04,618 - infest - WARNING - here to count the records in the df
2024-02-14 09:01:05,219 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:01:05,219 - root - INFO - implementing data processing...
2024-02-14 09:01:05,219 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:01:05,219 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:01:05,247 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:01:05,263 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:01:05,273 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:01:05,305 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:01:05,320 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:01:05,321 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:01:05,339 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:01:07,541 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:01:07,541 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:01:07,541 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:01:07,784 - root - INFO - validating schema for dataframe....
2024-02-14 09:01:07,784 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:01:07,785 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:01:07,785 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:01:07,785 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:01:07,785 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:01:07,785 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:01:07,785 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:01:07,785 - validate - INFO - print schema done, go forward....
2024-02-14 09:01:07,785 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:01:07,786 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:01:07,787 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:01:07,787 - validate - INFO - print schema done, go forward....
2024-02-14 09:01:07,891 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:01:07,891 - root - INFO - transformation data processing....
2024-02-14 09:01:07,891 - root - INFO - displaying the df_report_1
2024-02-14 09:01:07,891 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:01:07,892 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:01:07,924 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:01:07,957 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:01:07,999 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:01:07,999 - root - INFO - display data_report2 method...
2024-02-14 09:01:07,999 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:01:07,999 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:01:08,088 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:01:14,422 - root - INFO - extracting files output....
2024-02-14 09:01:14,422 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:01:20,903 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:01:20,985 - root - INFO - show read data spark...
2024-02-14 09:01:25,770 - root - INFO - writing into have table
2024-02-14 09:01:25,770 - root - INFO - successfully written into Hive
2024-02-14 09:01:25,771 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:01:44,899 - root - INFO - i am the main method...
2024-02-14 09:01:44,899 - root - INFO - calling spark object
2024-02-14 09:01:44,899 - create_spark - INFO - get_spark_object method started
2024-02-14 09:01:44,899 - create_spark - INFO - master is local
2024-02-14 09:01:47,940 - create_spark - INFO - Spark object create....
2024-02-14 09:01:47,940 - root - INFO - Validating spark object.......
2024-02-14 09:01:47,940 - validate - WARNING - started the get_current_date method...
2024-02-14 09:01:50,322 - validate - WARNING - Validation done, go forward...
2024-02-14 09:01:50,322 - root - INFO - Reading file which is of > parquet
2024-02-14 09:01:50,322 - infest - WARNING - Load_file method started...
2024-02-14 09:01:50,754 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:01:50,757 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:01:52,047 - root - INFO - validating the dataframe...
2024-02-14 09:01:52,047 - infest - WARNING - here to count the records in the df
2024-02-14 09:01:52,411 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:01:52,411 - infest - WARNING - Load_file method started...
2024-02-14 09:01:52,752 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:01:52,754 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:01:52,937 - root - INFO - validating the dataframe...
2024-02-14 09:01:52,937 - infest - WARNING - here to count the records in the df
2024-02-14 09:01:53,642 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:01:53,642 - root - INFO - implementing data processing...
2024-02-14 09:01:53,643 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:01:53,643 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:01:53,667 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:01:53,680 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:01:53,689 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:01:53,715 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:01:53,728 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:01:53,728 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:01:53,742 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:01:55,849 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:01:55,849 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:01:55,849 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:01:56,095 - root - INFO - validating schema for dataframe....
2024-02-14 09:01:56,095 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:01:56,096 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:01:56,096 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:01:56,096 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:01:56,096 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:01:56,096 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:01:56,096 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:01:56,096 - validate - INFO - print schema done, go forward....
2024-02-14 09:01:56,096 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:01:56,097 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:01:56,097 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:01:56,097 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:01:56,097 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:01:56,097 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:01:56,097 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:01:56,098 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:01:56,098 - validate - INFO - print schema done, go forward....
2024-02-14 09:01:56,210 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:01:56,210 - root - INFO - transformation data processing....
2024-02-14 09:01:56,210 - root - INFO - displaying the df_report_1
2024-02-14 09:01:56,210 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:01:56,211 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:01:56,242 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:01:56,269 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:01:56,306 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:01:56,306 - root - INFO - display data_report2 method...
2024-02-14 09:01:56,306 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:01:56,306 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:01:56,392 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:02:02,874 - root - INFO - extracting files output....
2024-02-14 09:02:02,874 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:02:09,255 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:02:09,337 - root - INFO - show read data spark...
2024-02-14 09:02:14,184 - root - INFO - writing into have table
2024-02-14 09:02:14,184 - root - INFO - successfully written into Hive
2024-02-14 09:02:14,185 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:02:38,466 - root - INFO - i am the main method...
2024-02-14 09:02:38,466 - root - INFO - calling spark object
2024-02-14 09:02:38,466 - create_spark - INFO - get_spark_object method started
2024-02-14 09:02:38,466 - create_spark - INFO - master is local
2024-02-14 09:02:41,423 - create_spark - INFO - Spark object create....
2024-02-14 09:02:41,424 - root - INFO - Validating spark object.......
2024-02-14 09:02:41,424 - validate - WARNING - started the get_current_date method...
2024-02-14 09:02:43,827 - validate - WARNING - Validation done, go forward...
2024-02-14 09:02:43,827 - root - INFO - Reading file which is of > parquet
2024-02-14 09:02:43,827 - infest - WARNING - Load_file method started...
2024-02-14 09:02:44,288 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:02:44,291 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:02:45,555 - root - INFO - validating the dataframe...
2024-02-14 09:02:45,555 - infest - WARNING - here to count the records in the df
2024-02-14 09:02:45,938 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:02:45,939 - infest - WARNING - Load_file method started...
2024-02-14 09:02:46,348 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:02:46,350 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:02:46,561 - root - INFO - validating the dataframe...
2024-02-14 09:02:46,561 - infest - WARNING - here to count the records in the df
2024-02-14 09:02:47,128 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:02:47,128 - root - INFO - implementing data processing...
2024-02-14 09:02:47,129 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:02:47,129 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:02:47,155 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:02:47,168 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:02:47,177 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:02:47,202 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:02:47,214 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:02:47,214 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:02:47,229 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:02:49,315 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:02:49,315 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:02:49,315 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:02:49,560 - root - INFO - validating schema for dataframe....
2024-02-14 09:02:49,560 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:02:49,561 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:02:49,561 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:02:49,561 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:02:49,561 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:02:49,561 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:02:49,561 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:02:49,561 - validate - INFO - print schema done, go forward....
2024-02-14 09:02:49,561 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:02:49,562 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:02:49,562 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:02:49,562 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:02:49,563 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:02:49,563 - validate - INFO - print schema done, go forward....
2024-02-14 09:02:49,663 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:02:49,663 - root - INFO - transformation data processing....
2024-02-14 09:02:49,663 - root - INFO - displaying the df_report_1
2024-02-14 09:02:49,663 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:02:49,664 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:02:49,690 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:02:49,717 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:02:49,753 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:02:49,753 - root - INFO - display data_report2 method...
2024-02-14 09:02:49,753 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:02:49,753 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:02:49,826 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:02:56,207 - root - INFO - extracting files output....
2024-02-14 09:02:56,207 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:03:02,894 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:03:02,979 - root - INFO - show read data spark...
2024-02-14 09:03:08,075 - root - INFO - writing into have table
2024-02-14 09:03:08,075 - root - INFO - successfully written into Hive
2024-02-14 09:03:08,076 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:03:21,682 - root - INFO - i am the main method...
2024-02-14 09:03:21,682 - root - INFO - calling spark object
2024-02-14 09:03:21,682 - create_spark - INFO - get_spark_object method started
2024-02-14 09:03:21,682 - create_spark - INFO - master is local
2024-02-14 09:03:24,650 - create_spark - INFO - Spark object create....
2024-02-14 09:03:24,650 - root - INFO - Validating spark object.......
2024-02-14 09:03:24,650 - validate - WARNING - started the get_current_date method...
2024-02-14 09:03:27,070 - validate - WARNING - Validation done, go forward...
2024-02-14 09:03:27,071 - root - INFO - Reading file which is of > parquet
2024-02-14 09:03:27,071 - infest - WARNING - Load_file method started...
2024-02-14 09:03:27,527 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:03:27,530 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:03:28,773 - root - INFO - validating the dataframe...
2024-02-14 09:03:28,773 - infest - WARNING - here to count the records in the df
2024-02-14 09:03:29,118 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:03:29,119 - infest - WARNING - Load_file method started...
2024-02-14 09:03:29,493 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:03:29,495 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:03:29,706 - root - INFO - validating the dataframe...
2024-02-14 09:03:29,706 - infest - WARNING - here to count the records in the df
2024-02-14 09:03:30,211 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:03:30,211 - root - INFO - implementing data processing...
2024-02-14 09:03:30,211 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:03:30,211 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:03:30,240 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:03:30,256 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:03:30,264 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:03:30,293 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:03:30,308 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:03:30,308 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:03:30,323 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:03:32,465 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:03:32,465 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:03:32,465 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:03:32,694 - root - INFO - validating schema for dataframe....
2024-02-14 09:03:32,694 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:03:32,695 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:03:32,695 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:03:32,695 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:03:32,695 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:03:32,695 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:03:32,695 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:03:32,695 - validate - INFO - print schema done, go forward....
2024-02-14 09:03:32,695 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:03:32,697 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:03:32,697 - validate - INFO - print schema done, go forward....
2024-02-14 09:03:32,797 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:03:32,797 - root - INFO - transformation data processing....
2024-02-14 09:03:32,797 - root - INFO - displaying the df_report_1
2024-02-14 09:03:32,797 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:03:32,798 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:03:32,826 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:03:32,853 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:03:32,890 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:03:32,891 - root - INFO - display data_report2 method...
2024-02-14 09:03:32,891 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:03:32,891 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:03:32,971 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:03:39,202 - root - INFO - extracting files output....
2024-02-14 09:03:39,202 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:03:46,143 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:03:46,229 - root - INFO - show read data spark...
2024-02-14 09:03:51,840 - root - INFO - writing into have table
2024-02-14 09:03:51,841 - root - INFO - successfully written into Hive
2024-02-14 09:03:51,842 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:10:44,456 - root - INFO - i am the main method...
2024-02-14 09:10:44,456 - root - INFO - calling spark object
2024-02-14 09:10:44,456 - create_spark - INFO - get_spark_object method started
2024-02-14 09:10:44,456 - create_spark - INFO - master is local
2024-02-14 09:10:49,473 - create_spark - INFO - Spark object create....
2024-02-14 09:10:49,474 - root - INFO - Validating spark object.......
2024-02-14 09:10:49,474 - validate - WARNING - started the get_current_date method...
2024-02-14 09:10:52,045 - validate - WARNING - Validation done, go forward...
2024-02-14 09:10:52,045 - root - INFO - Reading file which is of > parquet
2024-02-14 09:10:52,045 - infest - WARNING - Load_file method started...
2024-02-14 09:10:52,501 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:10:52,504 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:10:53,895 - root - INFO - validating the dataframe...
2024-02-14 09:10:53,895 - infest - WARNING - here to count the records in the df
2024-02-14 09:10:54,300 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:10:54,300 - infest - WARNING - Load_file method started...
2024-02-14 09:10:54,689 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:10:54,691 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:10:54,907 - root - INFO - validating the dataframe...
2024-02-14 09:10:54,907 - infest - WARNING - here to count the records in the df
2024-02-14 09:10:55,537 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:10:55,537 - root - INFO - implementing data processing...
2024-02-14 09:10:55,537 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:10:55,537 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:10:55,568 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:10:55,584 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:10:55,595 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:10:55,625 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:10:55,644 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:10:55,645 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:10:55,667 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:10:57,971 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:10:57,972 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:10:57,972 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:10:58,218 - root - INFO - validating schema for dataframe....
2024-02-14 09:10:58,218 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:10:58,219 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:10:58,220 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:10:58,220 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:10:58,220 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:10:58,220 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:10:58,220 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:10:58,220 - validate - INFO - print schema done, go forward....
2024-02-14 09:10:58,220 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:10:58,221 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:10:58,221 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:10:58,221 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:10:58,221 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:10:58,222 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:10:58,222 - validate - INFO - print schema done, go forward....
2024-02-14 09:10:58,323 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:10:58,323 - root - INFO - transformation data processing....
2024-02-14 09:10:58,323 - root - INFO - displaying the df_report_1
2024-02-14 09:10:58,323 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:10:58,324 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:10:58,354 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:10:58,387 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:10:58,429 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:10:58,429 - root - INFO - display data_report2 method...
2024-02-14 09:10:58,429 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:10:58,429 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:10:58,508 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:11:05,234 - root - INFO - extracting files output....
2024-02-14 09:11:05,234 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:11:12,073 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:11:12,159 - root - INFO - show read data spark...
2024-02-14 09:11:17,419 - root - INFO - writing into have table
2024-02-14 09:11:17,420 - root - INFO - successfully written into Hive
2024-02-14 09:11:17,421 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:11:20,660 - root - INFO - total amount of time taken: 36.20882510000001 seconds...
2024-02-14 09:11:20,660 - root - INFO - Application done
2024-02-14 09:11:30,371 - root - INFO - i am the main method...
2024-02-14 09:11:30,372 - root - INFO - calling spark object
2024-02-14 09:11:30,372 - create_spark - INFO - get_spark_object method started
2024-02-14 09:11:30,372 - create_spark - INFO - master is local
2024-02-14 09:11:33,499 - create_spark - INFO - Spark object create....
2024-02-14 09:11:33,499 - root - INFO - Validating spark object.......
2024-02-14 09:11:33,499 - validate - WARNING - started the get_current_date method...
2024-02-14 09:11:35,981 - validate - WARNING - Validation done, go forward...
2024-02-14 09:11:35,982 - root - INFO - Reading file which is of > parquet
2024-02-14 09:11:35,982 - infest - WARNING - Load_file method started...
2024-02-14 09:11:36,422 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 09:11:36,425 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 09:11:37,776 - root - INFO - validating the dataframe...
2024-02-14 09:11:37,776 - infest - WARNING - here to count the records in the df
2024-02-14 09:11:38,182 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 09:11:38,183 - infest - WARNING - Load_file method started...
2024-02-14 09:11:38,543 - infest - WARNING - dataframe created  which is if csv
2024-02-14 09:11:38,545 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 09:11:38,741 - root - INFO - validating the dataframe...
2024-02-14 09:11:38,741 - infest - WARNING - here to count the records in the df
2024-02-14 09:11:39,320 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 09:11:39,321 - root - INFO - implementing data processing...
2024-02-14 09:11:39,321 - data_processing - WARNING - data_clean method() stating....
2024-02-14 09:11:39,321 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 09:11:39,348 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 09:11:39,363 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 09:11:39,372 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 09:11:39,400 - data_processing - WARNING - concat firstName and lastName
2024-02-14 09:11:39,416 - data_processing - WARNING - now check for null values in all column
2024-02-14 09:11:39,416 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 09:11:39,433 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 09:11:41,718 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 09:11:41,718 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 09:11:41,718 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 09:11:41,999 - root - INFO - validating schema for dataframe....
2024-02-14 09:11:41,999 - validate - WARNING - printing schema method starting... df_city
2024-02-14 09:11:42,000 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 09:11:42,000 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 09:11:42,000 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 09:11:42,000 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 09:11:42,000 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 09:11:42,000 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 09:11:42,000 - validate - INFO - print schema done, go forward....
2024-02-14 09:11:42,000 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 09:11:42,001 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 09:11:42,002 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 09:11:42,002 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 09:11:42,002 - validate - INFO - print schema done, go forward....
2024-02-14 09:11:42,119 - root - INFO - checking null values schema for dataframe....
2024-02-14 09:11:42,119 - root - INFO - transformation data processing....
2024-02-14 09:11:42,119 - root - INFO - displaying the df_report_1
2024-02-14 09:11:42,119 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 09:11:42,120 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 09:11:42,149 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 09:11:42,185 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 09:11:42,232 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 09:11:42,232 - root - INFO - display data_report2 method...
2024-02-14 09:11:42,232 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 09:11:42,232 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 09:11:42,325 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 09:11:48,973 - root - INFO - extracting files output....
2024-02-14 09:11:48,973 - extraction - WARNING - extracting_file method starting....
2024-02-14 09:11:55,591 - extraction - WARNING - extract_file method successfully...
2024-02-14 09:11:55,688 - root - INFO - show read data spark...
2024-02-14 09:12:00,900 - root - INFO - writing into have table
2024-02-14 09:12:00,901 - root - INFO - successfully written into Hive
2024-02-14 09:12:00,901 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 09:12:04,720 - root - INFO - total amount of time taken: 34.354074599999876 seconds...
2024-02-14 09:12:04,720 - root - INFO - Application done
2024-02-14 10:54:56,947 - root - INFO - i am the main method...
2024-02-14 10:54:56,947 - root - INFO - calling spark object
2024-02-14 10:54:56,947 - create_spark - INFO - get_spark_object method started
2024-02-14 10:54:56,947 - create_spark - INFO - master is local
2024-02-14 10:55:00,982 - create_spark - INFO - Spark object create....
2024-02-14 10:55:00,983 - root - INFO - Validating spark object.......
2024-02-14 10:55:00,983 - validate - WARNING - started the get_current_date method...
2024-02-14 10:55:03,218 - validate - WARNING - Validation done, go forward...
2024-02-14 10:55:03,219 - root - INFO - Reading file which is of > parquet
2024-02-14 10:55:03,219 - infest - WARNING - Load_file method started...
2024-02-14 10:55:03,699 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 10:55:03,702 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 10:55:04,958 - root - INFO - validating the dataframe...
2024-02-14 10:55:04,958 - infest - WARNING - here to count the records in the df
2024-02-14 10:55:05,315 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 10:55:05,315 - infest - WARNING - Load_file method started...
2024-02-14 10:55:05,638 - infest - WARNING - dataframe created  which is if csv
2024-02-14 10:55:05,640 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 10:55:05,817 - root - INFO - validating the dataframe...
2024-02-14 10:55:05,817 - infest - WARNING - here to count the records in the df
2024-02-14 10:55:06,320 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 10:55:06,320 - root - INFO - implementing data processing...
2024-02-14 10:55:06,320 - data_processing - WARNING - data_clean method() stating....
2024-02-14 10:55:06,320 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 10:55:06,351 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 10:55:06,365 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 10:55:06,373 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 10:55:06,399 - data_processing - WARNING - concat firstName and lastName
2024-02-14 10:55:06,412 - data_processing - WARNING - now check for null values in all column
2024-02-14 10:55:06,412 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 10:55:06,429 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 10:55:08,581 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 10:55:08,581 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 10:55:08,581 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 10:55:08,835 - root - INFO - validating schema for dataframe....
2024-02-14 10:55:08,835 - validate - WARNING - printing schema method starting... df_city
2024-02-14 10:55:08,837 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 10:55:08,837 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 10:55:08,837 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 10:55:08,837 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 10:55:08,837 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 10:55:08,837 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 10:55:08,837 - validate - INFO - print schema done, go forward....
2024-02-14 10:55:08,837 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 10:55:08,838 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 10:55:08,839 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 10:55:08,839 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 10:55:08,839 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 10:55:08,839 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 10:55:08,839 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 10:55:08,839 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 10:55:08,839 - validate - INFO - print schema done, go forward....
2024-02-14 10:55:08,942 - root - INFO - checking null values schema for dataframe....
2024-02-14 10:55:08,942 - root - INFO - transformation data processing....
2024-02-14 10:55:08,942 - root - INFO - displaying the df_report_1
2024-02-14 10:55:08,942 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 10:55:08,943 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 10:55:08,973 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 10:55:08,999 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 10:55:09,030 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 10:55:09,030 - root - INFO - display data_report2 method...
2024-02-14 10:55:09,031 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 10:55:09,031 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 10:55:09,093 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 10:55:15,350 - root - INFO - extracting files output....
2024-02-14 10:55:15,350 - extraction - WARNING - extracting_file method starting....
2024-02-14 10:55:21,495 - extraction - WARNING - extract_file method successfully...
2024-02-14 10:55:21,571 - root - INFO - show read data spark...
2024-02-14 10:55:25,957 - root - INFO - writing into have table
2024-02-14 10:55:25,957 - root - INFO - successfully written into Hive
2024-02-14 10:55:25,958 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 10:55:59,203 - root - INFO - i am the main method...
2024-02-14 10:55:59,203 - root - INFO - calling spark object
2024-02-14 10:55:59,203 - create_spark - INFO - get_spark_object method started
2024-02-14 10:55:59,203 - create_spark - INFO - master is local
2024-02-14 10:56:02,136 - create_spark - INFO - Spark object create....
2024-02-14 10:56:02,136 - root - INFO - Validating spark object.......
2024-02-14 10:56:02,136 - validate - WARNING - started the get_current_date method...
2024-02-14 10:56:04,333 - validate - WARNING - Validation done, go forward...
2024-02-14 10:56:04,333 - root - INFO - Reading file which is of > parquet
2024-02-14 10:56:04,333 - infest - WARNING - Load_file method started...
2024-02-14 10:56:04,745 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 10:56:04,749 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 10:56:06,050 - root - INFO - validating the dataframe...
2024-02-14 10:56:06,050 - infest - WARNING - here to count the records in the df
2024-02-14 10:56:06,488 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 10:56:06,489 - infest - WARNING - Load_file method started...
2024-02-14 10:56:06,937 - infest - WARNING - dataframe created  which is if csv
2024-02-14 10:56:06,940 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 10:56:07,193 - root - INFO - validating the dataframe...
2024-02-14 10:56:07,193 - infest - WARNING - here to count the records in the df
2024-02-14 10:56:07,752 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 10:56:07,753 - root - INFO - implementing data processing...
2024-02-14 10:56:07,753 - data_processing - WARNING - data_clean method() stating....
2024-02-14 10:56:07,753 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 10:56:07,782 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 10:56:07,796 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 10:56:07,806 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 10:56:07,836 - data_processing - WARNING - concat firstName and lastName
2024-02-14 10:56:07,852 - data_processing - WARNING - now check for null values in all column
2024-02-14 10:56:07,852 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 10:56:07,872 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 10:56:10,057 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 10:56:10,057 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 10:56:10,057 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 10:56:10,305 - root - INFO - validating schema for dataframe....
2024-02-14 10:56:10,305 - validate - WARNING - printing schema method starting... df_city
2024-02-14 10:56:10,306 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 10:56:10,306 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 10:56:10,306 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 10:56:10,306 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 10:56:10,306 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 10:56:10,306 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 10:56:10,306 - validate - INFO - print schema done, go forward....
2024-02-14 10:56:10,306 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 10:56:10,307 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 10:56:10,307 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 10:56:10,307 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 10:56:10,307 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 10:56:10,307 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 10:56:10,307 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 10:56:10,308 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 10:56:10,308 - validate - INFO - print schema done, go forward....
2024-02-14 10:56:10,420 - root - INFO - checking null values schema for dataframe....
2024-02-14 10:56:10,420 - root - INFO - transformation data processing....
2024-02-14 10:56:10,420 - root - INFO - displaying the df_report_1
2024-02-14 10:56:10,420 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 10:56:10,421 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 10:56:10,449 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 10:56:10,481 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 10:56:10,521 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 10:56:10,521 - root - INFO - display data_report2 method...
2024-02-14 10:56:10,521 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 10:56:10,521 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 10:56:10,592 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 10:56:16,741 - root - INFO - extracting files output....
2024-02-14 10:56:16,742 - extraction - WARNING - extracting_file method starting....
2024-02-14 10:56:22,762 - extraction - WARNING - extract_file method successfully...
2024-02-14 10:56:22,840 - root - INFO - show read data spark...
2024-02-14 10:56:27,758 - root - INFO - writing into have table
2024-02-14 10:56:27,758 - root - INFO - successfully written into Hive
2024-02-14 10:56:27,758 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 10:56:32,356 - root - INFO - total amount of time taken: 33.15520089999882 seconds...
2024-02-14 10:56:32,356 - root - INFO - Application done
2024-02-14 11:01:21,535 - root - INFO - i am the main method...
2024-02-14 11:01:21,535 - root - INFO - calling spark object
2024-02-14 11:01:21,535 - create_spark - INFO - get_spark_object method started
2024-02-14 11:01:21,535 - create_spark - INFO - master is local
2024-02-14 11:01:24,355 - create_spark - INFO - Spark object create....
2024-02-14 11:01:24,355 - root - INFO - Validating spark object.......
2024-02-14 11:01:24,355 - validate - WARNING - started the get_current_date method...
2024-02-14 11:01:26,652 - validate - WARNING - Validation done, go forward...
2024-02-14 11:01:26,652 - root - INFO - Reading file which is of > parquet
2024-02-14 11:01:26,652 - infest - WARNING - Load_file method started...
2024-02-14 11:01:27,060 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:01:27,063 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:01:28,312 - root - INFO - validating the dataframe...
2024-02-14 11:01:28,312 - infest - WARNING - here to count the records in the df
2024-02-14 11:01:28,662 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:01:28,663 - infest - WARNING - Load_file method started...
2024-02-14 11:01:29,006 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:01:29,008 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:01:29,202 - root - INFO - validating the dataframe...
2024-02-14 11:01:29,202 - infest - WARNING - here to count the records in the df
2024-02-14 11:01:29,774 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:01:29,774 - root - INFO - implementing data processing...
2024-02-14 11:01:29,774 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:01:29,774 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:01:29,803 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:01:29,818 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:01:29,829 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:01:29,858 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:01:29,871 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:01:29,872 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:01:29,888 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:01:32,003 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:01:32,003 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:01:32,003 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:01:32,269 - root - INFO - validating schema for dataframe....
2024-02-14 11:01:32,269 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:01:32,270 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:01:32,270 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:01:32,270 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:01:32,270 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:01:32,270 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:01:32,270 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:01:32,270 - validate - INFO - print schema done, go forward....
2024-02-14 11:01:32,270 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:01:32,271 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:01:32,272 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:01:32,272 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:01:32,272 - validate - INFO - print schema done, go forward....
2024-02-14 11:01:32,377 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:01:32,377 - root - INFO - transformation data processing....
2024-02-14 11:01:32,377 - root - INFO - displaying the df_report_1
2024-02-14 11:01:32,377 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:01:32,378 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:01:32,409 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:01:32,445 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:01:32,487 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:01:32,487 - root - INFO - display data_report2 method...
2024-02-14 11:01:32,487 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:01:32,487 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:01:32,560 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:01:38,806 - root - INFO - extracting files output....
2024-02-14 11:01:38,806 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:01:45,044 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:01:45,118 - root - INFO - show read data spark...
2024-02-14 11:01:49,851 - root - INFO - writing into have table
2024-02-14 11:01:49,851 - root - INFO - successfully written into Hive
2024-02-14 11:01:49,852 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:01:54,115 - root - INFO - total amount of time taken: 32.58145250000052 seconds...
2024-02-14 11:01:54,115 - root - INFO - Application done
2024-02-14 11:03:45,825 - root - INFO - i am the main method...
2024-02-14 11:03:45,825 - root - INFO - calling spark object
2024-02-14 11:03:45,825 - create_spark - INFO - get_spark_object method started
2024-02-14 11:03:45,825 - create_spark - INFO - master is local
2024-02-14 11:03:48,749 - create_spark - INFO - Spark object create....
2024-02-14 11:03:48,749 - root - INFO - Validating spark object.......
2024-02-14 11:03:48,750 - validate - WARNING - started the get_current_date method...
2024-02-14 11:03:51,131 - validate - WARNING - Validation done, go forward...
2024-02-14 11:03:51,132 - root - INFO - Reading file which is of > parquet
2024-02-14 11:03:51,132 - infest - WARNING - Load_file method started...
2024-02-14 11:03:51,559 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:03:51,562 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:03:52,793 - root - INFO - validating the dataframe...
2024-02-14 11:03:52,793 - infest - WARNING - here to count the records in the df
2024-02-14 11:03:53,181 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:03:53,182 - infest - WARNING - Load_file method started...
2024-02-14 11:03:53,552 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:03:53,554 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:03:53,749 - root - INFO - validating the dataframe...
2024-02-14 11:03:53,749 - infest - WARNING - here to count the records in the df
2024-02-14 11:03:54,387 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:03:54,388 - root - INFO - implementing data processing...
2024-02-14 11:03:54,388 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:03:54,388 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:03:54,410 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:03:54,421 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:03:54,429 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:03:54,451 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:03:54,465 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:03:54,465 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:03:54,480 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:03:56,554 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:03:56,555 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:03:56,555 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:03:56,789 - root - INFO - validating schema for dataframe....
2024-02-14 11:03:56,789 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:03:56,790 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:03:56,790 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:03:56,790 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:03:56,790 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:03:56,790 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:03:56,790 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:03:56,790 - validate - INFO - print schema done, go forward....
2024-02-14 11:03:56,790 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:03:56,791 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:03:56,791 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:03:56,792 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:03:56,792 - validate - INFO - print schema done, go forward....
2024-02-14 11:03:56,899 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:03:56,899 - root - INFO - transformation data processing....
2024-02-14 11:03:56,899 - root - INFO - displaying the df_report_1
2024-02-14 11:03:56,899 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:03:56,900 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:03:56,931 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:03:56,962 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:03:57,003 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:03:57,003 - root - INFO - display data_report2 method...
2024-02-14 11:03:57,003 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:03:57,003 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:03:57,082 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:04:03,275 - root - INFO - extracting files output....
2024-02-14 11:04:03,275 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:04:09,202 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:04:09,289 - root - INFO - show read data spark...
2024-02-14 11:04:14,021 - root - INFO - writing into have table
2024-02-14 11:04:14,021 - root - INFO - successfully written into Hive
2024-02-14 11:04:14,022 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:12:52,375 - root - INFO - i am the main method...
2024-02-14 11:12:52,375 - root - INFO - calling spark object
2024-02-14 11:12:52,375 - create_spark - INFO - get_spark_object method started
2024-02-14 11:12:52,375 - create_spark - INFO - master is local
2024-02-14 11:12:55,361 - create_spark - INFO - Spark object create....
2024-02-14 11:12:55,361 - root - INFO - Validating spark object.......
2024-02-14 11:12:55,361 - validate - WARNING - started the get_current_date method...
2024-02-14 11:12:57,774 - validate - WARNING - Validation done, go forward...
2024-02-14 11:12:57,775 - root - INFO - Reading file which is of > parquet
2024-02-14 11:12:57,775 - infest - WARNING - Load_file method started...
2024-02-14 11:12:58,204 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:12:58,207 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:12:59,521 - root - INFO - validating the dataframe...
2024-02-14 11:12:59,521 - infest - WARNING - here to count the records in the df
2024-02-14 11:12:59,907 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:12:59,907 - infest - WARNING - Load_file method started...
2024-02-14 11:13:00,262 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:13:00,263 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:13:00,461 - root - INFO - validating the dataframe...
2024-02-14 11:13:00,461 - infest - WARNING - here to count the records in the df
2024-02-14 11:13:01,066 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:13:01,066 - root - INFO - implementing data processing...
2024-02-14 11:13:01,066 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:13:01,066 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:13:01,096 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:13:01,112 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:13:01,122 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:13:01,151 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:13:01,165 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:13:01,166 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:13:01,182 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:13:03,443 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:13:03,443 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:13:03,443 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:13:03,713 - root - INFO - validating schema for dataframe....
2024-02-14 11:13:03,713 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:13:03,714 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:13:03,714 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:13:03,714 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:13:03,714 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:13:03,714 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:13:03,714 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:13:03,714 - validate - INFO - print schema done, go forward....
2024-02-14 11:13:03,715 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:13:03,716 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:13:03,716 - validate - INFO - print schema done, go forward....
2024-02-14 11:13:03,828 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:13:03,828 - root - INFO - transformation data processing....
2024-02-14 11:13:03,828 - root - INFO - displaying the df_report_1
2024-02-14 11:13:03,828 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:13:03,829 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:13:03,855 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:13:03,889 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:13:03,927 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:13:03,927 - root - INFO - display data_report2 method...
2024-02-14 11:13:03,927 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:13:03,927 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:13:04,002 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:13:10,511 - root - INFO - extracting files output....
2024-02-14 11:13:10,512 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:13:17,340 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:13:17,430 - root - INFO - show read data spark...
2024-02-14 11:13:22,360 - root - INFO - writing into have table
2024-02-14 11:13:22,360 - root - INFO - successfully written into Hive
2024-02-14 11:13:22,361 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:25:50,706 - root - INFO - i am the main method...
2024-02-14 11:25:50,707 - root - INFO - calling spark object
2024-02-14 11:25:50,707 - create_spark - INFO - get_spark_object method started
2024-02-14 11:25:50,707 - create_spark - INFO - master is local
2024-02-14 11:25:53,938 - create_spark - INFO - Spark object create....
2024-02-14 11:25:53,938 - root - INFO - Validating spark object.......
2024-02-14 11:25:53,938 - validate - WARNING - started the get_current_date method...
2024-02-14 11:25:56,568 - validate - WARNING - Validation done, go forward...
2024-02-14 11:25:56,568 - root - INFO - Reading file which is of > parquet
2024-02-14 11:25:56,568 - infest - WARNING - Load_file method started...
2024-02-14 11:25:57,055 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:25:57,058 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:25:58,370 - root - INFO - validating the dataframe...
2024-02-14 11:25:58,370 - infest - WARNING - here to count the records in the df
2024-02-14 11:25:58,785 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:25:58,785 - infest - WARNING - Load_file method started...
2024-02-14 11:25:59,223 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:25:59,225 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:25:59,477 - root - INFO - validating the dataframe...
2024-02-14 11:25:59,477 - infest - WARNING - here to count the records in the df
2024-02-14 11:26:00,181 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:26:00,181 - root - INFO - implementing data processing...
2024-02-14 11:26:00,181 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:26:00,181 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:26:00,208 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:26:00,222 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:26:00,231 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:26:00,257 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:26:00,270 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:26:00,270 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:26:00,285 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:26:02,806 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:26:02,806 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:26:02,807 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:26:03,052 - root - INFO - validating schema for dataframe....
2024-02-14 11:26:03,052 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:26:03,053 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:26:03,053 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:26:03,053 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:26:03,053 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:26:03,053 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:26:03,053 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:26:03,053 - validate - INFO - print schema done, go forward....
2024-02-14 11:26:03,053 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:26:03,054 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:26:03,054 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:26:03,054 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:26:03,054 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:26:03,055 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:26:03,055 - validate - INFO - print schema done, go forward....
2024-02-14 11:26:03,158 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:26:03,158 - root - INFO - transformation data processing....
2024-02-14 11:26:03,158 - root - INFO - displaying the df_report_1
2024-02-14 11:26:03,158 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:26:03,159 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:26:03,189 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:26:03,224 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:26:03,269 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:26:03,269 - root - INFO - display data_report2 method...
2024-02-14 11:26:03,269 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:26:03,269 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:26:03,357 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:26:10,154 - root - INFO - extracting files output....
2024-02-14 11:26:10,155 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:26:16,825 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:26:16,911 - root - INFO - show read data spark...
2024-02-14 11:26:22,052 - root - INFO - writing into have table
2024-02-14 11:26:22,053 - root - INFO - successfully written into Hive
2024-02-14 11:26:22,054 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:27:12,708 - root - INFO - i am the main method...
2024-02-14 11:27:12,708 - root - INFO - calling spark object
2024-02-14 11:27:12,708 - create_spark - INFO - get_spark_object method started
2024-02-14 11:27:12,708 - create_spark - INFO - master is local
2024-02-14 11:27:16,069 - create_spark - INFO - Spark object create....
2024-02-14 11:27:16,069 - root - INFO - Validating spark object.......
2024-02-14 11:27:16,069 - validate - WARNING - started the get_current_date method...
2024-02-14 11:27:18,574 - validate - WARNING - Validation done, go forward...
2024-02-14 11:27:18,574 - root - INFO - Reading file which is of > parquet
2024-02-14 11:27:18,574 - infest - WARNING - Load_file method started...
2024-02-14 11:27:19,013 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:27:19,016 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:27:20,348 - root - INFO - validating the dataframe...
2024-02-14 11:27:20,348 - infest - WARNING - here to count the records in the df
2024-02-14 11:27:20,744 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:27:20,745 - infest - WARNING - Load_file method started...
2024-02-14 11:27:21,134 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:27:21,136 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:27:21,361 - root - INFO - validating the dataframe...
2024-02-14 11:27:21,361 - infest - WARNING - here to count the records in the df
2024-02-14 11:27:21,957 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:27:21,958 - root - INFO - implementing data processing...
2024-02-14 11:27:21,958 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:27:21,958 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:27:21,983 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:27:21,998 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:27:22,007 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:27:22,036 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:27:22,051 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:27:22,051 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:27:22,069 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:27:24,309 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:27:24,309 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:27:24,309 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:27:24,585 - root - INFO - validating schema for dataframe....
2024-02-14 11:27:24,585 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:27:24,586 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:27:24,586 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:27:24,586 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:27:24,586 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:27:24,586 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:27:24,586 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:27:24,586 - validate - INFO - print schema done, go forward....
2024-02-14 11:27:24,586 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:27:24,587 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:27:24,587 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:27:24,587 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:27:24,588 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:27:24,588 - validate - INFO - print schema done, go forward....
2024-02-14 11:27:24,697 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:27:24,697 - root - INFO - transformation data processing....
2024-02-14 11:27:24,697 - root - INFO - displaying the df_report_1
2024-02-14 11:27:24,697 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:27:24,698 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:27:24,727 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:27:24,757 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:27:24,803 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:27:24,803 - root - INFO - display data_report2 method...
2024-02-14 11:27:24,803 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:27:24,803 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:27:24,883 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:27:31,039 - root - INFO - extracting files output....
2024-02-14 11:27:31,039 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:27:37,158 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:27:37,240 - root - INFO - show read data spark...
2024-02-14 11:27:42,068 - root - INFO - writing into have table
2024-02-14 11:27:42,068 - root - INFO - successfully written into Hive
2024-02-14 11:27:42,069 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:27:46,824 - root - INFO - total amount of time taken: 34.11743700000079 seconds...
2024-02-14 11:27:46,825 - root - INFO - Application done
2024-02-14 11:44:21,466 - root - INFO - i am the main method...
2024-02-14 11:44:21,466 - root - INFO - calling spark object
2024-02-14 11:44:21,466 - create_spark - INFO - get_spark_object method started
2024-02-14 11:44:21,466 - create_spark - INFO - master is local
2024-02-14 11:44:24,499 - create_spark - INFO - Spark object create....
2024-02-14 11:44:24,499 - root - INFO - Validating spark object.......
2024-02-14 11:44:24,499 - validate - WARNING - started the get_current_date method...
2024-02-14 11:44:26,938 - validate - WARNING - Validation done, go forward...
2024-02-14 11:44:26,938 - root - INFO - Reading file which is of > parquet
2024-02-14 11:44:26,938 - infest - WARNING - Load_file method started...
2024-02-14 11:44:27,426 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:44:27,428 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:44:28,761 - root - INFO - validating the dataframe...
2024-02-14 11:44:28,761 - infest - WARNING - here to count the records in the df
2024-02-14 11:44:29,140 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:44:29,141 - infest - WARNING - Load_file method started...
2024-02-14 11:44:29,501 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:44:29,503 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:44:29,704 - root - INFO - validating the dataframe...
2024-02-14 11:44:29,704 - infest - WARNING - here to count the records in the df
2024-02-14 11:44:30,370 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:44:30,370 - root - INFO - implementing data processing...
2024-02-14 11:44:30,370 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:44:30,370 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:44:30,396 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:44:30,411 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:44:30,421 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:44:30,448 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:44:30,462 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:44:30,462 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:44:30,482 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:44:32,754 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:44:32,755 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:44:32,755 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:44:33,045 - root - INFO - validating schema for dataframe....
2024-02-14 11:44:33,045 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:44:33,046 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:44:33,046 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:44:33,046 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:44:33,046 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:44:33,046 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:44:33,046 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:44:33,046 - validate - INFO - print schema done, go forward....
2024-02-14 11:44:33,046 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:44:33,047 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:44:33,047 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:44:33,047 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:44:33,048 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:44:33,048 - validate - INFO - print schema done, go forward....
2024-02-14 11:44:33,153 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:44:33,153 - root - INFO - transformation data processing....
2024-02-14 11:44:33,153 - root - INFO - displaying the df_report_1
2024-02-14 11:44:33,153 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:44:33,154 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:44:33,182 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:44:33,219 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:44:33,260 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:44:33,260 - root - INFO - display data_report2 method...
2024-02-14 11:44:33,260 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:44:33,260 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:44:33,331 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:44:39,739 - root - INFO - extracting files output....
2024-02-14 11:44:39,739 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:44:46,134 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:44:46,220 - root - INFO - show read data spark...
2024-02-14 11:44:51,258 - root - INFO - writing into have table
2024-02-14 11:44:51,258 - root - INFO - successfully written into Hive
2024-02-14 11:44:51,259 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:45:10,149 - root - INFO - i am the main method...
2024-02-14 11:45:10,149 - root - INFO - calling spark object
2024-02-14 11:45:10,149 - create_spark - INFO - get_spark_object method started
2024-02-14 11:45:10,149 - create_spark - INFO - master is local
2024-02-14 11:45:13,260 - create_spark - INFO - Spark object create....
2024-02-14 11:45:13,260 - root - INFO - Validating spark object.......
2024-02-14 11:45:13,260 - validate - WARNING - started the get_current_date method...
2024-02-14 11:45:15,674 - validate - WARNING - Validation done, go forward...
2024-02-14 11:45:15,675 - root - INFO - Reading file which is of > parquet
2024-02-14 11:45:15,675 - infest - WARNING - Load_file method started...
2024-02-14 11:45:16,146 - infest - WARNING - dataframe created  which is if parquet
2024-02-14 11:45:16,149 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-02-14 11:45:17,588 - root - INFO - validating the dataframe...
2024-02-14 11:45:17,588 - infest - WARNING - here to count the records in the df
2024-02-14 11:45:17,967 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-02-14 11:45:17,967 - infest - WARNING - Load_file method started...
2024-02-14 11:45:18,352 - infest - WARNING - dataframe created  which is if csv
2024-02-14 11:45:18,353 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-02-14 11:45:18,570 - root - INFO - validating the dataframe...
2024-02-14 11:45:18,570 - infest - WARNING - here to count the records in the df
2024-02-14 11:45:19,172 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-02-14 11:45:19,172 - root - INFO - implementing data processing...
2024-02-14 11:45:19,173 - data_processing - WARNING - data_clean method() stating....
2024-02-14 11:45:19,173 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-02-14 11:45:19,200 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-02-14 11:45:19,214 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-02-14 11:45:19,222 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-02-14 11:45:19,250 - data_processing - WARNING - concat firstName and lastName
2024-02-14 11:45:19,266 - data_processing - WARNING - now check for null values in all column
2024-02-14 11:45:19,266 - data_processing - WARNING - drop the null values in the respective column...
2024-02-14 11:45:19,290 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-02-14 11:45:21,733 - data_processing - WARNING - now check for null values cleaned are not...
2024-02-14 11:45:21,733 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-02-14 11:45:21,733 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-02-14 11:45:22,077 - root - INFO - validating schema for dataframe....
2024-02-14 11:45:22,077 - validate - WARNING - printing schema method starting... df_city
2024-02-14 11:45:22,078 - validate - INFO - 	StructField('city', StringType(), True)
2024-02-14 11:45:22,078 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-02-14 11:45:22,078 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-02-14 11:45:22,079 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-02-14 11:45:22,079 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-02-14 11:45:22,079 - validate - INFO - 	StructField('zips', StringType(), True)
2024-02-14 11:45:22,079 - validate - INFO - print schema done, go forward....
2024-02-14 11:45:22,079 - validate - WARNING - printing schema method starting... df_fact
2024-02-14 11:45:22,080 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-02-14 11:45:22,080 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-02-14 11:45:22,080 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-02-14 11:45:22,080 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-02-14 11:45:22,080 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-02-14 11:45:22,081 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-02-14 11:45:22,081 - validate - INFO - print schema done, go forward....
2024-02-14 11:45:22,209 - root - INFO - checking null values schema for dataframe....
2024-02-14 11:45:22,209 - root - INFO - transformation data processing....
2024-02-14 11:45:22,209 - root - INFO - displaying the df_report_1
2024-02-14 11:45:22,209 - data_transformation - WARNING - processing the dataframe1 method....
2024-02-14 11:45:22,210 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-14 11:45:22,242 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-02-14 11:45:22,280 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-02-14 11:45:22,325 - data_transformation - WARNING - data_transformation executed successfully...
2024-02-14 11:45:22,325 - root - INFO - display data_report2 method...
2024-02-14 11:45:22,326 - data_transformation - WARNING - executing data_report2 method...
2024-02-14 11:45:22,326 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-02-14 11:45:22,409 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-02-14 11:45:29,355 - root - INFO - extracting files output....
2024-02-14 11:45:29,355 - extraction - WARNING - extracting_file method starting....
2024-02-14 11:45:36,172 - extraction - WARNING - extract_file method successfully...
2024-02-14 11:45:36,280 - root - INFO - show read data spark...
2024-02-14 11:45:41,767 - root - INFO - writing into have table
2024-02-14 11:45:41,767 - root - INFO - successfully written into Hive
2024-02-14 11:45:41,769 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-02-14 11:45:46,606 - root - INFO - total amount of time taken: 36.46281469999849 seconds...
2024-02-14 11:45:46,606 - root - INFO - Application done
2024-03-05 11:48:13,925 - root - INFO - i am the main method...
2024-03-05 11:48:13,925 - root - INFO - calling spark object
2024-03-05 11:48:13,925 - create_spark - INFO - get_spark_object method started
2024-03-05 11:48:13,925 - create_spark - INFO - master is local
2024-03-05 11:48:17,991 - create_spark - INFO - Spark object create....
2024-03-05 11:48:17,991 - root - INFO - Validating spark object.......
2024-03-05 11:48:17,991 - validate - WARNING - started the get_current_date method...
2024-03-05 11:48:21,017 - validate - WARNING - Validation done, go forward...
2024-03-05 11:48:21,018 - root - INFO - Reading file which is of > parquet
2024-03-05 11:48:21,018 - infest - WARNING - Load_file method started...
2024-03-05 11:48:21,548 - infest - WARNING - dataframe created  which is if parquet
2024-03-05 11:48:21,551 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-03-05 11:48:22,929 - root - INFO - validating the dataframe...
2024-03-05 11:48:22,929 - infest - WARNING - here to count the records in the df
2024-03-05 11:48:23,327 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-03-05 11:48:23,328 - infest - WARNING - Load_file method started...
2024-03-05 11:48:23,687 - infest - WARNING - dataframe created  which is if csv
2024-03-05 11:48:23,689 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-03-05 11:48:23,888 - root - INFO - validating the dataframe...
2024-03-05 11:48:23,888 - infest - WARNING - here to count the records in the df
2024-03-05 11:48:24,501 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-03-05 11:48:24,501 - root - INFO - implementing data processing...
2024-03-05 11:48:24,501 - data_processing - WARNING - data_clean method() stating....
2024-03-05 11:48:24,501 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-03-05 11:48:24,526 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-03-05 11:48:24,540 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-03-05 11:48:24,548 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-03-05 11:48:24,577 - data_processing - WARNING - concat firstName and lastName
2024-03-05 11:48:24,589 - data_processing - WARNING - now check for null values in all column
2024-03-05 11:48:24,590 - data_processing - WARNING - drop the null values in the respective column...
2024-03-05 11:48:24,607 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-03-05 11:48:26,787 - data_processing - WARNING - now check for null values cleaned are not...
2024-03-05 11:48:26,788 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-03-05 11:48:26,788 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-03-05 11:48:27,079 - root - INFO - validating schema for dataframe....
2024-03-05 11:48:27,079 - validate - WARNING - printing schema method starting... df_city
2024-03-05 11:48:27,081 - validate - INFO - 	StructField('city', StringType(), True)
2024-03-05 11:48:27,081 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-03-05 11:48:27,081 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-03-05 11:48:27,081 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-03-05 11:48:27,081 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-03-05 11:48:27,081 - validate - INFO - 	StructField('zips', StringType(), True)
2024-03-05 11:48:27,081 - validate - INFO - print schema done, go forward....
2024-03-05 11:48:27,081 - validate - WARNING - printing schema method starting... df_fact
2024-03-05 11:48:27,082 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-03-05 11:48:27,082 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-03-05 11:48:27,082 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-03-05 11:48:27,082 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-03-05 11:48:27,082 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-03-05 11:48:27,083 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-03-05 11:48:27,083 - validate - INFO - print schema done, go forward....
2024-03-05 11:48:27,185 - root - INFO - checking null values schema for dataframe....
2024-03-05 11:48:27,185 - root - INFO - transformation data processing....
2024-03-05 11:48:27,185 - root - INFO - displaying the df_report_1
2024-03-05 11:48:27,185 - data_transformation - WARNING - processing the dataframe1 method....
2024-03-05 11:48:27,186 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-03-05 11:48:27,223 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-03-05 11:48:27,252 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-03-05 11:48:27,289 - data_transformation - WARNING - data_transformation executed successfully...
2024-03-05 11:48:27,289 - root - INFO - display data_report2 method...
2024-03-05 11:48:27,289 - data_transformation - WARNING - executing data_report2 method...
2024-03-05 11:48:27,289 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-03-05 11:48:27,384 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-03-05 11:48:33,749 - root - INFO - extracting files output....
2024-03-05 11:48:33,750 - extraction - WARNING - extracting_file method starting....
2024-03-05 11:48:39,732 - extraction - WARNING - extract_file method successfully...
2024-03-05 11:48:39,817 - root - INFO - show read data spark...
2024-03-05 11:48:44,908 - root - INFO - writing into have table
2024-03-05 11:48:44,909 - root - INFO - successfully written into Hive
2024-03-05 11:48:44,910 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-03-05 11:51:42,430 - root - INFO - i am the main method...
2024-03-05 11:51:42,430 - root - INFO - calling spark object
2024-03-05 11:51:42,430 - create_spark - INFO - get_spark_object method started
2024-03-05 11:51:42,430 - create_spark - INFO - master is local
2024-03-05 11:51:45,379 - create_spark - INFO - Spark object create....
2024-03-05 11:51:45,379 - root - INFO - Validating spark object.......
2024-03-05 11:51:45,379 - validate - WARNING - started the get_current_date method...
2024-03-05 11:51:47,742 - validate - WARNING - Validation done, go forward...
2024-03-05 11:51:47,742 - root - INFO - Reading file which is of > parquet
2024-03-05 11:51:47,742 - infest - WARNING - Load_file method started...
2024-03-05 11:51:48,191 - infest - WARNING - dataframe created  which is if parquet
2024-03-05 11:51:48,194 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-03-05 11:51:49,542 - root - INFO - validating the dataframe...
2024-03-05 11:51:49,542 - infest - WARNING - here to count the records in the df
2024-03-05 11:51:49,937 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-03-05 11:51:49,937 - infest - WARNING - Load_file method started...
2024-03-05 11:51:50,315 - infest - WARNING - dataframe created  which is if csv
2024-03-05 11:51:50,317 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-03-05 11:51:50,548 - root - INFO - validating the dataframe...
2024-03-05 11:51:50,548 - infest - WARNING - here to count the records in the df
2024-03-05 11:51:51,275 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-03-05 11:51:51,275 - root - INFO - implementing data processing...
2024-03-05 11:51:51,275 - data_processing - WARNING - data_clean method() stating....
2024-03-05 11:51:51,276 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-03-05 11:51:51,301 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-03-05 11:51:51,314 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-03-05 11:51:51,322 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-03-05 11:51:51,350 - data_processing - WARNING - concat firstName and lastName
2024-03-05 11:51:51,364 - data_processing - WARNING - now check for null values in all column
2024-03-05 11:51:51,364 - data_processing - WARNING - drop the null values in the respective column...
2024-03-05 11:51:51,382 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-03-05 11:51:53,594 - data_processing - WARNING - now check for null values cleaned are not...
2024-03-05 11:51:53,594 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-03-05 11:51:53,594 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-03-05 11:51:53,868 - root - INFO - validating schema for dataframe....
2024-03-05 11:51:53,868 - validate - WARNING - printing schema method starting... df_city
2024-03-05 11:51:53,869 - validate - INFO - 	StructField('city', StringType(), True)
2024-03-05 11:51:53,869 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-03-05 11:51:53,869 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-03-05 11:51:53,869 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-03-05 11:51:53,869 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-03-05 11:51:53,869 - validate - INFO - 	StructField('zips', StringType(), True)
2024-03-05 11:51:53,869 - validate - INFO - print schema done, go forward....
2024-03-05 11:51:53,869 - validate - WARNING - printing schema method starting... df_fact
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-03-05 11:51:53,871 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-03-05 11:51:53,872 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-03-05 11:51:53,872 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-03-05 11:51:53,872 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-03-05 11:51:53,872 - validate - INFO - print schema done, go forward....
2024-03-05 11:51:53,998 - root - INFO - checking null values schema for dataframe....
2024-03-05 11:51:53,998 - root - INFO - transformation data processing....
2024-03-05 11:51:53,998 - root - INFO - displaying the df_report_1
2024-03-05 11:51:53,998 - data_transformation - WARNING - processing the dataframe1 method....
2024-03-05 11:51:53,999 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-03-05 11:51:54,032 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-03-05 11:51:54,072 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-03-05 11:51:54,126 - data_transformation - WARNING - data_transformation executed successfully...
2024-03-05 11:51:54,126 - root - INFO - display data_report2 method...
2024-03-05 11:51:54,127 - data_transformation - WARNING - executing data_report2 method...
2024-03-05 11:51:54,127 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-03-05 11:51:54,230 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-03-05 11:52:01,122 - root - INFO - extracting files output....
2024-03-05 11:52:01,122 - extraction - WARNING - extracting_file method starting....
2024-03-05 11:52:07,599 - extraction - WARNING - extract_file method successfully...
2024-03-05 11:52:07,680 - root - INFO - show read data spark...
2024-03-05 11:52:12,669 - root - INFO - writing into have table
2024-03-05 11:52:12,669 - root - INFO - successfully written into Hive
2024-03-05 11:52:12,670 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-03-05 13:18:14,259 - root - INFO - i am the main method...
2024-03-05 13:18:14,259 - root - INFO - calling spark object
2024-03-05 13:18:14,259 - create_spark - INFO - get_spark_object method started
2024-03-05 13:18:14,259 - create_spark - INFO - master is local
2024-03-05 13:18:18,444 - create_spark - INFO - Spark object create....
2024-03-05 13:18:18,444 - root - INFO - Validating spark object.......
2024-03-05 13:18:18,444 - validate - WARNING - started the get_current_date method...
2024-03-05 13:18:20,858 - validate - WARNING - Validation done, go forward...
2024-03-05 13:18:20,858 - root - INFO - Reading file which is of > parquet
2024-03-05 13:18:20,858 - infest - WARNING - Load_file method started...
2024-03-05 13:18:21,291 - infest - WARNING - dataframe created  which is if parquet
2024-03-05 13:18:21,294 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-03-05 13:18:22,607 - root - INFO - validating the dataframe...
2024-03-05 13:18:22,607 - infest - WARNING - here to count the records in the df
2024-03-05 13:18:22,997 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-03-05 13:18:22,997 - infest - WARNING - Load_file method started...
2024-03-05 13:18:23,392 - infest - WARNING - dataframe created  which is if csv
2024-03-05 13:18:23,393 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-03-05 13:18:23,591 - root - INFO - validating the dataframe...
2024-03-05 13:18:23,591 - infest - WARNING - here to count the records in the df
2024-03-05 13:18:24,157 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-03-05 13:18:24,157 - root - INFO - implementing data processing...
2024-03-05 13:18:24,157 - data_processing - WARNING - data_clean method() stating....
2024-03-05 13:18:24,157 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-03-05 13:18:24,183 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-03-05 13:18:24,197 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-03-05 13:18:24,206 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-03-05 13:18:24,232 - data_processing - WARNING - concat firstName and lastName
2024-03-05 13:18:24,246 - data_processing - WARNING - now check for null values in all column
2024-03-05 13:18:24,246 - data_processing - WARNING - drop the null values in the respective column...
2024-03-05 13:18:24,262 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-03-05 13:18:26,484 - data_processing - WARNING - now check for null values cleaned are not...
2024-03-05 13:18:26,484 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-03-05 13:18:26,484 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-03-05 13:18:26,735 - root - INFO - validating schema for dataframe....
2024-03-05 13:18:26,735 - validate - WARNING - printing schema method starting... df_city
2024-03-05 13:18:26,736 - validate - INFO - 	StructField('city', StringType(), True)
2024-03-05 13:18:26,736 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-03-05 13:18:26,736 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-03-05 13:18:26,736 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-03-05 13:18:26,736 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-03-05 13:18:26,736 - validate - INFO - 	StructField('zips', StringType(), True)
2024-03-05 13:18:26,736 - validate - INFO - print schema done, go forward....
2024-03-05 13:18:26,736 - validate - WARNING - printing schema method starting... df_fact
2024-03-05 13:18:26,737 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-03-05 13:18:26,737 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-03-05 13:18:26,737 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-03-05 13:18:26,737 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-03-05 13:18:26,738 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-03-05 13:18:26,738 - validate - INFO - print schema done, go forward....
2024-03-05 13:18:26,857 - root - INFO - checking null values schema for dataframe....
2024-03-05 13:18:26,857 - root - INFO - transformation data processing....
2024-03-05 13:18:26,857 - root - INFO - displaying the df_report_1
2024-03-05 13:18:26,857 - data_transformation - WARNING - processing the dataframe1 method....
2024-03-05 13:18:26,858 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-03-05 13:18:26,893 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-03-05 13:18:26,923 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-03-05 13:18:26,968 - data_transformation - WARNING - data_transformation executed successfully...
2024-03-05 13:18:26,968 - root - INFO - display data_report2 method...
2024-03-05 13:18:26,968 - data_transformation - WARNING - executing data_report2 method...
2024-03-05 13:18:26,968 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-03-05 13:18:27,054 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-03-05 13:18:33,429 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=676>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-03-05 13:18:33,432 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\seanghouch.ly\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\spark-3.5.0-bin-hadoop3\python\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o20.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\VATTANAC\PROJECT\PySpark\venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-03-05 13:18:35,049 - root - INFO - i am the main method...
2024-03-05 13:18:35,049 - root - INFO - calling spark object
2024-03-05 13:18:35,049 - create_spark - INFO - get_spark_object method started
2024-03-05 13:18:35,049 - create_spark - INFO - master is local
2024-03-05 13:18:38,020 - create_spark - INFO - Spark object create....
2024-03-05 13:18:38,020 - root - INFO - Validating spark object.......
2024-03-05 13:18:38,021 - validate - WARNING - started the get_current_date method...
2024-03-05 13:18:40,456 - validate - WARNING - Validation done, go forward...
2024-03-05 13:18:40,456 - root - INFO - Reading file which is of > parquet
2024-03-05 13:18:40,456 - infest - WARNING - Load_file method started...
2024-03-05 13:18:40,929 - infest - WARNING - dataframe created  which is if parquet
2024-03-05 13:18:40,932 - root - INFO - displaying the dataframe DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string]
2024-03-05 13:18:42,405 - root - INFO - validating the dataframe...
2024-03-05 13:18:42,405 - infest - WARNING - here to count the records in the df
2024-03-05 13:18:42,757 - infest - WARNING - Number of records present in the DataFrame[city: string, city_ascii: string, state_id: string, state_name: string, county_fips: int, county_name: string, lat: double, lng: double, population: int, density: int, timezone: string, zips: string] are :: 28338
2024-03-05 13:18:42,758 - infest - WARNING - Load_file method started...
2024-03-05 13:18:43,091 - infest - WARNING - dataframe created  which is if csv
2024-03-05 13:18:43,093 - root - INFO - displaying the dataframe DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string]
2024-03-05 13:18:43,293 - root - INFO - validating the dataframe...
2024-03-05 13:18:43,293 - infest - WARNING - here to count the records in the df
2024-03-05 13:18:43,858 - infest - WARNING - Number of records present in the DataFrame[npi: string, nppes_provider_last_org_name: string, nppes_provider_first_name: string, nppes_provider_city: string, nppes_provider_state: string, specialty_description: string, description_flag: string, drug_name: string, generic_name: string, bene_count: string, total_claim_count: string, total_30_day_fill_count: string, total_day_supply: string, total_drug_cost: string, bene_count_ge65: string, bene_count_ge65_suppress_flag: string, total_claim_count_ge65: string, ge65_suppress_flag: string, total_30_day_fill_count_ge65: string, total_day_supply_ge65: string, total_drug_cost_ge65: string, years_of_exp: string] are :: 1329329
2024-03-05 13:18:43,858 - root - INFO - implementing data processing...
2024-03-05 13:18:43,858 - data_processing - WARNING - data_clean method() stating....
2024-03-05 13:18:43,858 - data_processing - WARNING - selecting required columns and converting som of columns into upper case...
2024-03-05 13:18:43,881 - data_processing - WARNING - working on OLAP dataset selecting couple of columns and rename...
2024-03-05 13:18:43,894 - data_processing - WARNING - Adding a new column to df_presc_sel
2024-03-05 13:18:43,902 - data_processing - WARNING - converting year_of_exp string to int and replacing = 
2024-03-05 13:18:43,928 - data_processing - WARNING - concat firstName and lastName
2024-03-05 13:18:43,940 - data_processing - WARNING - now check for null values in all column
2024-03-05 13:18:43,940 - data_processing - WARNING - drop the null values in the respective column...
2024-03-05 13:18:43,956 - data_processing - WARNING - fill the null values in tx_cnt with the avg values...
2024-03-05 13:18:46,168 - data_processing - WARNING - now check for null values cleaned are not...
2024-03-05 13:18:46,168 - data_processing - WARNING - working on OLTP dataset selecting couple of columns and rename...
2024-03-05 13:18:46,168 - data_processing - WARNING - data_clean meth executed done, go forward...
2024-03-05 13:18:46,424 - root - INFO - validating schema for dataframe....
2024-03-05 13:18:46,424 - validate - WARNING - printing schema method starting... df_city
2024-03-05 13:18:46,425 - validate - INFO - 	StructField('city', StringType(), True)
2024-03-05 13:18:46,425 - validate - INFO - 	StructField('state_id', StringType(), True)
2024-03-05 13:18:46,425 - validate - INFO - 	StructField('state_name', StringType(), True)
2024-03-05 13:18:46,425 - validate - INFO - 	StructField('county_name', StringType(), True)
2024-03-05 13:18:46,426 - validate - INFO - 	StructField('population', IntegerType(), True)
2024-03-05 13:18:46,426 - validate - INFO - 	StructField('zips', StringType(), True)
2024-03-05 13:18:46,426 - validate - INFO - print schema done, go forward....
2024-03-05 13:18:46,426 - validate - WARNING - printing schema method starting... df_fact
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('presc_id', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('presc_lname', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('presc_fname', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('presc_city', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('presc_state', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('precs_spclt', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('drug_name', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('tx_cnt', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('total_day_supply', StringType(), True)
2024-03-05 13:18:46,427 - validate - INFO - 	StructField('total_drug_cost', StringType(), True)
2024-03-05 13:18:46,428 - validate - INFO - 	StructField('years_of_exp', IntegerType(), True)
2024-03-05 13:18:46,428 - validate - INFO - 	StructField('country_name', StringType(), False)
2024-03-05 13:18:46,428 - validate - INFO - 	StructField('presc_fullname', StringType(), False)
2024-03-05 13:18:46,428 - validate - INFO - print schema done, go forward....
2024-03-05 13:18:46,540 - root - INFO - checking null values schema for dataframe....
2024-03-05 13:18:46,540 - root - INFO - transformation data processing....
2024-03-05 13:18:46,540 - root - INFO - displaying the df_report_1
2024-03-05 13:18:46,540 - data_transformation - WARNING - processing the dataframe1 method....
2024-03-05 13:18:46,541 - data_transformation - WARNING - calculating total zip count in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-03-05 13:18:46,576 - data_transformation - WARNING - calculating distinct prescriber and total tx_count
2024-03-05 13:18:46,606 - data_transformation - WARNING - do not report a city if no prescriber is assigned to it ..... lets join df_city_sel and df_presc_grp
2024-03-05 13:18:46,653 - data_transformation - WARNING - data_transformation executed successfully...
2024-03-05 13:18:46,653 - root - INFO - display data_report2 method...
2024-03-05 13:18:46,653 - data_transformation - WARNING - executing data_report2 method...
2024-03-05 13:18:46,654 - data_transformation - WARNING - executing the task ::: consider the prescribers only from 20 to 50 years_of_exp and rank the prescribers base on their tx_cnt for each state
2024-03-05 13:18:46,734 - data_transformation - WARNING - data_report2 method executed....., go forward...
2024-03-05 13:18:53,038 - root - INFO - extracting files output....
2024-03-05 13:18:53,038 - extraction - WARNING - extracting_file method starting....
2024-03-05 13:18:59,456 - extraction - WARNING - extract_file method successfully...
2024-03-05 13:18:59,547 - root - INFO - show read data spark...
2024-03-05 13:19:04,423 - root - INFO - writing into have table
2024-03-05 13:19:04,424 - root - INFO - successfully written into Hive
2024-03-05 13:19:04,424 - root - INFO - Now write DataFrame[city: string, state_name: string, county_name: string, population: int, zipcounts: int, presc_counts: bigint] into MSSQL
2024-03-05 13:19:15,903 - root - INFO - total amount of time taken: 40.859198499998456 seconds...
2024-03-05 13:19:15,903 - root - INFO - Application done
